
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Structured Data (XML, xlsx &amp; JSON) &#8212; Hydro-Informatics</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/tabs.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://hydro-informatics.com/jupyter/xml.html" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Plotting" href="pyplot.html" />
    <link rel="prev" title="Data Files, NumPy &amp; Pandas" href="pynum.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/icon.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Hydro-Informatics</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Get Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/classroom.html">
   The Virtual Classroom
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/principles.html">
     Principles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/lectures.html">
     Lectures and Exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/take_seat.html">
     Take a Seat
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../get-started/software.html">
   Software Resources
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/vm.html">
     Virtual Machines and Linux
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/ide.html">
     Integrated Development Environments (IDEs)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python-basics/pyinstall.html">
     Python (Installation)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/git.html">
     Version Control : git
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/geo.html">
     Geospatial Software
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/install-openfoam.html">
     OpenFOAM (Installation)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/install-telemac.html">
     TELEMAC (Installation)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/others.html">
     Other Software Resources
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Python Basics
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../python-basics/python.html">
   First Steps
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="pybase.html">
     Hello Data Types
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pyerror.html">
     Errors, Logging, and Debugging
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pyloop.html">
     Loops and Conditional Statements
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../python-basics/modularize.html">
   Object Orientation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="pyfun.html">
     Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pypckg.html">
     Packages, Modules and Libraries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="classes.html">
     Object Orientation and Classes
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="../python-basics/data-handling.html">
   Data and File Handling
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="pynum.html">
     Data Files, NumPy &amp; Pandas
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     Structured Data (XML, xlsx &amp; JSON)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="pyplot.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="pystyle.html">
   Code Style and Conventions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="gui.html">
   Graphical User Interfaces (GUIs)
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../exercises/python-exercises.html">
   Python Exercises
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-ms.html">
     1d Hydraulics (Manning-Strickler Formula)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-sp.html">
     Reservoir Volume (Sequent Peak Algorithm)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-floods.html">
     Flood Return Periods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-sediment.html">
     1d Sediment Transport
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-gui.html">
     Create a GUI
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Geospatial Analysis
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../geopy/geospatial-data.html">
   Geospatial Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../geopy/use-qgis.html">
   QGIS Tutorial
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../geopy/drone-processing.html">
   Process Drone (UAV) Imagery
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../geopy/geo-python.html">
   Geospatial Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../geopy/geo-pckg.html">
     Geospatial Open Source Python Libraries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="geo-shp.html">
     Shapefile (Vector) Handling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="geo-raster.html">
     Raster (Grid) Handling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="geo-convert.html">
     Vectorize and Rasterize
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="geo-arcpy.html">
     The Commercial arcpy Library
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../exercises/geo-exercises.html">
   Exercises
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-geco.html">
     Script a Habitat Suitability Map
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data Science
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../datascience/data-science.html">
   Fundamentals (Coming soon)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../datascience/py-requirements.html">
     Python Requirements
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../datascience/data-prepro.html">
     Data Pre-Processing
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
    <label for="toctree-checkbox-10">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../datascience/data-types.html">
       The Nature of Data
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../datascience/data-cleaning.html">
       Dataset Cleaning
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../datascience/dimensional-analysis.html">
       Dimensional Analysis
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../datascience/theory.html">
   Techniques (Coming soon)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../datascience/techniques.html">
     Overview of Fundamental Techniques
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../datascience/calibrate-validate.html">
     Model Calibration and Validation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../datascience/morphology-predictor-svm.html">
     Support Vector Machine (SVM)
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Numerical Modeling
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../numerics/numerical-modeling.html">
   Principles
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../numerics/basement.html">
   BASEMENT
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../numerics/pre-qgis-bm.html">
     Pre-processing with QGIS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../numerics/basement2d.html">
     Run and Check a Steady 2d Simulation
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../numerics/telemac.html">
   TELEMAC
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../numerics/pre-slf-tm.html">
     Pre-processing
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../numerics/telemac2d.html">
     Telemac2d
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
    <label for="toctree-checkbox-14">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../numerics/telemac2d-steady.html">
       Steady 2d
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../numerics/telemac2d-unsteady.html">
       Unsteady 2d
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../numerics/telemac3d.html">
     Telemac3d
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
    <label for="toctree-checkbox-15">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../numerics/telemac3d-slf.html">
       Steady 3d (SLF - Selafin)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../numerics/telemac3d-med.html">
       Steady 3d (MED and Salome)
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../numerics/telemac-gaia.html">
     Gaia (Morphodynamics)
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
    <label for="toctree-checkbox-16">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../numerics/gaia-coupling.html">
       Introduction and Coupling
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../numerics/gaia-basics.html">
       Basic Setup of Gaia
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../numerics/gaia-bedload.html">
       Bedload
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../numerics/gaia-suspended.html">
       Suspended Load
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../numerics/gaia-run.html">
       Run and Analyze
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Documentation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../documentation/documentation.html">
   How to Markdown and Document
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../documentation/glossary.html">
   Glossary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../documentation/notation.html">
   Notation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../documentation/bibliography.html">
   References
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../exercises/docs-exercises.html">
   Exercises
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
  <label for="toctree-checkbox-17">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-git.html">
     Git and Markdown
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Troubleshoot
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../troubleshoot/dbg-programming.html">
   Programming Tools and IDEs
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
  <label for="toctree-checkbox-18">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-anaconda.html">
     Debugging Anaconda
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-python.html">
     Debugging Python Code
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-jupyter.html">
     Debugging Jupyter
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../troubleshoot/dbg-numerical-models.html">
   Numerical Models
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
  <label for="toctree-checkbox-19">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-basement.html">
     Debugging BASEMENT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-telemac.html">
     Debugging TELEMAC
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../troubleshoot/dbg-os.html">
   Operating Systems (Linux and VMs)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
  <label for="toctree-checkbox-20">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-linux.html">
     Debugging Debian Linux
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-vm.html">
     Debugging Virtual Machines
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Disclaimer and License
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../terms/license.html">
   License
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../terms/disclaimer.html">
   Disclaimer
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Written by <a href="https://sebastian-schwindt.org">Sebastian Schwindt</a> and Ricardo Barros
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/jupyter/xml.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/hydro-informatics/jupyter-python-course"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/hydro-informatics/jupyter-python-course/main/v2/gh/hydro-informatics/jupyter-python-course/main?urlpath=lab/tree/jupyter/xml.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        <a class="colab-button" href="https://colab.research.google.com//github/hydro-informatics/jupyter-python-course/blob/main/jupyter/xml.ipynb"><button type="button" class="btn btn-secondary topbarbtn"
                title="Launch Colab" data-toggle="tooltip" data-placement="left"><img class="colab-button-logo"
                    src="../_static/images/logo_colab.png"
                    alt="Interact on Colab">Colab</button></a>
        
        <button type="button" class="btn btn-secondary topbarbtn"
            onclick="initThebeSBT()" title="Launch Thebe" data-toggle="tooltip" data-placement="left"><i
                class="fas fa-play"></i><span style="margin-left: .4em;">Live Code</span></button>
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Structured Data (XML, xlsx &amp; JSON)
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#workbook-xlsx-handling">
     Workbook (xlsx) Handling
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#create-a-workbook">
       Create a Workbook
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#read-and-manipulate-an-existing-workbook">
       Read and Manipulate an Existing Workbook
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#formulae-in-workbooks">
       Formulae in Workbooks
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#un-merge-cells">
       (Un)merge Cells
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#charts-plots">
       Charts (Plots)
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#customize-workbook-manipulation">
       Customize Workbook Manipulation
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#an-example-from-water-resources-engineering-and-research">
       An Example from Water Resources Engineering and Research
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#json">
     JSON
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#json-file-structure">
       JSON file structure
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#read-decode-and-write-encode-json-files-with-the-json-library">
       Read (Decode) and Write (Encode) JSON Files with the
       <code class="docutils literal notranslate">
        <span class="pre">
         json
        </span>
       </code>
       Library
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#read-decode-and-write-encode-json-files-with-pandas">
       Read (Decode) and Write (Encode) JSON Files with
       <em>
        pandas
       </em>
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#learning-success-check-up">
   Learning Success Check-up
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="structured-data-xml-xlsx-json">
<span id="chpt-xml"></span><h1>Structured Data (XML, xlsx &amp; JSON)<a class="headerlink" href="#structured-data-xml-xlsx-json" title="Permalink to this headline">¶</a></h1>
<p>Create, manipulate and copy semi-structured data files in the form of xlsx-workbooks and JSON files. For interactive reading and executing code blocks <a class="reference external" href="https://mybinder.org/v2/gh/hydro-informatics/hydro-informatics.github.io/main?filepath=jupyter"><img alt="Binder" src="https://mybinder.org/badge_logo.svg" /></a> and find <em>xml.ipynb</em>, or install <a class="reference internal" href="../python-basics/pyinstall.html#install-python"><span class="std std-ref">Python</span></a> and <a class="reference internal" href="../get-started/ide.html#jupyter"><span class="std std-ref">JupyterLab</span></a> locally.</p>
<p>This chapter starts with background information about XML and what XML has to do with workbooks, and JSON: XML is an abbreviation for <a class="reference external" href="https://www.w3.org/TR/xml/">E<strong>x</strong>tensible <strong>M</strong>arkup <strong>L</strong>anguage</a> that defines rules for encoding documents. XML was designed for straightforward usage over the internet and we encounter XML documents all the time, on websites (e.g., <em>XHTML</em>), in the shape office documents (e.g., Office Open XML such as <em>docx</em>, <em>pptx</em>, or <em>xlsx</em>), or podcasts (e.g., <em>RSS</em>). The strength of the XML format is its characteristic of being both machine-readable (i.e., a computer can process XML files) and human-readable (i.e., we can read it like a newspaper). For instance, entering formulas in an xlsx workbook is simultaneously machine-readable and human-readable, since humans and computers can interpret and evaluate the formulas in this XML frame. Other file formats such as <a class="reference external" href="https://www.json.org/json-en.html"><em>JSON</em> (JavaScript Object Notation)</a> resemble XML and Python can extract information from and export information to both formats. In water resources engineering and research, for example, we are mainly interested in the exchange of information with office workbooks (<em>xlsx</em> files), or with JSON files, which provide boundary conditions for numerical models.</p>
<div class="tip dropdown admonition">
<p class="admonition-title">Watch this section as a video</p>
<iframe width="701" height="394" src="https://www.youtube-nocookie.com/embed/hyIDIqWni9E" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe>
<p>Watch this section as a video on the <a href="https://www.youtube.com/channel/UCGOMSGRrW5eLHiMn5Dfp7WQ">@Hydro-Morphodynamics channel on YouTube</a>.</p>
</div>
<div class="section" id="workbook-xlsx-handling">
<span id="sec-xlsx"></span><h2>Workbook (xlsx) Handling<a class="headerlink" href="#workbook-xlsx-handling" title="Permalink to this headline">¶</a></h2>
<p>Why do we want to communicate with workbooks at all? We have already seen that Python is much more powerful than office programs for the systematic analysis of data. However, Python requires the abstraction of data in our minds to visualize, for example, the structure of a nested list. For this reason, data from and for marketing, your boss, or public authorities are often required to have visually easy-to-use workbook formats, which can be overlooked quickly. Still, we want to leverage the content of such workbook information efficiently with Python and we want to produce visually simplistic output that anyone can read without any Python knowledge.</p>
<p>We have already seen that <em>pandas</em> provides easy routines for importing and exporting data from and to workbooks, respectively (cf. <a class="reference internal" href="pynum.html#pd-files"><span class="std std-ref">file reading and writing with pandas</span></a>) with <em>pandas</em>). <em>pandas</em> primarily uses <a class="reference external" href="https://openpyxl.readthedocs.io/en/stable/">openpyxl</a> depending on what is available in the active Python environment. <em>openpyxl</em> is one of the most powerful options for handling workbooks with Python (note: this assertion is subjective) and this section introduces <em>openpyxl</em>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p><em>flusstools</em> ships with <em>openpyxl</em>.</p>
</div>
<p>This introduction uses the following workbook-related terms:</p>
<ul class="simple">
<li><p><strong>workbook</strong> is the main <em>xlsx</em> file we work with (also called <em>spreadsheet</em>);</p></li>
<li><p><strong>sheet</strong> is tabular content of a workbook and one workbook can have multiple sheets;</p></li>
<li><p><strong>column</strong>s are vertical lines in a sheet;</p></li>
<li><p><strong>row</strong>s are horizontal lines in a sheet;</p></li>
<li><p><strong>cell</strong>s are elements of a sheet.</p></li>
</ul>
<div class="section" id="create-a-workbook">
<h3>Create a Workbook<a class="headerlink" href="#create-a-workbook" title="Permalink to this headline">¶</a></h3>
<p><em>openpyxl</em> has a <code class="docutils literal notranslate"><span class="pre">Workbook</span></code> class that enables to create and fill workbooks with data. Typically, an instance of the <code class="docutils literal notranslate"><span class="pre">Workbook</span></code> class is called <code class="docutils literal notranslate"><span class="pre">wb</span></code> and worksheet variables are called <code class="docutils literal notranslate"><span class="pre">ws</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">openpyxl</span> <span class="k">as</span> <span class="nn">oxl</span>
<span class="n">wb</span> <span class="o">=</span> <span class="n">oxl</span><span class="o">.</span><span class="n">Workbook</span><span class="p">()</span>  <span class="c1"># create a Workbook instance</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>  <span class="c1"># activate worksheet</span>
<span class="n">ws</span><span class="o">.</span><span class="n">titel</span> <span class="o">=</span> <span class="s2">&quot;Gaussian 2D&quot;</span>  <span class="c1"># name worksheet</span>
<span class="n">ws</span><span class="p">[</span><span class="s2">&quot;A1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Gaussian sample data&quot;</span>  <span class="c1"># write to cell A1</span>

<span class="c1"># generate some data</span>
<span class="n">x</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">meshgrid</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">),</span> <span class="n">np</span><span class="o">.</span><span class="n">linspace</span><span class="p">(</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">20</span><span class="p">))</span>
<span class="n">dis</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">x</span> <span class="o">*</span> <span class="n">x</span> <span class="o">+</span> <span class="n">y</span> <span class="o">*</span> <span class="n">y</span><span class="p">)</span>
<span class="n">sigma</span><span class="p">,</span> <span class="n">mu</span> <span class="o">=</span> <span class="mf">1.0</span><span class="p">,</span> <span class="mf">0.0</span>
<span class="n">gaussian</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="o">-</span><span class="p">((</span><span class="n">dis</span> <span class="o">-</span> <span class="n">mu</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="mf">2.0</span> <span class="o">*</span> <span class="n">sigma</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)))</span>

<span class="c1"># write data to worksheet</span>
<span class="n">m</span><span class="p">,</span> <span class="n">n</span> <span class="o">=</span> <span class="n">gaussian</span><span class="o">.</span><span class="n">shape</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">m</span><span class="p">):</span>
    <span class="k">for</span> <span class="n">j</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="n">n</span><span class="p">):</span>
        <span class="n">_</span> <span class="o">=</span> <span class="n">ws</span><span class="o">.</span><span class="n">cell</span><span class="p">(</span><span class="n">row</span><span class="o">=</span><span class="n">i</span><span class="o">+</span><span class="mi">1</span><span class="p">,</span> <span class="n">column</span><span class="o">=</span><span class="n">j</span><span class="p">,</span> <span class="n">value</span><span class="o">=</span><span class="n">gaussian</span><span class="p">[</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="n">j</span><span class="o">-</span><span class="mi">1</span><span class="p">])</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Workbook data in cell A2: &quot;</span><span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">ws</span><span class="p">[</span><span class="s2">&quot;A2&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value</span><span class="p">))</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Corresponds to np.array value: &quot;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">gaussian</span><span class="p">[</span><span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">]))</span>

<span class="c1"># save and close (destruct object) workbook</span>
<span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;data/python_workbook.xlsx&quot;</span><span class="p">)</span>
<span class="n">wb</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Workbook data in cell A2: 0.3678794411714422
Corresponds to np.array value: 0.3678794411714422
</pre></div>
</div>
</div>
</div>
<p><img alt="img" src="https://raw.githubusercontent.com/sschwindt/hydroinformatics/main/docs/img/py-xlsx.png" /></p>
</div>
<div class="section" id="read-and-manipulate-an-existing-workbook">
<h3>Read and Manipulate an Existing Workbook<a class="headerlink" href="#read-and-manipulate-an-existing-workbook" title="Permalink to this headline">¶</a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>When <em>openpyxl</em> opens an existing workbook, it cannot read graphical objects (e.g., graphs, shapes, or images). For this reason, saving the workbook with the same name will make graphical objects disappear.</p>
</div>
<p><em>openpyxl</em> reads existing workbooks with <code class="docutils literal notranslate"><span class="pre">openpyxl.load_workbook(filename=str())</span></code>. This function accepts optional keyword arguments, such as:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">read_only=BOOLEAN</span></code> decides whether a workbook is opened in <em>read-only</em> mode. A workbook can only be manipulated if <code class="docutils literal notranslate"><span class="pre">read_only=False</span></code> (this is the default option, which can be useful to handle large files or to ensure that graphical objects are not lost).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">write_only=BOOLEAN</span></code> decides whether a workbook is opened in <em>write only</em> mode. If <code class="docutils literal notranslate"><span class="pre">write_only=True</span></code> (the default is <code class="docutils literal notranslate"><span class="pre">False</span></code>), no data can be read from a workbook but writing data is significantly faster (i.e., this option is useful to write large datasets).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">data_only=BOOLEAN</span></code> determines if cell formulae or cell data will be read. For example, when a workbook cell’s content is <code class="docutils literal notranslate"><span class="pre">=PI()</span></code>, <code class="docutils literal notranslate"><span class="pre">data_only=False</span></code> (this is the default option) reads the cell value as <code class="docutils literal notranslate"><span class="pre">=PI()</span></code> and <code class="docutils literal notranslate"><span class="pre">data_only=True</span></code> reads the cell value as <code class="docutils literal notranslate"><span class="pre">3.14159265359</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">keep_vba=BOOLEAN</span></code> controls whether <em>Visual Basic</em> elements (macros) are kept or not. The default is <code class="docutils literal notranslate"><span class="pre">keep_vba=False</span></code> (i.e., no preservation) and <code class="docutils literal notranslate"><span class="pre">keep_vba=True</span></code> will still not enable a modification of Visual Basic elements.</p></li>
</ul>
<p>If <code class="docutils literal notranslate"><span class="pre">read_only=False</span></code>, we can manipulate cell values and also cell formats, including data formats (e.g., date, time, and <a class="reference external" href="https://openpyxl.readthedocs.io/en/stable/_modules/openpyxl/styles/numbers.html">many more</a>), <a class="reference external" href="https://openpyxl.readthedocs.io/en/stable/styles.html">font properties (and many more cell styles)</a>, or colors in <em>HEX Color Code</em> (<a class="reference external" href="https://www.colorcodehex.com/">find your favorite color here</a>). The following example opens the above created <code class="docutils literal notranslate"><span class="pre">python_workbook.xlsx</span></code>, adds a new worksheet, illustrates the implementation of cell styles, and fills the workbook with random discharge measurements.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">from</span> <span class="nn">openpyxl.styles</span> <span class="kn">import</span> <span class="n">Font</span><span class="p">,</span> <span class="n">Alignment</span><span class="p">,</span> <span class="n">PatternFill</span>
<span class="n">wb</span> <span class="o">=</span> <span class="n">oxl</span><span class="o">.</span><span class="n">load_workbook</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;data/python_workbook.xlsx&quot;</span><span class="p">,</span> <span class="n">read_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">create_sheet</span><span class="p">(</span><span class="n">title</span><span class="o">=</span><span class="s2">&quot;Discharge&quot;</span><span class="p">)</span>

<span class="c1"># define title styles</span>
<span class="n">title_font</span> <span class="o">=</span> <span class="n">Font</span><span class="p">(</span><span class="n">name</span><span class="o">=</span><span class="s2">&quot;Tahoma&quot;</span><span class="p">,</span> <span class="n">size</span><span class="o">=</span><span class="s2">&quot;11&quot;</span><span class="p">,</span> <span class="n">bold</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">italic</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;C1D0DE&quot;</span><span class="p">)</span>
<span class="n">title_fill</span> <span class="o">=</span> <span class="n">PatternFill</span><span class="p">(</span><span class="n">fill_type</span><span class="o">=</span><span class="s2">&quot;solid&quot;</span><span class="p">,</span> <span class="n">start_color</span><span class="o">=</span><span class="s2">&quot;050505&quot;</span><span class="p">,</span> <span class="n">end_color</span><span class="o">=</span><span class="s2">&quot;073AD4&quot;</span><span class="p">)</span>
<span class="n">title_align</span> <span class="o">=</span> <span class="n">Alignment</span><span class="p">(</span><span class="n">horizontal</span><span class="o">=</span><span class="s1">&#39;center&#39;</span><span class="p">,</span> <span class="n">vertical</span><span class="o">=</span><span class="s1">&#39;bottom&#39;</span><span class="p">,</span> <span class="n">text_rotation</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span>
                        <span class="n">wrap_text</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">shrink_to_fit</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">indent</span><span class="o">=</span><span class="mi">0</span><span class="p">)</span>

<span class="n">date_time_format</span> <span class="o">=</span> <span class="s2">&quot;yyyy-mm-dd hh:mm:ss&quot;</span>
<span class="n">ws</span><span class="p">[</span><span class="s2">&quot;A1&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Date-Time (</span><span class="si">%s</span><span class="s2">)&quot;</span> <span class="o">%</span> <span class="n">date_time_format</span>

<span class="n">title_cell_flow</span> <span class="o">=</span> <span class="n">ws</span><span class="p">[</span><span class="s2">&quot;B1&quot;</span><span class="p">]</span>
<span class="n">title_cell_flow</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="s2">&quot;Discharge (CMS)&quot;</span>
<span class="n">title_cell_flow</span><span class="o">.</span><span class="n">font</span> <span class="o">=</span> <span class="n">title_font</span>
<span class="n">title_cell_flow</span><span class="o">.</span><span class="n">fill</span> <span class="o">=</span> <span class="n">title_fill</span>
<span class="n">title_cell_flow</span><span class="o">.</span><span class="n">alignment</span> <span class="o">=</span> <span class="n">title_align</span>

<span class="c1"># define time period and time delta of 1 hour = 3600 seconds</span>
<span class="n">current_date_time</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2040</span><span class="p">,</span> <span class="mi">12</span><span class="p">,</span> <span class="mi">24</span><span class="p">,</span> <span class="mi">0</span><span class="p">,</span> <span class="mi">0</span><span class="p">)</span>
<span class="n">dt</span> <span class="o">=</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span><span class="o">=</span><span class="mi">3600</span><span class="p">)</span>

<span class="c1"># write random discharges to workbooks</span>
<span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">ws</span><span class="o">.</span><span class="n">iter_rows</span><span class="p">(</span><span class="n">min_row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">max_row</span><span class="o">=</span><span class="mi">26</span><span class="p">,</span> <span class="n">min_col</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">max_col</span><span class="o">=</span><span class="mi">2</span><span class="p">):</span>
    <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">current_date_time</span>
    <span class="n">row</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span><span class="o">.</span><span class="n">number_format</span> <span class="o">=</span> <span class="n">date_time_format</span>
    <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">random_sample</span><span class="p">(</span><span class="n">size</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span>
    <span class="n">row</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">number_format</span> <span class="o">=</span> <span class="s2">&quot;0.00&quot;</span>
    <span class="n">current_date_time</span> <span class="o">+=</span> <span class="n">dt</span>
    
<span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;data/python_workbook_reloaded.xlsx&quot;</span><span class="p">)</span>
<span class="n">wb</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="img" src="https://raw.githubusercontent.com/sschwindt/hydroinformatics/main/docs/img/py-xlsx-reloaded.png" /></p>
<p>The below code block provides the short helper function <code class="docutils literal notranslate"><span class="pre">read_columns</span></code> to read only one or more columns into a (nested) <em>list</em> (reads until the maximum number of rows, defined by <code class="docutils literal notranslate"><span class="pre">ws.rows</span></code>, in a workbook is reached). A similar function can be written for reading rows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">read_columns</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">start_row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;ABC&quot;</span><span class="p">):</span>
    <span class="k">return</span> <span class="p">[</span><span class="n">ws</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">row</span><span class="p">)]</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start_row</span><span class="p">,</span> <span class="nb">int</span><span class="p">(</span><span class="n">ws</span><span class="o">.</span><span class="n">rows</span><span class="o">.</span><span class="n">__sizeof__</span><span class="p">())</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">columns</span><span class="p">]</span>

<span class="c1"># example usage:</span>
<span class="n">wb</span> <span class="o">=</span> <span class="n">oxl</span><span class="o">.</span><span class="n">load_workbook</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;data/python_workbook.xlsx&quot;</span><span class="p">,</span> <span class="n">read_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>
<span class="n">col_D</span> <span class="o">=</span> <span class="n">read_columns</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">start_row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;D&quot;</span><span class="p">)</span>
<span class="n">col_F</span> <span class="o">=</span> <span class="n">read_columns</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">start_row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;F&quot;</span><span class="p">)</span>
<span class="n">wb</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<div class="important dropdown admonition">
<p class="admonition-title">Challenge: Add a random test set to modified-data-wb.xlsx</p>
<p>The <a class="reference internal" href="pynum.html#pd-files"><span class="std std-ref">pandas file handling section</span></a> features the creation of a workbook containing 4 columns of test data (<a class="reference external" href="https://raw.githubusercontent.com/hydro-informatics/jupyter-python-course/main/data/modified-data-wb.xlsx">download modified-data-wb.xlsx</a>). For a random-test comparison, you want to add a column of random values. To this end:</p>
<ul class="simple">
<li><p>Open <em>modified-data-wb.xlsx</em> with <em>openpyxl</em> <code class="docutils literal notranslate"><span class="pre">wb</span> <span class="pre">=</span> <span class="pre">oxl.load_workbook(filename=&quot;data/python_workbook.xlsx&quot;,</span> <span class="pre">read_only=False)</span></code></p></li>
<li><p>Get the active worksheet <code class="docutils literal notranslate"><span class="pre">ws</span> <span class="pre">=</span> <span class="pre">wb.active</span></code></p></li>
<li><p>Add a new column name in column <strong>F</strong>: <code class="docutils literal notranslate"><span class="pre">ws[&quot;F1&quot;].value</span> <span class="pre">=</span> <span class="pre">&quot;Random</span> <span class="pre">values&quot;</span></code></p></li>
<li><p>Create a list (i.e., a 1d array) of random numbers with numpy (do not forget to <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">numpy</span> <span class="pre">as</span> <span class="pre">np</span></code>) <code class="docutils literal notranslate"><span class="pre">rnd_data</span> <span class="pre">=</span> <span class="pre">np.random.random(18)</span></code></p></li>
<li><p>Iterate over the random data array and write the values to the workbook’s <strong>F</strong> column</p>
<ul>
<li><p>Start the iteration with <code class="docutils literal notranslate"><span class="pre">for</span> <span class="pre">row,</span> <span class="pre">val</span> <span class="pre">in</span> <span class="pre">enumerate(rnd_data):</span></code></p></li>
<li><p>In every iteration add the next random value of <code class="docutils literal notranslate"><span class="pre">rnd_data</span></code> with <code class="docutils literal notranslate"><span class="pre">ws[&quot;F&quot;</span> <span class="pre">+</span> <span class="pre">str(row</span> <span class="pre">+</span> <span class="pre">2)].value</span> <span class="pre">=</span> <span class="pre">val</span></code> <br><span style="color: #707070 "><em>Note the usage of <code class="docutils literal notranslate"><span class="pre">row</span> <span class="pre">+</span> <span class="pre">2</span></code> (one header column and different absolutes of Python and the workbook)</span></em></p></li>
</ul>
</li>
<li><p>Save and close the workbook</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">wb.save(os.getcwd()</span> <span class="pre">+</span> <span class="pre">&quot;/data/re-modified-data-wb.xlsx&quot;</span></code> (do not forget to <code class="docutils literal notranslate"><span class="pre">import</span> <span class="pre">os</span></code>)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">wb.close()</span></code></p></li>
<li><p>Alternatively, use a name space for the workbook manipulation!</p></li>
</ul>
</li>
</ul>
</div>
</div>
<div class="section" id="formulae-in-workbooks">
<h3>Formulae in Workbooks<a class="headerlink" href="#formulae-in-workbooks" title="Permalink to this headline">¶</a></h3>
<p>The optional keyword argument <code class="docutils literal notranslate"><span class="pre">data_only=False</span></code> enables reading workbook formulae instead of cell values. However, not all workbook formulae are recognized by <em>openpyxl</em> and in the case of doubts, a dirty try-and-error approach is the only remedy. As an example, change <code class="docutils literal notranslate"><span class="pre">SQRT</span></code> in the below example to the formula in question.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openpyxl.utils</span> <span class="kn">import</span> <span class="n">FORMULAE</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;SQRT&quot;</span> <span class="ow">in</span> <span class="n">FORMULAE</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>True
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="un-merge-cells">
<h3>(Un)merge Cells<a class="headerlink" href="#un-merge-cells" title="Permalink to this headline">¶</a></h3>
<p>Merging and un-merging cells is a popular office function for style purposes and <em>openpyxl</em> also provides functions to perform merge operations:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">ws</span><span class="o">.</span><span class="n">merge_cells</span><span class="p">(</span><span class="n">start_row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">end_row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">start_column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">end_column</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
<span class="n">ws</span><span class="o">.</span><span class="n">unmerge_cells</span><span class="p">(</span><span class="n">start_row</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">end_row</span><span class="o">=</span><span class="mi">3</span><span class="p">,</span> <span class="n">start_column</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">end_column</span><span class="o">=</span><span class="mi">2</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="charts-plots">
<h3>Charts (Plots)<a class="headerlink" href="#charts-plots" title="Permalink to this headline">¶</a></h3>
<p>In the unlikely event that you want to insert plots directly into workbooks with Python (<a class="reference internal" href="pyplot.html#matplotlib"><span class="std std-ref">matplotlib</span></a> is more powerful anyway), <em>openpyxl</em> offers features for this purpose as well. To illustrate the creation of an area chart, the below code block re-uses the first column of random values in the above-created <code class="docutils literal notranslate"><span class="pre">python_workbook.xlsx</span></code>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">openpyxl.chart</span> <span class="kn">import</span> <span class="n">AreaChart</span><span class="p">,</span> <span class="n">Reference</span><span class="p">,</span> <span class="n">Series</span>

<span class="n">wb</span> <span class="o">=</span> <span class="n">oxl</span><span class="o">.</span><span class="n">load_workbook</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="s2">&quot;data/python_workbook.xlsx&quot;</span><span class="p">,</span> <span class="n">read_only</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">ws</span> <span class="o">=</span> <span class="n">wb</span><span class="o">.</span><span class="n">active</span>

<span class="n">chart</span> <span class="o">=</span> <span class="n">AreaChart</span><span class="p">()</span>
<span class="n">chart</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Random Gaussian&quot;</span>
<span class="n">chart</span><span class="o">.</span><span class="n">style</span> <span class="o">=</span> <span class="mi">10</span>
<span class="n">chart</span><span class="o">.</span><span class="n">x_axis</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Cell row&quot;</span>
<span class="n">chart</span><span class="o">.</span><span class="n">y_axis</span><span class="o">.</span><span class="n">title</span> <span class="o">=</span> <span class="s2">&quot;Random value (-)&quot;</span>

<span class="n">col_D</span> <span class="o">=</span> <span class="n">Reference</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">min_col</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">min_row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">max_row</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>
<span class="n">col_F</span> <span class="o">=</span> <span class="n">Reference</span><span class="p">(</span><span class="n">ws</span><span class="p">,</span> <span class="n">min_col</span><span class="o">=</span><span class="mi">6</span><span class="p">,</span> <span class="n">min_row</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">max_row</span><span class="o">=</span><span class="mi">20</span><span class="p">)</span>

<span class="n">chart</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span><span class="n">col_F</span><span class="p">,</span> <span class="n">titles_from_data</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
<span class="n">chart</span><span class="o">.</span><span class="n">add_data</span><span class="p">(</span><span class="n">col_D</span><span class="p">,</span> <span class="n">titles_from_data</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

<span class="n">ws</span><span class="o">.</span><span class="n">add_chart</span><span class="p">(</span><span class="n">chart</span><span class="p">,</span> <span class="s2">&quot;B2&quot;</span><span class="p">)</span>

<span class="n">wb</span><span class="o">.</span><span class="n">save</span><span class="p">(</span><span class="s2">&quot;data/python_workbook_chart.xlsx&quot;</span><span class="p">)</span>
<span class="n">wb</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="img" src="https://raw.githubusercontent.com/sschwindt/hydroinformatics/main/docs/img/py-xlsx-plot.png" /></p>
<p>Other workbook charts are available and their implementation (still: why would you?) is explained in the <a class="reference external" href="https://openpyxl.readthedocs.io/en/stable/charts/introduction.html">openpyxl docs</a>.</p>
</div>
<div class="section" id="customize-workbook-manipulation">
<h3>Customize Workbook Manipulation<a class="headerlink" href="#customize-workbook-manipulation" title="Permalink to this headline">¶</a></h3>
<p>There are many ways of modifying workbooks and <em>openpyxl</em> provides close-to “shovel-ready” methods to manipulate a workbook. Still, to avoid re-reading this lesson every time you want to manipulate a workbook, it is more convenient to have your own workbook manipulation classes ready to work. To this end, the following code block defines custom <code class="docutils literal notranslate"><span class="pre">Read</span></code> and <code class="docutils literal notranslate"><span class="pre">Write</span></code> classes, where <code class="docutils literal notranslate"><span class="pre">Read</span></code> is the parent class of the <code class="docutils literal notranslate"><span class="pre">Write</span></code> class (recall the section on <a class="reference internal" href="classes.html#inheritance"><span class="std std-ref">inheritance of classes</span></a>). The <code class="docutils literal notranslate"><span class="pre">Read</span></code> class may contain tailored functions for reading specific columns, rows, or arrays. The below code block also makes use of the above-defined <code class="docutils literal notranslate"><span class="pre">read_columns</span></code> function, implemented as a method of the <code class="docutils literal notranslate"><span class="pre">Read</span></code> class.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">openpyxl</span> <span class="k">as</span> <span class="nn">oxl</span>

<span class="k">class</span> <span class="nc">Read</span><span class="p">:</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="n">workbook_name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">read_only</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;read_only&quot;</span><span class="p">)</span>
        <span class="n">data_only</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data_only&quot;</span><span class="p">)</span>
        <span class="n">sheet_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data_only&quot;</span><span class="p">)</span>
        <span class="bp">self</span><span class="o">.</span><span class="n">wb</span> <span class="o">=</span> <span class="n">oxl</span><span class="o">.</span><span class="n">load_workbook</span><span class="p">(</span><span class="n">filename</span><span class="o">=</span><span class="n">workbook_name</span><span class="p">,</span> <span class="n">read_only</span><span class="o">=</span><span class="n">read_only</span><span class="p">,</span> <span class="n">data_only</span><span class="o">=</span><span class="n">data_only</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">sheet_name</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ws</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wb</span><span class="o">.</span><span class="n">worksheets</span><span class="p">[</span><span class="n">worksheet</span><span class="p">]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="bp">self</span><span class="o">.</span><span class="n">ws</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">wb</span><span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">wb</span><span class="o">.</span><span class="n">sheetnames</span><span class="p">[</span><span class="mi">0</span><span class="p">]]</span>
            
    <span class="k">def</span> <span class="nf">read_columns</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">start_row</span><span class="o">=</span><span class="mi">0</span><span class="p">,</span> <span class="n">columns</span><span class="o">=</span><span class="s2">&quot;ABC&quot;</span><span class="p">):</span>
        <span class="k">return</span> <span class="p">[</span><span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="p">[</span><span class="s2">&quot;</span><span class="si">{}{}</span><span class="s2">&quot;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">column</span><span class="p">,</span> <span class="n">row</span><span class="p">)]</span><span class="o">.</span><span class="n">value</span> <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">start_row</span><span class="p">,</span> <span class="nb">len</span><span class="p">(</span><span class="bp">self</span><span class="o">.</span><span class="n">ws</span><span class="o">.</span><span class="n">rows</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span> <span class="k">for</span> <span class="n">column</span>
                <span class="ow">in</span> <span class="n">columns</span><span class="p">]</span>
            
    <span class="k">def</span> <span class="fm">__call__</span><span class="p">(</span><span class="bp">self</span><span class="p">):</span>
        <span class="nb">print</span><span class="p">(</span><span class="nb">dir</span><span class="p">(</span><span class="bp">self</span><span class="p">))</span>

            
<span class="k">class</span> <span class="nc">Write</span><span class="p">(</span><span class="n">Read</span><span class="p">):</span>
    <span class="k">def</span> <span class="fm">__init__</span><span class="p">(</span><span class="n">workbook_name</span><span class="o">=</span><span class="s2">&quot;&quot;</span><span class="p">,</span> <span class="o">*</span><span class="n">args</span><span class="p">,</span> <span class="o">**</span><span class="n">kwargs</span><span class="p">):</span>
        <span class="n">data_only</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data_only&quot;</span><span class="p">)</span>
        <span class="n">sheet_name</span> <span class="o">=</span> <span class="n">kwargs</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="s2">&quot;data_only&quot;</span><span class="p">)</span>
        <span class="n">Read</span><span class="o">.</span><span class="fm">__init__</span><span class="p">(</span><span class="n">workbook_name</span><span class="o">=</span><span class="n">workbook_name</span><span class="p">,</span> <span class="n">read_only</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">data_only</span><span class="o">=</span><span class="n">data_only</span><span class="p">,</span> <span class="n">sheet_name</span><span class="o">=</span><span class="n">sheet_name</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>An extended example script with more complex <code class="docutils literal notranslate"><span class="pre">Read</span></code> and <code class="docutils literal notranslate"><span class="pre">Write</span></code> classes can be downloaded from the <a class="reference external" href="https://github.com/hydro-informatics/material-py-codes/raw/master/workbooks/xlsx.py">course repository</a>.</p>
<div class="admonition-challenge admonition">
<p class="admonition-title">Challenge</p>
<p>What are your favorite fonts, table colors, or layouts? Write your own <code class="docutils literal notranslate"><span class="pre">Read</span></code> and <code class="docutils literal notranslate"><span class="pre">Write</span></code> classes with formatting methods to have a personal template ready to be used at any time.</p>
</div>
</div>
<div class="section" id="an-example-from-water-resources-engineering-and-research">
<h3>An Example from Water Resources Engineering and Research<a class="headerlink" href="#an-example-from-water-resources-engineering-and-research" title="Permalink to this headline">¶</a></h3>
<p>The ecological restoration or enhancement of rivers requires, among other data, information on preferred water depths and flow velocities of target fish species. This information is established by biologists and then often provided in the shape of so-called <a class="reference external" href="https://riverarchitect.github.io/RA_wiki/SHArC#hefish">habitat suitability index (HSI)</a> curves in workbook formats. Typically, we produce geospatially explicit data of water depth and flow velocity with numerical models. The output of two or three-dimensional numerical models is way too large for being handled with office applications. So we need an advanced tool, such as Python, to handle the geospatially explicit data, and read and interpolate HSI curves from workbooks. How does that look like technically? The <a class="reference internal" href="../exercises/ex-geco.html#ex-geco"><span class="std std-ref">exercises on geospatial Python</span></a> will let you dive into aquatic habitat (assessments)…</p>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Familiarize with workbook handling in the <a class="reference internal" href="../exercises/ex-sediment.html#ex-py-sediment"><span class="std std-ref">Sediment transport (1d) exercise</span></a>.</p>
</div>
</div>
</div>
<div class="section" id="json">
<span id="id1"></span><h2>JSON<a class="headerlink" href="#json" title="Permalink to this headline">¶</a></h2>
<p>JavaScript Object Notation (<a class="reference external" href="https://www.json.org/json-en.html">JSON</a>) files have a similar structure to XML and enable the structured storage of (human-readable) data. For instance, the numerical code <em>BASEMENT v.3.x</em> (<a class="reference internal" href="../numerics/basement.html#chpt-basement"><span class="std std-ref">read more in the numerical modeling chapter</span></a>) uses a <em>model.json</em> and a <em>simulation.json</em> file to store model setup parameters such as material properties. Thus, automating numerical model setups and starts with Python involves the modification of model parameters stored in <em>json</em> files. This is where Python steps in with the <code class="docutils literal notranslate"><span class="pre">JSON</span></code> package and <code class="docutils literal notranslate"><span class="pre">pandas</span></code>’ JSON modules.</p>
<div class="section" id="json-file-structure">
<h3>JSON file structure<a class="headerlink" href="#json-file-structure" title="Permalink to this headline">¶</a></h3>
<p>A JSON file consists of two types of data structures, which are <em>dictionary</em> objects and <em>array</em>s in the form of <em>lists</em> of values. The <em>dictionary</em> objects in a JSON file correspond to the same format that we already know in Python: Pairs of <em>keys</em> (names) and <em>values</em> embraced by curly brackets (<em>braces</em>) <code class="docutils literal notranslate"><span class="pre">{&quot;name&quot;:</span> <span class="pre">value}</span></code>. The <code class="docutils literal notranslate"><span class="pre">value</span></code> can be a <em>string</em>, <em>numeric</em>, a comma-separated <em>list</em> <code class="docutils literal notranslate"><span class="pre">[]</span></code> (<em>array</em>) of data, or another <em>dictionary</em>.
The following example shows a JSON file called <code class="docutils literal notranslate"><span class="pre">river_struct.json</span></code> with a <code class="docutils literal notranslate"><span class="pre">RIVER</span></code> key that has a nested dictionary as a value. The value-<em>dictionary</em> contains three keys (<code class="docutils literal notranslate"><span class="pre">NAME</span></code>, <code class="docutils literal notranslate"><span class="pre">GEOMETRY</span></code>, and <code class="docutils literal notranslate"><span class="pre">HYDRAULICS</span></code>).</p>
<div class="admonition-take-a-couple-of-minutes-to-understand-river-struct-json admonition">
<p class="admonition-title">Take a couple of minutes to understand river_struct.json</p>
<ul class="simple">
<li><p>What is the purpose of the <code class="docutils literal notranslate"><span class="pre">FLOWBOUNDARIES</span></code> in <code class="docutils literal notranslate"><span class="pre">GEOMETRY</span></code>?</p></li>
<li><p>How could the <code class="docutils literal notranslate"><span class="pre">FLOWBOUNDARIES</span></code> be related to the <code class="docutils literal notranslate"><span class="pre">BOUNDARY</span></code> key of <code class="docutils literal notranslate"><span class="pre">HYDRAULICS</span></code>?</p></li>
<li><p>What units could the <code class="docutils literal notranslate"><span class="pre">FRICTION</span></code> values correspond to?</p></li>
<li><p>Can you find the river on a map?</p></li>
</ul>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="p">{</span>
	<span class="s2">&quot;RIVER&quot;</span><span class="p">:</span> <span class="p">{</span>
		<span class="s2">&quot;NAME&quot;</span><span class="p">:</span> <span class="s2">&quot;Vanilla Flow&quot;</span><span class="p">,</span>
		<span class="s2">&quot;GEOMETRY&quot;</span><span class="p">:</span> <span class="p">{</span>
			<span class="s2">&quot;REGIONS&quot;</span><span class="p">:</span> <span class="p">[</span>
				<span class="p">{</span>
				  <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;wet&quot;</span><span class="p">,</span>
				  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;riverbed&quot;</span>
				<span class="p">},</span>
				<span class="p">{</span>
				  <span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;dry&quot;</span><span class="p">,</span>
				  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;floodplain&quot;</span>
				<span class="p">}</span>
			<span class="p">],</span>
			<span class="s2">&quot;FLOWBOUNDARIES&quot;</span><span class="p">:</span> <span class="p">[</span>
				<span class="p">{</span>
				  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Inflow&quot;</span><span class="p">,</span>
				  <span class="s2">&quot;nodes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">7</span><span class="p">,</span> <span class="mi">31</span><span class="p">]</span>
				<span class="p">},</span>
				<span class="p">{</span>
				  <span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Outflow&quot;</span><span class="p">,</span>
				  <span class="s2">&quot;nodes&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mi">89</span><span class="p">,</span> <span class="mi">90</span><span class="p">,</span> <span class="mi">76</span><span class="p">,</span> <span class="mi">69</span><span class="p">,</span> <span class="mi">95</span><span class="p">]</span>
				<span class="p">}</span>
			<span class="p">]</span>
		<span class="p">},</span>
		<span class="s2">&quot;HYDRAULICS&quot;</span><span class="p">:</span> <span class="p">{</span>
			<span class="s2">&quot;BOUNDARY&quot;</span><span class="p">:</span> <span class="p">[</span>
				<span class="p">{</span>
					<span class="s2">&quot;discharge_file&quot;</span><span class="p">:</span> <span class="s2">&quot;/simulation/directory/Inflow.txt&quot;</span><span class="p">,</span>
					<span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Inflow&quot;</span><span class="p">,</span>
					<span class="s2">&quot;slope&quot;</span><span class="p">:</span> <span class="mf">0.005</span><span class="p">,</span>
					<span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;hydrograph&quot;</span>
				<span class="p">},</span>
				<span class="p">{</span>
					<span class="s2">&quot;name&quot;</span><span class="p">:</span> <span class="s2">&quot;Outflow&quot;</span><span class="p">,</span>
					<span class="s2">&quot;type&quot;</span><span class="p">:</span> <span class="s2">&quot;zero_gradient&quot;</span>
				<span class="p">}</span>
			<span class="p">],</span>
			<span class="s2">&quot;FRICTION&quot;</span><span class="p">:</span> <span class="p">{</span>
				<span class="s2">&quot;cobble&quot;</span><span class="p">:</span> <span class="mf">20.0</span><span class="p">,</span>
				<span class="s2">&quot;gravel&quot;</span><span class="p">:</span> <span class="mf">26.0</span><span class="p">,</span>
				<span class="s2">&quot;sand&quot;</span><span class="p">:</span> <span class="mi">41</span>
			<span class="p">}</span>
		<span class="p">},</span>
		<span class="s2">&quot;LOCATION&quot;</span><span class="p">:</span> <span class="p">[</span><span class="mf">48.744079</span><span class="p">,</span> <span class="mf">9.103928</span><span class="p">]</span>
	<span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>{&#39;RIVER&#39;: {&#39;NAME&#39;: &#39;Vanilla Flow&#39;,
  &#39;GEOMETRY&#39;: {&#39;REGIONS&#39;: [{&#39;type&#39;: &#39;wet&#39;, &#39;name&#39;: &#39;riverbed&#39;},
    {&#39;type&#39;: &#39;dry&#39;, &#39;name&#39;: &#39;floodplain&#39;}],
   &#39;FLOWBOUNDARIES&#39;: [{&#39;name&#39;: &#39;Inflow&#39;, &#39;nodes&#39;: [1, 3, 7, 31]},
    {&#39;name&#39;: &#39;Outflow&#39;, &#39;nodes&#39;: [89, 90, 76, 69, 95]}]},
  &#39;HYDRAULICS&#39;: {&#39;BOUNDARY&#39;: [{&#39;discharge_file&#39;: &#39;/simulation/directory/Inflow.txt&#39;,
     &#39;name&#39;: &#39;Inflow&#39;,
     &#39;slope&#39;: 0.005,
     &#39;type&#39;: &#39;hydrograph&#39;},
    {&#39;name&#39;: &#39;Outflow&#39;, &#39;type&#39;: &#39;zero_gradient&#39;}],
   &#39;FRICTION&#39;: {&#39;cobble&#39;: 20.0, &#39;gravel&#39;: 26.0, &#39;sand&#39;: 41}},
  &#39;LOCATION&#39;: [48.744079, 9.103928]}}
</pre></div>
</div>
</div>
</div>
</div>
<div class="section" id="read-decode-and-write-encode-json-files-with-the-json-library">
<h3>Read (Decode) and Write (Encode) JSON Files with the <code class="docutils literal notranslate"><span class="pre">json</span></code> Library<a class="headerlink" href="#read-decode-and-write-encode-json-files-with-the-json-library" title="Permalink to this headline">¶</a></h3>
<p>JSON files can be implemented in many programming languages including HTML and Python. This is also the reason why Jupyter notebooks (as used in this eBook) can be run in Python and displayed as a web page. Python has a built-in <code class="docutils literal notranslate"><span class="pre">json</span></code> library that enables JSON decoding and encoding. The <code class="docutils literal notranslate"><span class="pre">json</span></code> library provides a <code class="docutils literal notranslate"><span class="pre">json.dumps(DATA)</span></code> method to “dump” (i.e., encode) data in JSON format. Vice versa, the <code class="docutils literal notranslate"><span class="pre">json.load()</span></code> function reads data from JSON files. The following example illustrates encoding and decoding an arbitrarily nested dataset with the <code class="docutils literal notranslate"><span class="pre">json</span></code> library.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">json</span>
<span class="c1"># create arbitrary nested data (list, dictionary, tuple)</span>
<span class="n">data_for_json</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;list_element1&quot;</span><span class="p">,</span> <span class="p">{</span><span class="s2">&quot;dict_key&quot;</span><span class="p">:</span> <span class="p">(</span><span class="s2">&quot;tuple_element&quot;</span><span class="p">,</span> <span class="s2">&quot;text&quot;</span><span class="p">,</span> <span class="mf">1.0</span><span class="p">,</span> <span class="kc">None</span><span class="p">)}]</span>

<span class="c1"># create a json file</span>
<span class="n">json_file</span> <span class="o">=</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;data/my-first.json&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;w+&quot;</span><span class="p">)</span>
<span class="c1"># encode the random nested data list in json format and write to file</span>
<span class="n">json_file</span><span class="o">.</span><span class="n">write</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data_for_json</span><span class="p">))</span>
<span class="c1"># close file</span>
<span class="n">json_file</span><span class="o">.</span><span class="n">close</span><span class="p">()</span>

<span class="c1"># re-open the json file to read data</span>
<span class="k">with</span> <span class="nb">open</span><span class="p">(</span><span class="s2">&quot;data/my-first.json&quot;</span><span class="p">,</span> <span class="n">mode</span><span class="o">=</span><span class="s2">&quot;r&quot;</span><span class="p">)</span> <span class="k">as</span> <span class="n">re_opened_file</span><span class="p">:</span>
    <span class="n">raw_data</span> <span class="o">=</span> <span class="n">re_opened_file</span><span class="o">.</span><span class="n">readline</span><span class="p">()</span>

<span class="c1"># decode json data in a Python variable</span>
<span class="n">data_from_json</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">raw_data</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">data_from_json</span><span class="p">))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>[&quot;list_element1&quot;, {&quot;dict_key&quot;: [&quot;tuple_element&quot;, &quot;text&quot;, 1.0, null]}]
</pre></div>
</div>
</div>
</div>
<p>The <a class="reference external" href="https://docs.python.org/3/library/json.html">Python docs</a> provide more options and descriptions on using the <code class="docutils literal notranslate"><span class="pre">json</span></code> library. However, here we will (once again) make use of the <em>pandas</em> library, which offers powerful features for handling json data.</p>
</div>
<div class="section" id="read-decode-and-write-encode-json-files-with-pandas">
<span id="read-json"></span><h3>Read (Decode) and Write (Encode) JSON Files with <em>pandas</em><a class="headerlink" href="#read-decode-and-write-encode-json-files-with-pandas" title="Permalink to this headline">¶</a></h3>
<p><em>pandas</em> (recall <a class="reference internal" href="pynum.html#pandas"><span class="std std-ref">data and file handling with pandas</span></a>) enables reading JSON files into its convenient table format with an embedded usage of the <code class="docutils literal notranslate"><span class="pre">json</span></code> library. The following code block uses the <a class="reference external" href="https://pandas.pydata.org/pandas-docs/stable/reference/api/pandas.read_json.html">pandas.read_json(FILE)</a> function to read the above shown <code class="docutils literal notranslate"><span class="pre">RIVER</span></code> sample file (<a class="reference external" href="https://raw.githubusercontent.com/hydro-informatics/jupyter-python-course/main/data/river_struct.json">download river_struct.json</a>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="n">river</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_json</span><span class="p">(</span><span class="s2">&quot;data/river_struct.json&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">river</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p>Since a river without data is like ice cream without taste, we will add (random) data of flow characteristics to the data structure. Let’s assume that we have used the data from <code class="docutils literal notranslate"><span class="pre">river_struct.json</span></code> to simulate a stationary discharge in a two-dimensional numerical model. As a result, we have two regular grids (arrays) with data on flow velocity and water depth. Now, we want to append both the flow velocity and water depth arrays in the form of a result structure (dictionary) to <code class="docutils literal notranslate"><span class="pre">river_struct.json</span></code> and give the river a new name.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># create random data</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">weibull</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>
<span class="n">u</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">weibull</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span><span class="mi">100</span><span class="p">))</span><span class="o">.</span><span class="n">reshape</span><span class="p">(</span><span class="mi">10</span><span class="p">,</span> <span class="mi">10</span><span class="p">)</span>

<span class="c1"># append RESULTS row to pandas dataframe</span>
<span class="n">river_dict</span> <span class="o">=</span> <span class="n">river</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
<span class="n">river_dict</span><span class="p">[</span><span class="s2">&quot;RIVER&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">update</span><span class="p">({</span><span class="s2">&quot;RESULTS&quot;</span><span class="p">:</span> <span class="p">{</span><span class="s2">&quot;water_depth&quot;</span><span class="p">:</span> <span class="n">h</span><span class="p">,</span> <span class="s2">&quot;flow_velocity&quot;</span><span class="p">:</span> <span class="n">u</span><span class="p">}})</span>
<span class="n">updated_river</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="o">.</span><span class="n">from_dict</span><span class="p">(</span><span class="n">river_dict</span><span class="p">)</span>

<span class="c1"># re-NAME RIVER</span>
<span class="n">updated_river</span><span class="p">[</span><span class="s2">&quot;RIVER&quot;</span><span class="p">][</span><span class="s2">&quot;NAME&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&quot;Honey river&quot;</span>
<span class="nb">print</span><span class="p">(</span><span class="n">updated_river</span><span class="p">)</span>

<span class="c1"># export to JSON</span>
<span class="n">updated_river</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="s2">&quot;data/river_results.json&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
</div>
<p><img alt="img" src="https://raw.githubusercontent.com/sschwindt/hydroinformatics/main/docs/img/py-json-file.png" /></p>
<div class="admonition-exercise admonition">
<p class="admonition-title">Exercise</p>
<p>Familiarize with JSON file handling in the <a class="reference internal" href="../exercises/ex-geco.html#ex-geco"><span class="std std-ref">geospatial ecohydraulics</span></a> exercise (requires understanding the full <a class="reference internal" href="../geopy/geo-python.html#sec-geo-python"><span class="std std-ref">geospatial Python chapter</span></a>).</p>
</div>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="learning-success-check-up">
<h1>Learning Success Check-up<a class="headerlink" href="#learning-success-check-up" title="Permalink to this headline">¶</a></h1>
<p>Take the <a class="reference external" href="https://forms.gle/9PkUhSdr37aRnxGy5">learning success test for this Jupyter notebook</a>.</p>
<div class="tip dropdown admonition">
<p class="admonition-title">Unfold QR Code</p>
<img alt="../_images/gle-pyxml.png" src="../_images/gle-pyxml.png" />
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "hydro-informatics/jupyter-python-course",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./jupyter"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="pynum.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Data Files, NumPy &amp; Pandas</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="pyplot.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Plotting</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Sebastian Schwindt, Ricardo Barros<br/>
        
            &copy; Copyright 2022.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>
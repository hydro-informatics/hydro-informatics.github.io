

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Linear Classification &#8212; Hydro-Informatics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script src="../_static/tabs.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"TeX": {"Macros": {"N": "\\mathbb{N}", "floor": ["\\lfloor#1\\rfloor", 1], "bmat": ["\\left[\\begin{array}"], "emat": ["\\end{array}\\right]"]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'datascience/linear-classification';</script>
    <link rel="canonical" href="https://hydro-informatics.com/datascience/linear-classification.html" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Linear Regression" href="linear-regression.html" />
    <link rel="prev" title="Linear Models" href="linear-models.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/icon.jpg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/icon.jpg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../lectures/classroom.html">The Virtual Classroom</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../lectures/principles.html">Principles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/overview.html">Lectures and Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/take-seat.html">Take a Seat</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../get-started/software.html">Software Resources</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../get-started/vm.html">Virtual Machines and Linux</a></li>

<li class="toctree-l2"><a class="reference internal" href="../get-started/ide.html">Integrated Development Environments (IDEs)</a></li>



<li class="toctree-l2"><a class="reference internal" href="../python-basics/pyinstall.html">Python (Installation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get-started/git.html">Version Control : git</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get-started/geo.html">Geospatial Software</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get-started/install-openfoam.html">OpenFOAM (Installation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get-started/install-telemac.html">TELEMAC (Installation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get-started/others.html">Other Software Resources</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Python Basics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../python-basics/python.html">First Steps</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../jupyter/pybase.html">Hello Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jupyter/pyerror.html">Errors, Logging, and Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jupyter/pyloop.html">Loops and Conditional Statements</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../python-basics/modularize.html">Object Orientation</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../jupyter/pyfun.html">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jupyter/pypckg.html">Packages, Modules and Libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jupyter/classes.html">Object Orientation and Classes</a></li>

</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../python-basics/data-handling.html">Data and File Handling</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../jupyter/pynum.html">Data Files, NumPy &amp; Pandas</a></li>





<li class="toctree-l2"><a class="reference internal" href="../jupyter/xml.html">Structured Data (XML, xlsx &amp; JSON)</a></li>

<li class="toctree-l2"><a class="reference internal" href="../jupyter/pyplot.html">Plotting</a></li>

</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../jupyter/pystyle.html">Code Style and Conventions</a></li>

<li class="toctree-l1"><a class="reference internal" href="../jupyter/gui.html">Graphical User Interfaces (GUIs)</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../exercises/python-exercises.html">Python Exercises</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../exercises/ex-ms.html">1d Hydraulics (Manning-Strickler Formula)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exercises/ex-sp.html">Reservoir Volume (Sequent Peak Algorithm)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exercises/ex-floods.html">Flood Return Periods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exercises/ex-sediment.html">1d Sediment Transport</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exercises/ex-gui.html">Create a GUI</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Geospatial Analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../geopy/geospatial-data.html">Geospatial Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../geopy/use-qgis.html">QGIS Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../geopy/drone-processing.html">Process Drone (UAV) Imagery</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../geopy/geo-python.html">Geospatial Python</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../geopy/geo-pckg.html">Geospatial Open Source Python Libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jupyter/geo-shp.html">Shapefile (Vector) Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jupyter/geo-raster.html">Raster (Grid) Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jupyter/geo-convert.html">Vectorize and Rasterize</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jupyter/geo-arcpy.html">The Commercial arcpy Library</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../exercises/geo-exercises.html">Exercises</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../exercises/ex-geco.html">Script a Habitat Suitability Map</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Numerical Modeling</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../numerics/numerical-modeling.html">Principles</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../numerics/basement/basement.html">BASEMENT</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../numerics/pre-qgis-bm.html">Pre-processing with QGIS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../numerics/basement/basement2d.html">Run and Check a Steady 2d Simulation</a></li>



</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../numerics/telemac/telemac.html">TELEMAC</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../numerics/pre-slf-tm.html">Pre-processing</a></li>


<li class="toctree-l2 has-children"><a class="reference internal" href="../numerics/telemac/telemac2d.html">Telemac2d</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../numerics/telemac/telemac2d-steady.html">Steady 2d</a></li>



<li class="toctree-l3"><a class="reference internal" href="../numerics/telemac/telemac2d-unsteady.html">Unsteady 2d</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../numerics/telemac/telemac3d.html">Telemac3d</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../numerics/telemac/telemac3d-slf.html">Steady 3d (SLF - Selafin)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numerics/telemac/telemac3d-med.html">Steady 3d (MED and Salome)</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../numerics/telemac/telemac-gaia.html">Gaia (Morphodynamics)</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../numerics/telemac/gaia-coupling.html">Introduction and Coupling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numerics/telemac/gaia-basics.html">Basic Setup of Gaia</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numerics/telemac/gaia-bedload.html">Bedload</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numerics/telemac/gaia-suspended.html">Suspended Load</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numerics/telemac/gaia-run.html">Run and Analyze</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../numerics/telemac/mass-balance-bc.html">Boundaries &amp; Mass Convergence</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../numerics/telemac/boundaries.html">Boundary Conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numerics/telemac/convergence.html">Convergence (Quantitative)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numerics/telemac/mass-optimization.html">Mass Conservation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../numerics/telemac/roughness.html">Friction (Roughness) Zones</a></li>




<li class="toctree-l2"><a class="reference internal" href="../numerics/telemac/optimization.html">Optimization</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../numerics/openfoam/of-intro.html">OpenFOAM</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../numerics/openfoam/of-tutorial-multiphase.html">Multiphase Solver (interFoam Tutorial)</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../numerics/openfoam/of-tutorial-multiphase-mesh.html">Geometry and Mesh Generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numerics/openfoam/of-tutorial-multiphase-setup.html">Case set-up</a></li>




<li class="toctree-l3"><a class="reference internal" href="../numerics/openfoam/of-tutorial-multiphase-run.html">Run OpenFOAM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numerics/openfoam/of-tutorial-multiphase-post.html">Post-processing</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Machine Learning (ML)</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="machinelearning.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="dimensional-analysis.html">About Data Analysis</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="supervised-learning.html">Supervised Learning</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-17"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 current active has-children"><a class="reference internal" href="linear-models.html">Linear Models</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-18"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l3 current active"><a class="current reference internal" href="#">Linear Classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="linear-regression.html">Linear Regression</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="non-linear-models.html">Non-linear models</a><input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-19"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="kernelized-supervised-models.html">Kernels</a></li>
<li class="toctree-l3"><a class="reference internal" href="morphology-predictor-svm.html">Support Vector Machine (SVM)</a></li>


<li class="toctree-l3"><a class="reference internal" href="three-based-methods.html">Three-based methods (Coming soon)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="neural-networks.html">Neural Networks (Supervised)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="unsupervised-learning.html">Unsupervised Learning (Coming soon)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../documentation/how-to-document.html">How to Markdown and Document</a></li>
<li class="toctree-l1"><a class="reference internal" href="../documentation/glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../documentation/notation.html">Notation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../documentation/bibliography.html">References</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../exercises/docs-exercises.html">Exercises</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-20"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../exercises/ex-git.html">Git and Markdown</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Troubleshoot</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../troubleshoot/dbg-programming.html">Programming Tools and IDEs</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-21"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../troubleshoot/dbg-anaconda.html">Debugging Anaconda</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshoot/dbg-python.html">Debugging Python Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshoot/dbg-jupyter.html">Debugging Jupyter</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../troubleshoot/dbg-numerical-models.html">Numerical Models</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-22"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../troubleshoot/dbg-basement.html">Debugging BASEMENT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshoot/dbg-telemac.html">Debugging TELEMAC</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../troubleshoot/dbg-os.html">Operating Systems (Linux and VMs)</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-23"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../troubleshoot/dbg-linux.html">Debugging Debian Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshoot/dbg-vm.html">Debugging Virtual Machines</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../troubleshoot/dbg-scilife.html">Science Life Hacks</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-24"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../troubleshoot/dbg-gis.html">GIS, CRS and Projections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshoot/dbg-zotero.html">Zotero Utilities</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">About</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../terms/license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../terms/disclaimer.html">Disclaimer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../documentation/contributors.html">Contributors</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">


<a href="https://github.com/hydro-informatics/jupyter-python-course" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/datascience/linear-classification.md" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.md</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Linear Classification</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hyperplanes">Hyperplanes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#perceptron-algorithm">Perceptron algorithm</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#margin-boundaries-and-hinge-loss">Margin boundaries and hinge loss</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#motivation-behind-margin-boundaries">Motivation behind margin boundaries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optimization-problem">Optimization problem</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#margin-boundaries">Margin boundaries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hinge-loss">Hinge loss</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#objective-function">Objective function</a></li>
</ul>
</li>
</ul>
            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="tip admonition">
<p class="admonition-title">Contributor</p>
<p>This chapter was written and developed by <a class="reference external" href="https://beatriznegreiros.com/">Beatriz Negreiros</a> <a class="reference internal" href="../_images/beatriz.jpg"><img alt="Beatriz Negreiros" src="../_images/beatriz.jpg" style="width: 50px; height: 50px;" /></a></p>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="linear-classification">
<span id="linearclassification"></span><h1>Linear Classification<a class="headerlink" href="#linear-classification" title="Permalink to this headline">#</a></h1>
<p>In this section, we will cover the fundamentals of linear classification through a simple ML algorithm, the Perceptron. In addition, we will extend the concepts behind the Perceptron algorithm by considering aspects of <em>regularization</em> to build a margin linear classifier.</p>
<div class="warning admonition">
<p class="admonition-title">Requirements</p>
<ul class="simple">
<li><p>You are familiar with machine learning terms. We recommend reading our <a class="reference external" href="https://hydro-informatics.com/datascience/machinelearning.html">introduction to ML</a> section for familiarizing with the nomenclature we use throughout the website.</p></li>
<li><p>You are familiar with fundamental linear algebra concepts (such as a dot product, vector projections, planes, eigenvectors and eigenvalues). Please refer to the videos of <a class="reference external" href="https://youtu.be/kjBOesZCoqc">3Blue1Brown</a> for a suitable revision if necessary.</p></li>
<li><p>Basic knowledge in Python and array computing with NumPy.</p></li>
</ul>
</div>
<section id="hyperplanes">
<h2>Hyperplanes<a class="headerlink" href="#hyperplanes" title="Permalink to this headline">#</a></h2>
<p>Suppose we wish to classify positive and negative objects from the training set of points below (figure on the left):</p>
<figure class="align-default" id="cloud-points-ml">
<img alt="decisionbound" src="../_images/decision-boundary.png" />
<figcaption>
<p><span class="caption-number">Fig. 249 </span><span class="caption-text">Training set of points with binary labels (+1, -1) and two-dimensional <span class="math notranslate nohighlight">\((x_1, x_2)\)</span> features. The decision boundary (grey line) is defined by the parameter vector <span class="math notranslate nohighlight">\(\theta\)</span>, which is normal to the decision boundary, and offset parameter <span class="math notranslate nohighlight">\(\theta_0\)</span> that linearly separates the data.</span><a class="headerlink" href="#cloud-points-ml" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>The dataset above is considered linearly separable because it exists at least one linear decision boundary capable of splitting the entire dataset correctly. For instance, we could pass a decision boundary like the grey line above (figure on the right)</p>
<p>In this case, since the features <span class="math notranslate nohighlight">\((x_1, x_2) \in \mathbb{R}^2 \)</span>, that is, the feature set belongs to the two-dimensional space, the decision boundary constitutes a line. If we were dealing with a set of features in the three-dimensional space <span class="math notranslate nohighlight">\((x_1, x_2, x_3)\)</span>, the decision boundary would be a plane. Analogously, if our feature set were in a higher-dimensional space, the decision boundary would constitute a <em>hyperplane</em>.</p>
<p>A hyperplane with <span class="math notranslate nohighlight">\(d\)</span> dimensions is conventionally denoted by the vector normal to the plane, <span class="math notranslate nohighlight">\(\theta \in \mathbb{R}^d\)</span>, and offset (scalar) parameter <span class="math notranslate nohighlight">\(\theta_0\)</span>. In the example above, we would define the hyperplane (or decision boundary) as:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
	\theta \cdot X + \theta_0 =0 \equiv \begin{bmatrix} \theta_1 &amp; \theta_2 \end{bmatrix} \cdot \begin{bmatrix} x_1 \\ x_2 \end{bmatrix} + \theta_0 = 0
  \end{split}\]</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that <span class="math notranslate nohighlight">\(\theta\)</span> controls the orientation (slope, or inclination) of the boundary, whereas <span class="math notranslate nohighlight">\(\theta_0\)</span> controls the location (or offset, or bias) of the boundary. Thus, if <span class="math notranslate nohighlight">\(\theta_0 = 0\)</span>, then the decision boundary crosses the origin. <span class="math notranslate nohighlight">\(\theta_0\)</span> is also often called the <em>bias term</em>.</p>
</div>
<p>Our classifier <span class="math notranslate nohighlight">\(h(x, \theta, \theta_0)\)</span> is thus equal to <span class="math notranslate nohighlight">\(sign(\theta \cdot X + \theta_0)\)</span> where <span class="math notranslate nohighlight">\(\theta \in \mathbb{R}^2 \)</span> and <span class="math notranslate nohighlight">\(\theta_0 \in \mathbb{R}\)</span>. Recall the sign function, also known as the signum function, is a mathematical function that returns the sign or direction of a real number. That is, if the input number is positive, negative, or 0, the sign function returns +1, -1, or 0, respectively.</p>
<div class="tip admonition">
<p class="admonition-title">Exercise 1</p>
<p>Try to answer whether the pair of training examples below are linearly separable. Which ones are linearly separable through the origin?</p>
<figure class="align-default" id="exercise-db">
<img alt="ex-decision-bound" src="../_images/exercise-decision-bound.png" />
<figcaption>
<p><span class="caption-number">Fig. 250 </span><span class="caption-text">Exercise 1 on linearly separable pair of examples.</span><a class="headerlink" href="#exercise-db" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<table class="table" id="tab-ml-ex1-solution">
<caption><span class="caption-number">Table 14 </span><span class="caption-text">Solution to the Machine Learning Exercise 1.</span><a class="headerlink" href="#tab-ml-ex1-solution" title="Permalink to this table">#</a></caption>
<colgroup>
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
<col style="width: 20%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Dataset</p></th>
<th class="head"><p>a</p></th>
<th class="head"><p>b</p></th>
<th class="head"><p>c</p></th>
<th class="head"><p>d</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Linearly-separable (LS)?</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
</tr>
<tr class="row-odd"><td><p>LS through origin?</p></td>
<td><p>No</p></td>
<td><p>No</p></td>
<td><p>Yes</p></td>
<td><p>No</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
<section id="perceptron-algorithm">
<h2>Perceptron algorithm<a class="headerlink" href="#perceptron-algorithm" title="Permalink to this headline">#</a></h2>
<p>In the perceptron algorithm, we typically initialize <span class="math notranslate nohighlight">\(\theta\)</span> as zero (zero vector) and loop through the pair of training examples. At every iteration, we will check if the classifier makes a mistake classifying that training example (i-th example), and if so, then we update the parameters of <span class="math notranslate nohighlight">\(\theta\)</span>.</p>
<p>Assume that <span class="math notranslate nohighlight">\(\theta_0 =0\)</span> for simplicity (the decision boundary must pass through the origin). Our perceptron classifier will make a mistake <code class="docutils literal notranslate"><span class="pre">if</span></code> <span class="math notranslate nohighlight">\(y^{(i)}(\theta \cdot x^{(i)}) \leq 0\)</span>. We will then update our <span class="math notranslate nohighlight">\(\theta\)</span> to no longer misclassify that training example. The way to do this is by adding <span class="math notranslate nohighlight">\(y^{(i)}x^{(i)}\)</span> to the previous <span class="math notranslate nohighlight">\(\theta\)</span>. Thus, the update would look like:</p>
<div class="math notranslate nohighlight">
\[
	\theta = \theta + y^{(i)}x^{(i)}
  \]</div>
<div class="tip admonition">
<p class="admonition-title">Exercise 2: Understanding the perceptron update</p>
<p>Try to understand why is this update useful. Hint: substitute the expression for the updates <span class="math notranslate nohighlight">\(\theta\)</span> in the <code class="docutils literal notranslate"><span class="pre">if</span></code> check.</p>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<p>Substituting the expression for the updated <span class="math notranslate nohighlight">\(\theta\)</span> to check if the classifier still makes a mistake in that example:</p>
<div class="math notranslate nohighlight">
\[
	y^{(i)}(\theta + y^{(i)}x^{(i)})x^{(i)}
  \]</div>
<p>We initialize <span class="math notranslate nohighlight">\(\theta\)</span> as zero, thus the expression is simplified to:</p>
<div class="math notranslate nohighlight">
\[
    y^{(i)}(y^{(i)}x^{(i)})x^{(i)}
  \]</div>
<p>Since any label time itself is equal to one (both <span class="math notranslate nohighlight">\(1 * 1\)</span> and <span class="math notranslate nohighlight">\(-1 * -1\)</span> equal 1), the expression turns into:</p>
<div class="math notranslate nohighlight">
\[
    x^{(i)}x^{(i)} = \| x^{(i)} \|^2 &gt; 0 
  \]</div>
<p>This means that that the expression <span class="math notranslate nohighlight">\(y^{(i)}(\theta \cdot x^{(i)}) &gt; 0\)</span> (no mistake). Thus, <span class="math notranslate nohighlight">\(\theta\)</span> was updated so that it doesn’t misclassify the i-th example anymore.</p>
</div>
</div>
<p>We have in hands a set of different training examples which have the potential to nudge/update our classifier in many directions. Thus, it is possible and even expected that the last training examples cause updates that will overwrite earlier, initial updates. This will result that earlier examples will no longer be correctly classified. For this reason, we need to loop through the whole training set multiple <span class="math notranslate nohighlight">\(T\)</span> times to ensure that all examples are correctly classified. Such iterations can be performed both in order or randomly selected from the training examples.</p>
<p>We can code the algorithm as following:</p>
<div class="highlight-python notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>


<span class="c1"># Algorithm always starting to loop from x1</span>
<span class="k">def</span> <span class="nf">perceptron</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">t_times</span><span class="p">):</span>
    <span class="n">n_mistakes</span> <span class="o">=</span> <span class="mi">0</span>

    <span class="c1"># Initialize list to show the progress (updates) of theta</span>
    <span class="n">progress_theta</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># Initialize an array with same size as the total number of examples to count how many mistake are made at each training example</span>
    <span class="n">explicit_mistakes</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros</span><span class="p">(</span><span class="n">shape</span><span class="o">=</span><span class="n">y</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span>

    <span class="c1"># Loop through the training set T times</span>
    <span class="k">for</span> <span class="n">t</span> <span class="ow">in</span> <span class="n">t_times</span><span class="p">:</span>

        <span class="c1"># Loop through the training examples in order</span>
        <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">x</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">X</span><span class="p">):</span>

            <span class="c1"># Check if the algorithm makes a mistake in the i-th (or index-th) example</span>
            <span class="k">if</span> <span class="n">y</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">theta</span><span class="p">,</span> <span class="n">x</span><span class="p">)</span> <span class="o">&lt;=</span> <span class="mi">0</span><span class="p">:</span>
                <span class="c1"># Update theta to no longer misclassify the i-th example</span>
                <span class="n">theta</span> <span class="o">=</span> <span class="n">theta</span> <span class="o">+</span> <span class="n">y</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">*</span> <span class="n">x</span>

                <span class="c1"># Save the update theta</span>
                <span class="n">progress_theta</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">theta</span><span class="p">)</span>

                <span class="c1"># Update total number of mistakes</span>
                <span class="n">n_mistakes</span> <span class="o">+=</span> <span class="mi">1</span>

                <span class="c1"># Update total number of mistakes at the i-th training example</span>
                <span class="n">explicit_mistakes</span><span class="p">[</span><span class="n">index</span><span class="p">]</span> <span class="o">+=</span> <span class="mi">1</span>
    <span class="nb">print</span><span class="p">(</span><span class="s1">&#39;The perceptron did </span><span class="si">{}</span><span class="s1"> mistakes until convergence&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">n_mistakes</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">progress_theta</span><span class="p">,</span> <span class="n">n_mistakes</span><span class="p">,</span> <span class="n">explicit_mistakes</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s1">&#39;__main__&#39;</span><span class="p">:</span>
    <span class="n">X</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="p">[</span><span class="mi">1</span><span class="p">,</span> <span class="mi">0</span><span class="p">],</span> <span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mf">1.5</span><span class="p">]])</span>
    <span class="c1"># X = np.array([[-1, -1], [1, 0], [-1, 10]])</span>

    <span class="n">y</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">])</span>

    <span class="n">t_times</span> <span class="o">=</span> <span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">100</span><span class="p">)</span>

    <span class="n">theta</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="o">-</span><span class="mi">1</span><span class="p">])</span>

    <span class="n">a</span><span class="p">,</span> <span class="n">b</span><span class="p">,</span> <span class="n">c</span> <span class="o">=</span> <span class="n">perceptron</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">,</span> <span class="n">theta</span><span class="p">,</span> <span class="n">t_times</span><span class="p">)</span>
</pre></div>
</div>
</section>
<section id="margin-boundaries-and-hinge-loss">
<h2>Margin boundaries and hinge loss<a class="headerlink" href="#margin-boundaries-and-hinge-loss" title="Permalink to this headline">#</a></h2>
<p>As you may have noticed, the perceptron algorithm features no regularization term. The goal was simply to find any decision boundary that can split the data correctly. Here, we will introduce the concept of <em>hinge loss</em> and <em>margin boundaries</em> to transform the problem of learning a decision boundary into an optimization problem considering regularization.</p>
<section id="motivation-behind-margin-boundaries">
<h3>Motivation behind margin boundaries<a class="headerlink" href="#motivation-behind-margin-boundaries" title="Permalink to this headline">#</a></h3>
<p>Let’s take a look at our previously presented training dataset (figure below). Any decision boundary within the dashed grey lines correctly splits the training examples. However, intuitively, we would like to favor a decision boundary that can maximize the distances between the decision boundary and the training points. The reason to do so is because it’s likely that the points we wish to classify in the future have statistical noise, such that a decision boundary located too close to the training examples is more likely to misclassify slightly changed (noisier) versions of the training examples. In contrast, a classifier that holds a relatively higher margin between the decision boundary and the examples will be probably more successful in classifying future, unseen data.</p>
<figure class="align-default" id="margin-bound">
<img alt="marginbound" src="../_images/margin-bound.png" />
<figcaption>
<p><span class="caption-number">Fig. 251 </span><span class="caption-text">Training set of points with binary labels (+1, -1) in the two-dimensional feature space <span class="math notranslate nohighlight">\((x_1, x_2)\)</span>.  Any decision boundary within the dashed grey lines can correctly split the data.</span><a class="headerlink" href="#margin-bound" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
</section>
<section id="optimization-problem">
<h3>Optimization problem<a class="headerlink" href="#optimization-problem" title="Permalink to this headline">#</a></h3>
<p>Recall that our goal is to find a linear classifier that maximizes the distances between the decision boundary and the training points (margin linear classifier), but also minimizes the training error. Thus, this constitutes an optimization problem that needs to counterbalance these two factors, which we can state as:</p>
<ul class="simple">
<li><p>The margins (distances between the decision boundary and the training points) should be maximized.</p></li>
<li><p>The training error should be minimized. We will express this in term of <em>hinge loss</em>.</p></li>
</ul>
</section>
<section id="margin-boundaries">
<h3>Margin boundaries<a class="headerlink" href="#margin-boundaries" title="Permalink to this headline">#</a></h3>
<p>Previously, we saw that the equation defining a decision boundary satisfies <span class="math notranslate nohighlight">\(\theta \cdot X + \theta_0 =0\)</span>.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Note that according to <span class="math notranslate nohighlight">\(\theta \cdot X + \theta_0 =0\)</span>, any point living exactly at the plane would be misclassified.</p>
</div>
<p>We can now define parallel margin boundaries (dashed line in the previous figure) as:</p>
<div class="math notranslate nohighlight">
\[
	\theta \cdot X + \theta_0 = \pm 1
  \]</div>
<p>Note that we can define the boundaries like this because we have a degree of freedom in our definition of the decision boundary, namely, the magnitude of the normal vector <span class="math notranslate nohighlight">\(\| \theta \|\)</span>. That is, regardless of the value <span class="math notranslate nohighlight">\(\| \theta \|\)</span>, our decision boundary remains unaltered.</p>
<p>Recall the problem of computing the <a class="reference external" href="https://en.wikipedia.org/wiki/Distance_from_a_point_to_a_plane">smallest distance of a point to a plane</a>. This distance is:</p>
<div class="math notranslate nohighlight">
\[
	\frac{\theta \cdot x^{(i)} + \theta_0 }{\| \theta \|}
  \]</div>
<p>We can now calculate the signed distance between the decision boundary and the i-th example as:</p>
<div class="math notranslate nohighlight">
\[
	\gamma_i (\theta, \theta_0) = \frac{\theta \cdot x^{(i)} + \theta_0 }{\| \theta \|}
  \]</div>
<p>Thus, the distance between the margin boundaries and the decision boundary is:</p>
<div class="math notranslate nohighlight">
\[
	\gamma_i (\theta, \theta_0) = \frac{1}{\| \theta \|}
  \]</div>
</section>
<section id="hinge-loss">
<h3>Hinge loss<a class="headerlink" href="#hinge-loss" title="Permalink to this headline">#</a></h3>
<p>We so far know that <span class="math notranslate nohighlight">\(sign(\theta \cdot x^{(i)} + \theta_0 )\)</span> will classify the i-th example. The way to know if the classification agrees with the label is by multiplying it by <span class="math notranslate nohighlight">\(y^{(i)}\)</span>. We can express this agreement also in a slightly modified version, using the hinge loss:</p>
<div class="math notranslate nohighlight">
\[\begin{split}
	Loss_h(z)= \begin{cases} = 0 \;\; \mbox{if} \;\; z \geq 1 \\ =1-z \;\; \mbox{if} \;\;&lt; 1\end{cases}
  \end{split}\]</div>
<p>where <span class="math notranslate nohighlight">\(z\)</span> is the agreement (signed distance from the decision boundary) <span class="math notranslate nohighlight">\(y^{(i)}(\theta \cdot x^{(i)}+\theta_0)\)</span>.</p>
<p>The figure below illustrates how the hinge loss operates along the z-axis (distance from boundary):</p>
<a class="bg-primary mb-1 reference internal image-reference" href="https://www.researchgate.net/publication/341468721/figure/fig5/AS:963539095257091&#64;1606737030212/The-margin-based-Hinge-loss-function.png"><img alt="hinge-loss-function" class="bg-primary mb-1" src="https://www.researchgate.net/publication/341468721/figure/fig5/AS:963539095257091&#64;1606737030212/The-margin-based-Hinge-loss-function.png" style="width: 400px;" /></a>
</section>
<section id="objective-function">
<h3>Objective function<a class="headerlink" href="#objective-function" title="Permalink to this headline">#</a></h3>
<p>So now we can create an objective function that (1) minimizes the average hinge loss over the training examples, and (2) maximizes <span class="math notranslate nohighlight">\(\frac{1}{\| \theta \|}\)</span>. Expression (2) can be also reformulated towards minimizing <span class="math notranslate nohighlight">\(\frac{1}{2}\| \theta \|^2\)</span>. Thus we define the objective function as:</p>
<div class="math notranslate nohighlight">
\[
	C(\theta, \theta_0) = \frac{1}{n}\sum_{i=1}^n Loss_h(y^{(i)}(\theta \cdot x^{(i)}+\theta_0)) + \frac{\lambda}{2} \| \theta \|^2
  \]</div>
<p>where <span class="math notranslate nohighlight">\(\lambda\)</span> is the regularization parameter that balances the importance of minimizing the regularization term <span class="math notranslate nohighlight">\(\frac{\lambda}{2}\| \theta \|^2\)</span> at the cost of incurring more losses (increasing the loss term). Vice versa, the smaller the value of <span class="math notranslate nohighlight">\(\lambda\)</span>, the more emphasis we will give to minimizing average loss.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In optimization, the goal is typically to minimize the objective function, and this is also the established convention in ML, although maximizing can also be a valid objective in certain cases.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">Exercise 3: Understanding the influence of <span class="math notranslate nohighlight">\(\lambda\)</span></p>
<p>Try to understand pictorially the influence of the <span class="math notranslate nohighlight">\(\lambda\)</span> parameter on the margin boundaries and decision boundary. Which of the plots showing optimized margin boundaries below are most likely to correspond to a <span class="math notranslate nohighlight">\(\lambda = 1, 10, \mbox{and} \;1000\)</span></p>
<figure class="align-default" id="lambda-influence">
<img alt="lambdainfluence" src="../_images/exercise-lambda.png" />
<figcaption>
<p><span class="caption-number">Fig. 252 </span><span class="caption-text">Effect of the regularization parameter <span class="math notranslate nohighlight">\(\lambda\)</span> on the optimization solution.</span><a class="headerlink" href="#lambda-influence" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<div class="dropdown admonition">
<p class="admonition-title">Solution</p>
<table class="table" id="tab-ml-ex1-solution3">
<caption><span class="caption-number">Table 15 </span><span class="caption-text">Solution to the Machine Learning Exercise 3.</span><a class="headerlink" href="#tab-ml-ex1-solution3" title="Permalink to this table">#</a></caption>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Plot</p></th>
<th class="head"><p>a</p></th>
<th class="head"><p>b</p></th>
<th class="head"><p>c</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p>Lambda value</p></td>
<td><p>1</p></td>
<td><p>10</p></td>
<td><p>1000</p></td>
</tr>
</tbody>
</table>
</div>
</div>
</section>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "hydro-informatics/jupyter-python-course",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./datascience"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="linear-models.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Linear Models</p>
      </div>
    </a>
    <a class="right-next"
       href="linear-regression.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Linear Regression</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#hyperplanes">Hyperplanes</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#perceptron-algorithm">Perceptron algorithm</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#margin-boundaries-and-hinge-loss">Margin boundaries and hinge loss</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#motivation-behind-margin-boundaries">Motivation behind margin boundaries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#optimization-problem">Optimization problem</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#margin-boundaries">Margin boundaries</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#hinge-loss">Hinge loss</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#objective-function">Objective function</a></li>
</ul>
</li>
</ul>
  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Sebastian Schwindt, Beatriz Negreiros, Federica Scolari, Ricardo Barros
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2023.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>
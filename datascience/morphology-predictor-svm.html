

<!DOCTYPE html>


<html >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="generator" content="Docutils 0.17.1: http://docutils.sourceforge.net/" />

    <title>Support Vector Machine (SVM) &#8212; Hydro-Informatics</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "light";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../_static/styles/theme.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/bootstrap.css?digest=e353d410970836974a52" rel="stylesheet" />
<link href="../_static/styles/pydata-sphinx-theme.css?digest=e353d410970836974a52" rel="stylesheet" />

  
  <link href="../_static/vendor/fontawesome/6.1.2/css/all.min.css?digest=e353d410970836974a52" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../_static/vendor/fontawesome/6.1.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" href="../_static/styles/sphinx-book-theme.css?digest=14f4ca6b54d191a8c7657f6c759bf11a5fb86285" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.4510f1fc1dee50b3e5859aac5469c37c29e427902b24a333a5f9fcb2f0b3ac41.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/design-style.4045f2051d55cab465a707391d5b2007.min.css" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../_static/scripts/bootstrap.js?digest=e353d410970836974a52" />
<link rel="preload" as="script" href="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52" />

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/scripts/sphinx-book-theme.js?digest=5a5c038af52cf7bc1a1ec88eea08e6366ee68824"></script>
    <script src="../_static/tabs.js"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../_static/togglebutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../_static/design-tabs.js"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"
const thebe_selector = ".thebe,.cell"
const thebe_selector_input = "pre"
const thebe_selector_output = ".output, .cell_output"
</script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <script>window.MathJax = {"TeX": {"Macros": {"N": "\\mathbb{N}", "floor": ["\\lfloor#1\\rfloor", 1], "bmat": ["\\left[\\begin{array}"], "emat": ["\\end{array}\\right]"]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'datascience/morphology-predictor-svm';</script>
    <link rel="canonical" href="https://hydro-informatics.com/datascience/morphology-predictor-svm.html" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Three-based methods (Coming soon)" href="three-based-methods.html" />
    <link rel="prev" title="Kernels" href="kernelized-supervised-models.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="None"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <a class="skip-link" href="#main-content">Skip to main content</a>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__primary"
          id="__primary"/>
  <label class="overlay overlay-primary" for="__primary"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          name="__secondary"
          id="__secondary"/>
  <label class="overlay overlay-secondary" for="__secondary"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>
  
    <nav class="bd-header navbar navbar-expand-lg bd-navbar">
    </nav>
  
  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">
  

<a class="navbar-brand logo" href="../index.html">
  
  
  
  
    
    
      
    
    
    <img src="../_static/icon.jpg" class="logo__image only-light" alt="Logo image"/>
    <script>document.write(`<img src="../_static/icon.jpg" class="logo__image only-dark" alt="Logo image"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item"><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        <p aria-level="2" class="caption" role="heading"><span class="caption-text">Get Started</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../lectures/classroom.html">The Virtual Classroom</a><input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-1"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../lectures/principles.html">Principles</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/overview.html">Lectures and Exercises</a></li>
<li class="toctree-l2"><a class="reference internal" href="../lectures/take-seat.html">Take a Seat</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../get-started/software.html">Software Resources</a><input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-2"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../get-started/vm.html">Virtual Machines and Linux</a></li>

<li class="toctree-l2"><a class="reference internal" href="../get-started/ide.html">Integrated Development Environments (IDEs)</a></li>



<li class="toctree-l2"><a class="reference internal" href="../python-basics/pyinstall.html">Python (Installation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get-started/git.html">Version Control : git</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get-started/geo.html">Geospatial Software</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get-started/install-openfoam.html">OpenFOAM (Installation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get-started/install-telemac.html">TELEMAC (Installation)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../get-started/others.html">Other Software Resources</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Python Basics</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../python-basics/python.html">First Steps</a><input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-3"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../jupyter/pybase.html">Hello Data Types</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jupyter/pyerror.html">Errors, Logging, and Debugging</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jupyter/pyloop.html">Loops and Conditional Statements</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../python-basics/modularize.html">Object Orientation</a><input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-4"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../jupyter/pyfun.html">Functions</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jupyter/pypckg.html">Packages, Modules and Libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jupyter/classes.html">Object Orientation and Classes</a></li>

</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../python-basics/data-handling.html">Data and File Handling</a><input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-5"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../jupyter/pynum.html">Data Files, NumPy &amp; Pandas</a></li>





<li class="toctree-l2"><a class="reference internal" href="../jupyter/xml.html">Structured Data (XML, xlsx &amp; JSON)</a></li>

<li class="toctree-l2"><a class="reference internal" href="../jupyter/pyplot.html">Plotting</a></li>

</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="../jupyter/pystyle.html">Code Style and Conventions</a></li>

<li class="toctree-l1"><a class="reference internal" href="../jupyter/gui.html">Graphical User Interfaces (GUIs)</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../exercises/python-exercises.html">Python Exercises</a><input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-6"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../exercises/ex-ms.html">1d Hydraulics (Manning-Strickler Formula)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exercises/ex-sp.html">Reservoir Volume (Sequent Peak Algorithm)</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exercises/ex-floods.html">Flood Return Periods</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exercises/ex-sediment.html">1d Sediment Transport</a></li>
<li class="toctree-l2"><a class="reference internal" href="../exercises/ex-gui.html">Create a GUI</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Geospatial Analysis</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../geopy/geospatial-data.html">Geospatial Data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../geopy/use-qgis.html">QGIS Tutorial</a></li>
<li class="toctree-l1"><a class="reference internal" href="../geopy/drone-processing.html">Process Drone (UAV) Imagery</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../geopy/geo-python.html">Geospatial Python</a><input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-7"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../geopy/geo-pckg.html">Geospatial Open Source Python Libraries</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jupyter/geo-shp.html">Shapefile (Vector) Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jupyter/geo-raster.html">Raster (Grid) Handling</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jupyter/geo-convert.html">Vectorize and Rasterize</a></li>
<li class="toctree-l2"><a class="reference internal" href="../jupyter/geo-arcpy.html">The Commercial arcpy Library</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../exercises/geo-exercises.html">Exercises</a><input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-8"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../exercises/ex-geco.html">Script a Habitat Suitability Map</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Numerical Modeling</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../numerics/numerical-modeling.html">Principles</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../numerics/basement/basement.html">BASEMENT</a><input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-9"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../numerics/pre-qgis-bm.html">Pre-processing with QGIS</a></li>
<li class="toctree-l2"><a class="reference internal" href="../numerics/basement/basement2d.html">Run and Check a Steady 2d Simulation</a></li>



</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../numerics/telemac/telemac.html">TELEMAC</a><input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-10"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../numerics/pre-slf-tm.html">Pre-processing</a></li>


<li class="toctree-l2 has-children"><a class="reference internal" href="../numerics/telemac/telemac2d.html">Telemac2d</a><input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-11"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../numerics/telemac/telemac2d-steady.html">Steady 2d</a></li>



<li class="toctree-l3"><a class="reference internal" href="../numerics/telemac/telemac2d-unsteady.html">Unsteady 2d</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../numerics/telemac/telemac3d.html">Telemac3d</a><input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-12"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../numerics/telemac/telemac3d-slf.html">Steady 3d (SLF - Selafin)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numerics/telemac/telemac3d-med.html">Steady 3d (MED and Salome)</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../numerics/telemac/telemac-gaia.html">Gaia (Morphodynamics)</a><input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-13"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../numerics/telemac/gaia-coupling.html">Introduction and Coupling</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numerics/telemac/gaia-basics.html">Basic Setup of Gaia</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numerics/telemac/gaia-bedload.html">Bedload</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numerics/telemac/gaia-suspended.html">Suspended Load</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numerics/telemac/gaia-run.html">Run and Analyze</a></li>
</ul>
</li>
<li class="toctree-l2 has-children"><a class="reference internal" href="../numerics/telemac/mass-balance-bc.html">Boundaries &amp; Mass Convergence</a><input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-14"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../numerics/telemac/boundaries.html">Boundary Conditions</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numerics/telemac/convergence.html">Convergence (Quantitative)</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numerics/telemac/mass-optimization.html">Mass Conservation</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="../numerics/telemac/roughness.html">Friction (Roughness) Zones</a></li>




<li class="toctree-l2"><a class="reference internal" href="../numerics/telemac/optimization.html">Optimization</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../numerics/openfoam/of-intro.html">OpenFOAM</a><input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-15"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2 has-children"><a class="reference internal" href="../numerics/openfoam/of-tutorial-multiphase.html">Multiphase Solver (interFoam Tutorial)</a><input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-16"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="../numerics/openfoam/of-tutorial-multiphase-mesh.html">Geometry and Mesh Generation</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numerics/openfoam/of-tutorial-multiphase-setup.html">Case set-up</a></li>




<li class="toctree-l3"><a class="reference internal" href="../numerics/openfoam/of-tutorial-multiphase-run.html">Run OpenFOAM</a></li>
<li class="toctree-l3"><a class="reference internal" href="../numerics/openfoam/of-tutorial-multiphase-post.html">Post-processing</a></li>
</ul>
</li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Machine Learning (ML)</span></p>
<ul class="current nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="machinelearning.html">Introduction</a></li>
<li class="toctree-l1"><a class="reference internal" href="dimensional-analysis.html">About Data Analysis</a></li>
<li class="toctree-l1 current active has-children"><a class="reference internal" href="supervised-learning.html">Supervised Learning</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-17"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l2 has-children"><a class="reference internal" href="linear-models.html">Linear Models</a><input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-18"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l3"><a class="reference internal" href="linear-classification.html">Linear Classification</a></li>
<li class="toctree-l3"><a class="reference internal" href="linear-regression.html">Linear Regression</a></li>
</ul>
</li>
<li class="toctree-l2 current active has-children"><a class="reference internal" href="non-linear-models.html">Non-linear models</a><input checked="" class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-19"><i class="fa-solid fa-chevron-down"></i></label><ul class="current">
<li class="toctree-l3"><a class="reference internal" href="kernelized-supervised-models.html">Kernels</a></li>
<li class="toctree-l3 current active"><a class="current reference internal" href="#">Support Vector Machine (SVM)</a></li>


<li class="toctree-l3"><a class="reference internal" href="three-based-methods.html">Three-based methods (Coming soon)</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="neural-networks.html">Neural Networks (Supervised)</a></li>
</ul>
</li>
<li class="toctree-l1"><a class="reference internal" href="unsupervised-learning.html">Unsupervised Learning (Coming soon)</a></li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Documentation</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../documentation/how-to-document.html">How to Markdown and Document</a></li>
<li class="toctree-l1"><a class="reference internal" href="../documentation/glossary.html">Glossary</a></li>
<li class="toctree-l1"><a class="reference internal" href="../documentation/notation.html">Notation</a></li>
<li class="toctree-l1"><a class="reference internal" href="../documentation/bibliography.html">References</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../exercises/docs-exercises.html">Exercises</a><input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-20"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../exercises/ex-git.html">Git and Markdown</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">Troubleshoot</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../troubleshoot/dbg-programming.html">Programming Tools and IDEs</a><input class="toctree-checkbox" id="toctree-checkbox-21" name="toctree-checkbox-21" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-21"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../troubleshoot/dbg-anaconda.html">Debugging Anaconda</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshoot/dbg-python.html">Debugging Python Code</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshoot/dbg-jupyter.html">Debugging Jupyter</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../troubleshoot/dbg-numerical-models.html">Numerical Models</a><input class="toctree-checkbox" id="toctree-checkbox-22" name="toctree-checkbox-22" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-22"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../troubleshoot/dbg-basement.html">Debugging BASEMENT</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshoot/dbg-telemac.html">Debugging TELEMAC</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../troubleshoot/dbg-os.html">Operating Systems (Linux and VMs)</a><input class="toctree-checkbox" id="toctree-checkbox-23" name="toctree-checkbox-23" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-23"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../troubleshoot/dbg-linux.html">Debugging Debian Linux</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshoot/dbg-vm.html">Debugging Virtual Machines</a></li>
</ul>
</li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../troubleshoot/dbg-scilife.html">Science Life Hacks</a><input class="toctree-checkbox" id="toctree-checkbox-24" name="toctree-checkbox-24" type="checkbox"/><label class="toctree-toggle" for="toctree-checkbox-24"><i class="fa-solid fa-chevron-down"></i></label><ul>
<li class="toctree-l2"><a class="reference internal" href="../troubleshoot/dbg-gis.html">GIS, CRS and Projections</a></li>
<li class="toctree-l2"><a class="reference internal" href="../troubleshoot/dbg-zotero.html">Zotero Utilities</a></li>
</ul>
</li>
</ul>
<p aria-level="2" class="caption" role="heading"><span class="caption-text">About</span></p>
<ul class="nav bd-sidenav">
<li class="toctree-l1"><a class="reference internal" href="../terms/license.html">License</a></li>
<li class="toctree-l1"><a class="reference internal" href="../terms/disclaimer.html">Disclaimer</a></li>
<li class="toctree-l1"><a class="reference internal" href="../documentation/contributors.html">Contributors</a></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><label class="sidebar-toggle primary-toggle btn btn-sm" for="__primary" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</label></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://mybinder.org/v2/gh/hydro-informatics/jupyter-python-course/main/v2/gh/hydro-informatics/jupyter-python-course/main?urlpath=lab/tree/datascience/morphology-predictor-svm.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onBinder"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_binder.svg">
  </span>
<span class="btn__text-container">Binder</span>
</a>
</li>
      
      
      
      
      <li><a href="https://colab.research.google.com/github/hydro-informatics/jupyter-python-course/blob/main/datascience/morphology-predictor-svm.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch onColab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img src="../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="initThebeSBT()"
  class="btn btn-sm btn-launch-thebe dropdown-item"
  title="Launch Thebe"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-play"></i>
  </span>
<span class="btn__text-container">Live Code</span>
</button>
</li>
      
  </ul>
</div>



<a href="https://github.com/hydro-informatics/jupyter-python-course" target="_blank"
   class="btn btn-sm btn-source-repository-button"
   title="Source repository"
   data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>

</a>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Download this page">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../_sources/datascience/morphology-predictor-svm.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Download source file"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Print to PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Fullscreen mode"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>


<script>
document.write(`
  <button class="theme-switch-button btn btn-sm btn-outline-primary navbar-btn rounded-circle" title="light/dark" aria-label="light/dark" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="theme-switch" data-mode="light"><i class="fa-solid fa-sun"></i></span>
    <span class="theme-switch" data-mode="dark"><i class="fa-solid fa-moon"></i></span>
    <span class="theme-switch" data-mode="auto"><i class="fa-solid fa-circle-half-stroke"></i></span>
  </button>
`);
</script>

<script>
document.write(`
  <button class="btn btn-sm navbar-btn search-button search-button__button" title="Search" aria-label="Search" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
  </button>
`);
</script>
<label class="sidebar-toggle secondary-toggle btn btn-sm" for="__secondary"title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</label>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Support Vector Machine (SVM)</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contents </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Support Vector Machine (SVM)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#theory">Theory</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#pre-processing">Pre-processing</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-data">Load Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#clean-the-dataset">Clean the Dataset</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#remove-nan-values">Remove NaN Values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#search-outliers">Search Outliers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#remove-outliers">Remove Outliers</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-class-proportions">Verify Class Proportions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#derive-new-predictors">Derive New Predictors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-multicolinearity">Verify Multicolinearity</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variance-inflation-factor-vif">Variance Inflation Factor (VIF)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#remove-features-to-reduce-vif">Remove Features to Reduce VIF</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#split-test-and-training-datasets">Split Test and Training Datasets</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#build-the-svm-model">Build the SVM Model</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-principle">Working Principle</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#k-fold-cross-validation">k-fold Cross Validation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#select-optimum-parameters">Select Optimum Parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#train-optimum-hypothesis-svm-model">Train Optimum Hypothesis SVM Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#performance-evaluation-confusion-matrix">Performance Evaluation (Confusion Matrix)</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article" role="main">
                  
  <div class="tip admonition">
<p class="admonition-title">Contributor</p>
<p>This chapter was written and developed by <a class="reference external" href="https://ricardovobarros.github.io/">Ricardo Barros</a> <a class="reference internal" href="../_images/ricardo.jpg"><img alt="Ricardo Barros" src="../_images/ricardo.jpg" style="width: 50px; height: 50px;" /></a></p>
</div>
<section class="tex2jax_ignore mathjax_ignore" id="support-vector-machine-svm">
<h1>Support Vector Machine (SVM)<a class="headerlink" href="#support-vector-machine-svm" title="Permalink to this headline">#</a></h1>
<p>This tutorial features the Support Vector Machine (SVM) technique for classifying riverbed morphology types as a function of hydraulic and sediment transport data.</p>
<div class="admonition-goals admonition">
<p class="admonition-title">Goals</p>
<ul class="simple">
<li><p>Pre-process a dataset containing hydrodynamic measurements and five river bed morphology classes according to <span id="id1">Montgomery and Buffington [<a class="reference internal" href="../documentation/bibliography.html#id402" title="David R. Montgomery and J. Buffington. Channel-reach morphology in mountain drainage basins. Geological Society of America Bulletin, 109(5):596–611, 1997. doi:10.1130/0016-7606(1997)109$&lt;$0596:CRMIMD$&gt;$2.3.CO;2.">MB97</a>]</span>.</p></li>
<li><p>Use Variance Inflation Index (VIF) to evaluate Multicollinearity among features.</p></li>
<li><p>Train and test a Support Vector Machine (SVM) model to classify river bed morphology using a Radial Basis Function (RBF) kernel.</p></li>
</ul>
</div>
<div class="attention admonition">
<p class="admonition-title">Requirements</p>
<p>Read and understand data handling with <a class="reference internal" href="../jupyter/pynum.html#numpy"><span class="std std-ref">NumPy</span></a>, <a class="reference internal" href="../jupyter/pynum.html#pandas"><span class="std std-ref">Pandas</span></a>, <a class="reference internal" href="../jupyter/pyplot.html#matplotlib"><span class="std std-ref">Matplotlib</span></a>, and <a class="reference internal" href="../jupyter/pyfun.html#chpt-functions"><span class="std std-ref">functions</span></a>. We assume that you are familiar with basic statistic parameters, such as Gaussian probability distributions, their mean, and their standard deviation values.</p>
</div>
<p>Enable interactive reading and executing code blocks with <a class="reference external" href="https://mybinder.org/v2/gh/hydro-informatics/jupyter-python-course/main"><img alt="Binder" src="https://mybinder.org/badge_logo.svg" /></a> and find <em>morphology-predictor-svm.ipynb</em> Alternatively, install <a class="reference internal" href="../python-basics/pyinstall.html#install-python"><span class="std std-ref">Python</span></a> and <a class="reference internal" href="../get-started/ide.html#jupyter"><span class="std std-ref">JupyterLab</span></a> locally and <strong><a class="reference external" href="https://github.com/ricardovobarros/hydro-informatics/tree/main/morphology_predictor">download</a></strong> this Jupyter notebook.</p>
<section id="theory">
<h2>Theory<a class="headerlink" href="#theory" title="Permalink to this headline">#</a></h2>
<p>In the field of restoration science, the identification of river morphology provides essential insights, for instance, to guide target terraforming aiming at re-instating a near-census natural state of a fluvial landscape. In addition, morphological pattern may serve as a predictor for estimating fluvial <a class="reference internal" href="../documentation/glossary.html#term-Sediment-transport"><span class="xref std std-term">sediment transport</span></a> and vice versa. Thus, there is a bidirectional relationship between fluvial hydraulics, sediment transport, and morphological pattern, which represent physical habitat for aquatic species and may even affect energy production <span id="id2">[<a class="reference internal" href="../documentation/bibliography.html#id1402" title="Alain Recking, Guillaume Piton, Daniel Vazquez-Tarrio, and Gary Parker. Quantifying the morphological print of bedload transport. Earth Surface Processes and Landforms, 41(6):809–822, 2016.">RPVTP16</a>]</span>.</p>
<p>Yet, classifying and predicting fluvial morphodynamics is challenging because of the complexity of river ecosystems and every river being a unique environment. However,there are repeating morphological units of rivers with similar characteristics. A basic set of repetitive morphological features was introduced by <span id="id3">Montgomery and Buffington [<a class="reference internal" href="../documentation/bibliography.html#id402" title="David R. Montgomery and J. Buffington. Channel-reach morphology in mountain drainage basins. Geological Society of America Bulletin, 109(5):596–611, 1997. doi:10.1130/0016-7606(1997)109$&lt;$0596:CRMIMD$&gt;$2.3.CO;2.">MB97</a>]</span>, and we will focus in this tutorial on the following five morphological units (click on the items to read more):</p>
<ul class="simple">
<li><p><strong><a class="reference internal" href="../documentation/glossary.html#term-Step-pool"><span class="xref std std-term">Step pool</span></a></strong></p></li>
<li><p><strong><a class="reference internal" href="../documentation/glossary.html#term-Plane-bed"><span class="xref std std-term">Plane bed</span></a></strong></p></li>
<li><p><strong><a class="reference internal" href="../documentation/glossary.html#term-Riffle-pool"><span class="xref std std-term">Riffle pool</span></a></strong></p></li>
<li><p><strong><a class="reference internal" href="../documentation/glossary.html#term-Braiding"><span class="xref std std-term">Braiding</span></a></strong></p></li>
<li><p><strong><a class="reference internal" href="../documentation/glossary.html#term-Sand-bed"><span class="xref std std-term">Sand bed</span></a></strong></p></li>
</ul>
<p>These morphological units can be found in the above-listed order along a river, starting at the source and ending with its estuary. Thus, <em>step pool</em> units can typically be found in upstream (mountain) river section, while <em>sand beds</em> are predominantly existent in shallower river sections, close to estuaries or confluences. Note that there are many other morphological units besides, such as slackwater, swales, or bars <span id="id4">[<a class="reference internal" href="../documentation/bibliography.html#id963" title="J. R. Wyrick and G. B. Pasternack. Geospatial organization of fluvial landforms in a gravel-cobble river: Beyond the riffle-pool couplet. Geomorphology, 213(Supplement C):48–65, 2014. URL: http://www.sciencedirect.com/science/article/pii/S0169555X14000099, doi:10.1016/j.geomorph.2013.12.040.">WP14</a>]</span>. Fig. <a class="reference internal" href="#fig-bed-morphology"><span class="std std-numref">Fig. 258</span></a> illustrates some morphological units of near-census natural rivers.</p>
<figure class="align-default" id="fig-bed-morphology">
<img alt="riverbed morphologies" src="../_images/morphology-overview.jpg" />
<figcaption>
<p><span class="caption-number">Fig. 258 </span><span class="caption-text">a) A colluvial headwater stream (Furtschaglbach, Austria), b) a cascade stream (Torrent des Favrands, France), c) a bedrock stream (Anse St-Jean, Québec, Canada), d) a step-pool stream (Dessoubre, France), e) a plane-bed stream (Dranse, Switzerland), f) a riffle-pool stream (Le diable, Québec, Canada), g) a braided stream (Jenbach, Germany). Source: <span id="id5">Schwindt [<a class="reference internal" href="../documentation/bibliography.html#id523" title="Sebastian Schwindt. Hydro-morphological processes through permeable sediment traps. Thesis No. 7655, Laboratory of Hydraulic Constructions (LCH), Ecole Polytechnique fédérale de Lausanne (EPFL), Lausanne, Switzerland, 2017. URL: https://infoscience.epfl.ch/record/231182, doi:10.5075/epfl-thesis-7655.">Sch17</a>]</span></span><a class="headerlink" href="#fig-bed-morphology" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>To guide restoration actions, experts often visually classify morphology units on-site, though some of them may also be distinguishable on aerial imagery. On-site (<em>in-situ</em>) expert assessments may also serve as ground truth for machine learning models. In this exercise, we will use hydrodynamic parameters with expert-based ground truth from the database <a class="reference external" href="https://en.bedloadweb.com/">https://bedloadweb.com</a>. Thus, at the end of this tutorial, you may be able to reduce a necessary amount of fieldwork, just by using hydraulic parameters that can sometimes also be retrieved from gauging stations. To this end, we will train and test an SVM model that classifies morphological units as a function of data that can be collected <em>in-situ</em> or derived from aerial imagery.</p>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="pre-processing">
<h1>Pre-processing<a class="headerlink" href="#pre-processing" title="Permalink to this headline">#</a></h1>
<section id="load-data">
<h2>Load Data<a class="headerlink" href="#load-data" title="Permalink to this headline">#</a></h2>
<p>We downloaded a dataset from <a class="reference external" href="https://en.bedloadweb.com/">https://bedloadweb.com</a> (<a class="reference external" href="https://raw.githubusercontent.com/hydro-informatics/jupyter-python-course/main/data/bedload_dataset">download the <em>bedload_dataset</em></a> sample):</p>
<ul class="simple">
<li><p>Every sample is derived from the cross-sections of 146 different rivers around the globe.</p></li>
<li><p>The dataset is embraces hydraulic and sediment transport (e.g., grain sizes) though in this tutorial, we will only use the following parameters to train the SVM model:</p>
<ul>
<li><p><strong>W</strong>: Channel width (m)</p></li>
<li><p><strong>S</strong>: Channel slope (m)</p></li>
<li><p><strong>Q</strong>: Discharge (m<span class="math notranslate nohighlight">\(^3\)</span> s<span class="math notranslate nohighlight">\(^{-1}\)</span>)</p></li>
<li><p><strong>U</strong>: Bulk flow velocity (m s<span class="math notranslate nohighlight">\(^{-1}\)</span>)</p></li>
<li><p><strong>H</strong>: Water depth (m)</p></li>
</ul>
</li>
</ul>
<p>In a machine learning context, <strong>these parameters</strong> for predicting morphological units <strong>are also called features</strong>. The first step is to load (and view) the data as a <code class="docutils literal notranslate"><span class="pre">pandas.DataFrame</span></code>:</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>

<span class="n">data</span><span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s2">&quot;data/bedload_dataset&quot;</span><span class="p">)</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>W</th>
      <th>S</th>
      <th>Q</th>
      <th>U</th>
      <th>H</th>
      <th>Morphology</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>65.23</td>
      <td>0.004100</td>
      <td>319.98</td>
      <td>2.90</td>
      <td>1.69</td>
      <td>Riffle-pool</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.30</td>
      <td>0.018000</td>
      <td>1.08</td>
      <td>1.00</td>
      <td>0.32</td>
      <td>Riffle-pool</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.00</td>
      <td>0.001500</td>
      <td>3.96</td>
      <td>0.73</td>
      <td>0.78</td>
      <td>Riffle-pool</td>
    </tr>
    <tr>
      <th>3</th>
      <td>166.12</td>
      <td>0.000680</td>
      <td>1124.18</td>
      <td>1.78</td>
      <td>3.81</td>
      <td>Riffle-pool</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8.38</td>
      <td>0.013018</td>
      <td>2.50</td>
      <td>0.83</td>
      <td>0.38</td>
      <td>Riffle-pool</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1062</th>
      <td>102.00</td>
      <td>0.000960</td>
      <td>171.00</td>
      <td>1.40</td>
      <td>1.20</td>
      <td>Braiding</td>
    </tr>
    <tr>
      <th>1063</th>
      <td>8.40</td>
      <td>0.025000</td>
      <td>3.34</td>
      <td>1.20</td>
      <td>0.33</td>
      <td>Braiding</td>
    </tr>
    <tr>
      <th>1064</th>
      <td>101.00</td>
      <td>0.000440</td>
      <td>260.00</td>
      <td>1.50</td>
      <td>1.80</td>
      <td>Braiding</td>
    </tr>
    <tr>
      <th>1065</th>
      <td>7.50</td>
      <td>0.025000</td>
      <td>2.15</td>
      <td>0.96</td>
      <td>0.30</td>
      <td>Braiding</td>
    </tr>
    <tr>
      <th>1066</th>
      <td>16.90</td>
      <td>0.008000</td>
      <td>12.00</td>
      <td>1.53</td>
      <td>0.46</td>
      <td>Braiding</td>
    </tr>
  </tbody>
</table>
<p>1067 rows × 6 columns</p>
</div></div></div>
</div>
</section>
<section id="clean-the-dataset">
<h2>Clean the Dataset<a class="headerlink" href="#clean-the-dataset" title="Permalink to this headline">#</a></h2>
<p>To avoid the SVM model being affected by statics made based on nonsense entries (e.g., Not-a-Number <strong>NaN</strong>) values or extreme outliers, for instance, resulting from typos, we will make apply some cleaning methods.</p>
<section id="remove-nan-values">
<h3>Remove NaN Values<a class="headerlink" href="#remove-nan-values" title="Permalink to this headline">#</a></h3>
<p>The first cleaning step is to remove <em>NaN</em>s that may lead the SVM model later to making bad conclusions.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># dataset essencial info</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">info</span><span class="p">(),</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
    
<span class="c1"># remove rows that contains at least one NaN value</span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">))</span>

<span class="c1"># verify that all NaN values were removed</span>
<span class="k">for</span> <span class="n">column</span> <span class="ow">in</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">to_list</span><span class="p">():</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">column</span><span class="p">,</span><span class="s2">&quot;:&quot;</span><span class="p">,</span><span class="n">data</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">any</span><span class="p">())</span>
    
<span class="c1"># verify final shape of the dataset  </span>
<span class="nb">print</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;class &#39;pandas.core.frame.DataFrame&#39;&gt;
RangeIndex: 1067 entries, 0 to 1066
Data columns (total 6 columns):
 #   Column      Non-Null Count  Dtype  
---  ------      --------------  -----  
 0   W           1067 non-null   float64
 1   S           1067 non-null   float64
 2   Q           1067 non-null   float64
 3   U           1067 non-null   float64
 4   H           1067 non-null   float64
 5   Morphology  1067 non-null   object 
dtypes: float64(5), object(1)
memory usage: 50.1+ KB
None 

None
W : False
S : False
Q : False
U : False
H : False
Morphology : False
(1067, 6)
</pre></div>
</div>
</div>
</div>
</section>
<section id="search-outliers">
<h3>Search Outliers<a class="headerlink" href="#search-outliers" title="Permalink to this headline">#</a></h3>
<p>Outliers may occur in extreme environment or under extreme conditions (e.g., intense precipitation), but some of them also stem from equipment failures that will affect the performance of the SVM model. Thus, recognizing and removing such device-related outliers is an essential step.</p>
<p>Visualizing the plotted features in a scatter plot can be helpful to spot outliers candidates. The following code block creates scatter plots of every feature, marks the expected value, and the distance of 2 standard deviations (assuming a Gaussian-like distribution) from it.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">mpl_toolkits.axes_grid1</span> <span class="kn">import</span> <span class="n">host_subplot</span>
<span class="kn">import</span> <span class="nn">mpl_toolkits.axisartist</span> <span class="k">as</span> <span class="nn">AA</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

<span class="c1"># visualize scatter of the features </span>
<span class="n">host</span> <span class="o">=</span> <span class="n">host_subplot</span><span class="p">(</span><span class="mi">111</span><span class="p">,</span> <span class="n">axes_class</span><span class="o">=</span><span class="n">AA</span><span class="o">.</span><span class="n">Axes</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">subplots_adjust</span><span class="p">(</span><span class="n">right</span><span class="o">=</span><span class="mf">0.75</span><span class="p">)</span>

<span class="c1"># plot visualization parameters</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">:</span><span class="mi">5</span><span class="p">]</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
<span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;crimson&quot;</span><span class="p">,</span> <span class="s2">&quot;purple&quot;</span><span class="p">,</span> <span class="s2">&quot;limegreen&quot;</span><span class="p">,</span> <span class="s2">&quot;gold&quot;</span><span class="p">,</span> <span class="s2">&quot;blue&quot;</span><span class="p">]</span>
<span class="n">width</span><span class="o">=</span><span class="mf">0.5</span>

<span class="c1"># iterate on features of the dataset (i.e. column names)</span>
<span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">l</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">labels</span><span class="p">):</span>
    <span class="k">if</span> <span class="n">i</span> <span class="o">==</span><span class="mi">0</span><span class="p">:</span>
        <span class="n">ax</span> <span class="o">=</span> <span class="n">host</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="k">else</span><span class="p">:</span>        
        <span class="n">ax</span> <span class="o">=</span> <span class="n">host</span><span class="o">.</span><span class="n">twinx</span><span class="p">()</span>
        <span class="n">new_fixed_axis</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">get_grid_helper</span><span class="p">()</span><span class="o">.</span><span class="n">new_fixed_axis</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_fixed_axis</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;right&quot;</span><span class="p">,</span>
                                            <span class="n">axes</span><span class="o">=</span><span class="n">ax</span><span class="p">,</span>
                                            <span class="n">offset</span><span class="o">=</span><span class="p">(</span><span class="mi">60</span><span class="o">*</span><span class="p">(</span><span class="n">i</span><span class="o">-</span><span class="mi">1</span><span class="p">),</span> <span class="mi">0</span><span class="p">))</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">[</span><span class="s2">&quot;right&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">toggle</span><span class="p">(</span><span class="nb">all</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
        <span class="n">ax</span><span class="o">.</span><span class="n">set_ylabel</span><span class="p">(</span><span class="n">labels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">ones</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">i</span> <span class="o">+</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">shape</span><span class="p">[</span><span class="mi">0</span><span class="p">])</span><span class="o">*</span><span class="n">width</span><span class="o">-</span><span class="n">width</span><span class="o">/</span><span class="mf">2.</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">scatter</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">]],</span><span class="n">color</span><span class="o">=</span><span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
    <span class="n">mean</span> <span class="o">=</span> <span class="n">data</span><span class="p">[</span><span class="sa">f</span><span class="s2">&quot;</span><span class="si">{</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="si">}</span><span class="s2">&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">mean</span><span class="p">()</span>
    <span class="n">std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">i</span><span class="p">]])</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">i</span><span class="o">-</span><span class="n">width</span><span class="o">/</span><span class="mf">2.</span><span class="p">,</span> <span class="n">i</span><span class="o">+</span><span class="n">width</span><span class="o">/</span><span class="mf">2.</span><span class="p">],</span> <span class="p">[</span><span class="n">mean</span><span class="p">,</span> <span class="n">mean</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">plot</span><span class="p">([</span><span class="n">i</span><span class="p">,</span><span class="n">i</span><span class="p">],</span> <span class="p">[</span><span class="n">mean</span><span class="o">-</span><span class="mi">2</span><span class="o">*</span><span class="n">std</span><span class="p">,</span> <span class="n">mean</span><span class="o">+</span><span class="mi">2</span><span class="o">*</span><span class="n">std</span><span class="p">],</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;k&quot;</span><span class="p">)</span>

<span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">labels</span><span class="p">)))</span>
<span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span><span class="n">labels</span><span class="p">)</span>

<span class="n">plt</span><span class="o">.</span><span class="n">draw</span><span class="p">()</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/f43043c7e237f5cf56e68b42135e7ce15976ce3431213811a00d51902fe74b15.png" src="../_images/f43043c7e237f5cf56e68b42135e7ce15976ce3431213811a00d51902fe74b15.png" />
</div>
</div>
</section>
<section id="remove-outliers">
<h3>Remove Outliers<a class="headerlink" href="#remove-outliers" title="Permalink to this headline">#</a></h3>
<p>Outliers can be removed with two different methods:</p>
<ol class="arabic simple">
<li><p>Manual (i.e., expert judgment): identify outliers of the features and remove them by setting limits of their interval.</p></li>
<li><p>Automated: assume a probability distribution and set limits based on low probability of observation occurrence.</p></li>
</ol>
<div class="warning admonition">
<p class="admonition-title">Warning</p>
<p>The automated method is more prone to deleting real, extreme observations. So pay attention in practice!</p>
</div>
<p>The following code blocks implements these two options (manual-expert and automated) methods. The manual outlier removal is <em>hard coded</em> because the limits should be given by experts.</p>
<p>The automated approach (below else statement) assumes the data having a <a class="reference external" href="https://en.wikipedia.org/wiki/Normal_distribution">Gaussian distribution</a>, where points with a so-called <a class="reference external" href="https://en.wikipedia.org/wiki/Standard_score">z-score</a> greater than 4 (four) are removed. Data points with a z-score less or equal to four have a 99.9%-chance of being inside an interval of four standard deviations away from the expected value. Thus, a sample that has a 0.01%-chance of occurrence is considered automatically an outlier and removed from the dataset. Thus, in this case, the z-score represents the standard deviation, and we use the <code class="docutils literal notranslate"><span class="pre">zscore</span></code> function of the <code class="docutils literal notranslate"><span class="pre">scipy</span></code> library.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="kn">import</span> <span class="n">zscore</span>
<span class="c1"># choose the method to remove outliers</span>
<span class="c1"># remove_method = &quot;expert_analysis&quot;</span>
<span class="n">remove_method</span> <span class="o">=</span> <span class="s2">&quot;zscore&quot;</span>

<span class="k">if</span> <span class="s2">&quot;expert&quot;</span> <span class="ow">in</span> <span class="n">remove_method</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;qs&quot;</span><span class="p">]</span><span class="o">&lt;</span><span class="mf">0.02</span><span class="p">)</span> <span class="o">&amp;</span>
                    <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Q&quot;</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">2000</span><span class="p">)</span> <span class="o">&amp;</span>
                    <span class="p">(</span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;W&quot;</span><span class="p">]</span><span class="o">&lt;</span><span class="mi">250</span><span class="p">)]</span>
<span class="k">else</span><span class="p">:</span>
    <span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="p">[(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">zscore</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">!=</span><span class="s2">&quot;Morphology&quot;</span><span class="p">]))</span> <span class="o">&lt;</span> <span class="mi">4</span><span class="p">)</span><span class="o">.</span><span class="n">all</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)]</span>
    
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>W</th>
      <th>S</th>
      <th>Q</th>
      <th>U</th>
      <th>H</th>
      <th>Morphology</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>65.23</td>
      <td>0.004100</td>
      <td>319.98</td>
      <td>2.90</td>
      <td>1.69</td>
      <td>Riffle-pool</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.30</td>
      <td>0.018000</td>
      <td>1.08</td>
      <td>1.00</td>
      <td>0.32</td>
      <td>Riffle-pool</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.00</td>
      <td>0.001500</td>
      <td>3.96</td>
      <td>0.73</td>
      <td>0.78</td>
      <td>Riffle-pool</td>
    </tr>
    <tr>
      <th>3</th>
      <td>166.12</td>
      <td>0.000680</td>
      <td>1124.18</td>
      <td>1.78</td>
      <td>3.81</td>
      <td>Riffle-pool</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8.38</td>
      <td>0.013018</td>
      <td>2.50</td>
      <td>0.83</td>
      <td>0.38</td>
      <td>Riffle-pool</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1062</th>
      <td>102.00</td>
      <td>0.000960</td>
      <td>171.00</td>
      <td>1.40</td>
      <td>1.20</td>
      <td>Braiding</td>
    </tr>
    <tr>
      <th>1063</th>
      <td>8.40</td>
      <td>0.025000</td>
      <td>3.34</td>
      <td>1.20</td>
      <td>0.33</td>
      <td>Braiding</td>
    </tr>
    <tr>
      <th>1064</th>
      <td>101.00</td>
      <td>0.000440</td>
      <td>260.00</td>
      <td>1.50</td>
      <td>1.80</td>
      <td>Braiding</td>
    </tr>
    <tr>
      <th>1065</th>
      <td>7.50</td>
      <td>0.025000</td>
      <td>2.15</td>
      <td>0.96</td>
      <td>0.30</td>
      <td>Braiding</td>
    </tr>
    <tr>
      <th>1066</th>
      <td>16.90</td>
      <td>0.008000</td>
      <td>12.00</td>
      <td>1.53</td>
      <td>0.46</td>
      <td>Braiding</td>
    </tr>
  </tbody>
</table>
<p>1038 rows × 6 columns</p>
</div></div></div>
</div>
</section>
</section>
<section id="verify-class-proportions">
<h2>Verify Class Proportions<a class="headerlink" href="#verify-class-proportions" title="Permalink to this headline">#</a></h2>
<p>A machine learning model requires the ground truth data to comply with some quality standard. Those involve (among others):</p>
<ul class="simple">
<li><p>Every combination of models needs a different minimum number of samples to have <a class="reference external" href="https://en.wikipedia.org/wiki/Statistical_significance">statistical significance</a>. It is not a trivial task to identify the minimum number of samples that yield a trustworthy model. However, to represent a class properly (whatever that means), the so-called <a class="reference external" href="https://www.investopedia.com/terms/f/frequencydistribution.asp#:~:text=A%20frequency%20distribution%20is%20a,observations%20within%20a%20given%20interval.&amp;text=The%20intervals%20must%20be%20mutually,used%20within%20a%20statistical%20context.">frequency distribution</a> of every feature must be similar to the <a class="reference external" href="https://www.bmj.com/about-bmj/resources-readers/publications/statistics-square-one/3-populations-and-samples">population</a> frequency distribution.</p></li>
<li><p>Having more than <a class="reference external" href="https://math.stackexchange.com/questions/1287990/estimating-population-standard-deviation-with-sample-standard-deviation">30 samples</a> when dealing with normally distributed variables is a good-practice rule of thumb.</p></li>
<li><p>Ideally, the classes used for a classification problem should be represented by a similar quantity of samples. An unbalanced dataset may produce a model that gives preference to classifying correctly the class with a larger number of samples. This is a consequence of using accuracy as a performance metric. Accuracy is the ratio of correct and the total number of predictions (<span class="math notranslate nohighlight">\(accuracy =  n_{correct\_prediction}/ n_{of\_samples}\)</span>). By preferencing the total number of correct predictions over a balanced one, accuracy masks the importance of getting the under-represented classes correctly.</p></li>
<li><p>Solutions for balancing unbalanced samples embrace:</p>
<ul>
<li><p>Collecting or generating new data (e.g., <a class="reference external" href="https://en.wikipedia.org/wiki/Monte_Carlo_method">Monte Carlo</a> methods). If available, <a class="reference external" href="https://en.wikipedia.org/wiki/Precision_and_recall">precision</a> is preferable for measuring model peformance (instead of accuracy).</p></li>
<li><p><a class="reference external" href="https://www.kdnuggets.com/2019/11/machine-learning-what-why-how-weighting.html">Weighting</a> class features, which means to assign weights to increase the importance of under-represented classes correctly. In classification problems, testing different combinations of weight yield an <a class="reference external" href="https://www.analyticsvidhya.com/blog/2020/06/auc-roc-curve-machine-learning/#:~:text=Like%20I%20said%20before%2C%20the,the%20One%20vs%20All%20technique.">ROC curve</a>, which shows the effect of varying weights on model performance.</p></li>
</ul>
</li>
</ul>
<p>In this tutorial, the samples can be considered balanced, except for the sand bed class (see output below). Weighting and ROC curves are not considered here. If sensitivity and specification of the sand bed class were acceptable when classifying test data, the model could also be used for sand bed classification without the need for using balancing techniques.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">data</span><span class="p">[</span><span class="s2">&quot;Morphology&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Step-pool      247
Plane Bed      243
Riffle-pool    241
Braiding       228
Sand bed        79
Name: Morphology, dtype: int64
</pre></div>
</div>
</div>
</div>
</section>
<section id="derive-new-predictors">
<h2>Derive New Predictors<a class="headerlink" href="#derive-new-predictors" title="Permalink to this headline">#</a></h2>
<p>Sometimes it is possible to compute new meaningful features from the existing ones. For instance, known predictors for morphology are:</p>
<ul class="simple">
<li><p>the product of (energy) slope <span class="math notranslate nohighlight">\(S\)</span> (-), bulk flow velocity <span class="math notranslate nohighlight">\(U\)</span> (m/s), and water depth <span class="math notranslate nohighlight">\(H\)</span> (m), which basically represents <a class="reference internal" href="../documentation/glossary.html#term-Dimensionless-bed-shear-stress"><span class="xref std std-term">shear stress</span></a></p></li>
<li><p>the ratio of discharge <span class="math notranslate nohighlight">\(Q\)</span> (m<span class="math notranslate nohighlight">\(^3\)</span>/s) and width <span class="math notranslate nohighlight">\(W\)</span> (m) (i.e., Q/W)</p></li>
</ul>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Deriving new features from existing ones through simple operations may introduce spurious correlation, which results in unreliable models.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">warnings</span>
<span class="kn">from</span> <span class="nn">pandas.core.common</span> <span class="kn">import</span> <span class="n">SettingWithCopyWarning</span>
<span class="n">warnings</span><span class="o">.</span><span class="n">simplefilter</span><span class="p">(</span><span class="n">action</span><span class="o">=</span><span class="s2">&quot;ignore&quot;</span><span class="p">,</span> <span class="n">category</span><span class="o">=</span><span class="n">SettingWithCopyWarning</span><span class="p">)</span>

<span class="c1"># compute new columns for the new features SUH and Q/W</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;SUH&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s2">&quot;S&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s2">&quot;U&quot;</span><span class="p">]</span><span class="o">*</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s2">&quot;H&quot;</span><span class="p">])</span>
<span class="n">data</span><span class="p">[</span><span class="s2">&quot;Q/W&quot;</span><span class="p">]</span> <span class="o">=</span> <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s2">&quot;Q&quot;</span><span class="p">]</span><span class="o">/</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="s2">&quot;W&quot;</span><span class="p">])</span>
<span class="n">data</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>W</th>
      <th>S</th>
      <th>Q</th>
      <th>U</th>
      <th>H</th>
      <th>Morphology</th>
      <th>SUH</th>
      <th>Q/W</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>65.23</td>
      <td>0.004100</td>
      <td>319.98</td>
      <td>2.90</td>
      <td>1.69</td>
      <td>Riffle-pool</td>
      <td>0.020094</td>
      <td>4.905412</td>
    </tr>
    <tr>
      <th>1</th>
      <td>3.30</td>
      <td>0.018000</td>
      <td>1.08</td>
      <td>1.00</td>
      <td>0.32</td>
      <td>Riffle-pool</td>
      <td>0.005760</td>
      <td>0.327273</td>
    </tr>
    <tr>
      <th>2</th>
      <td>7.00</td>
      <td>0.001500</td>
      <td>3.96</td>
      <td>0.73</td>
      <td>0.78</td>
      <td>Riffle-pool</td>
      <td>0.000854</td>
      <td>0.565714</td>
    </tr>
    <tr>
      <th>3</th>
      <td>166.12</td>
      <td>0.000680</td>
      <td>1124.18</td>
      <td>1.78</td>
      <td>3.81</td>
      <td>Riffle-pool</td>
      <td>0.004612</td>
      <td>6.767277</td>
    </tr>
    <tr>
      <th>4</th>
      <td>8.38</td>
      <td>0.013018</td>
      <td>2.50</td>
      <td>0.83</td>
      <td>0.38</td>
      <td>Riffle-pool</td>
      <td>0.004106</td>
      <td>0.298329</td>
    </tr>
    <tr>
      <th>...</th>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
      <td>...</td>
    </tr>
    <tr>
      <th>1062</th>
      <td>102.00</td>
      <td>0.000960</td>
      <td>171.00</td>
      <td>1.40</td>
      <td>1.20</td>
      <td>Braiding</td>
      <td>0.001613</td>
      <td>1.676471</td>
    </tr>
    <tr>
      <th>1063</th>
      <td>8.40</td>
      <td>0.025000</td>
      <td>3.34</td>
      <td>1.20</td>
      <td>0.33</td>
      <td>Braiding</td>
      <td>0.009900</td>
      <td>0.397619</td>
    </tr>
    <tr>
      <th>1064</th>
      <td>101.00</td>
      <td>0.000440</td>
      <td>260.00</td>
      <td>1.50</td>
      <td>1.80</td>
      <td>Braiding</td>
      <td>0.001188</td>
      <td>2.574257</td>
    </tr>
    <tr>
      <th>1065</th>
      <td>7.50</td>
      <td>0.025000</td>
      <td>2.15</td>
      <td>0.96</td>
      <td>0.30</td>
      <td>Braiding</td>
      <td>0.007200</td>
      <td>0.286667</td>
    </tr>
    <tr>
      <th>1066</th>
      <td>16.90</td>
      <td>0.008000</td>
      <td>12.00</td>
      <td>1.53</td>
      <td>0.46</td>
      <td>Braiding</td>
      <td>0.005630</td>
      <td>0.710059</td>
    </tr>
  </tbody>
</table>
<p>1038 rows × 8 columns</p>
</div></div></div>
</div>
</section>
<section id="verify-multicolinearity">
<h2>Verify Multicolinearity<a class="headerlink" href="#verify-multicolinearity" title="Permalink to this headline">#</a></h2>
<p>Correlated features (i.e., statistically dependent measurement parameters) may result in unreliable models. For instance, consider a scientist who wants to use machine learning (ML) models to predict the number of tourists that get sun-burned in Brazil during their vacation. She wants to use solar radiation intensity and the number of icecream scoops sold as features. The scientist may find that both features are relevant to predict the number of sun-burned tourist, but the reason for this finding is that the number of icecream scoops sold, and sun intensity are correlated. Thus, the scientist has no way to know what is the real importance of each feature in predicting sun-burned tourists because the features grow and decrease simultaneously. By the way, icecream consumption and sun burns have no causality in common, but that is another subject.</p>
<p>To this end, it is important to investigate the correlation among features and consider eliminating the correlated features to produce a more reliable model. One way to visually spot colinearity is plotting the combination of two variables in a scatter plot. For this purpose, the below figure aids in spotting the following aspects of the <code class="docutils literal notranslate"><span class="pre">bedload_dataset</span></code>:</p>
<ul class="simple">
<li><p>There is a strong linear correlation between the <span class="math notranslate nohighlight">\(H\)</span> and <span class="math notranslate nohighlight">\(Q/W\)</span> features.</p></li>
<li><p>There is no linear correlation between <span class="math notranslate nohighlight">\(W\)</span> and <span class="math notranslate nohighlight">\(U\)</span>.</p></li>
<li><p>The flow velocity <span class="math notranslate nohighlight">\(U\)</span> distribuiton is approximately normal (see main diagonal).</p></li>
</ul>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>

<span class="c1"># plot scatter of the 2d (two dimensinal) combination of features</span>
<span class="n">sns</span><span class="o">.</span><span class="n">pairplot</span><span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">!=</span><span class="s2">&quot;Morphology&quot;</span><span class="p">])</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/69a5a5d966c0452da2e7f7a30529dd7daef3d91680730acde792944c8497d225.png" src="../_images/69a5a5d966c0452da2e7f7a30529dd7daef3d91680730acde792944c8497d225.png" />
</div>
</div>
<p>In addition, a <a class="reference external" href="https://en.wikipedia.org/wiki/Heat_map#:~:text=A%20heat%20map%20">heatmap</a> is another efficient method to visualize linear correlation among features. Also computing <a class="reference external" href="https://en.wikiversity.org/wiki/Correlation#:~:text=Linear%20correlation%20refers%20to%20straight,late%2019th%20century%5B1%5D.">linear correlation</a> enables quantitative analysis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">seaborn</span> <span class="kn">import</span> <span class="n">heatmap</span>

<span class="c1"># verify linear coorralation </span>
<span class="n">feature_corr_df</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="o">!=</span><span class="s2">&quot;Morphology&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">corr</span><span class="p">()</span>
<span class="n">mask</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">zeros_like</span><span class="p">(</span><span class="n">feature_corr_df</span><span class="p">)</span> 
<span class="n">mask</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">triu_indices_from</span><span class="p">(</span><span class="n">mask</span><span class="p">)]</span> <span class="o">=</span> <span class="kc">True</span>
<span class="n">sns</span><span class="o">.</span><span class="n">heatmap</span><span class="p">(</span><span class="n">feature_corr_df</span><span class="p">,</span> 
            <span class="n">annot</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="c1"># print value inside the grid</span>
            <span class="n">mask</span><span class="o">=</span><span class="n">mask</span> <span class="c1"># mask values (boolean matrix)</span>
           <span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_plain highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>&lt;AxesSubplot:&gt;
</pre></div>
</div>
<img alt="../_images/9b3f789d25afc222c36fed562d6eb2ed58f651887c56d3e7d05759b343daf567.png" src="../_images/9b3f789d25afc222c36fed562d6eb2ed58f651887c56d3e7d05759b343daf567.png" />
</div>
</div>
</section>
<section id="variance-inflation-factor-vif">
<h2>Variance Inflation Factor (VIF)<a class="headerlink" href="#variance-inflation-factor-vif" title="Permalink to this headline">#</a></h2>
<p>A straightforward method to evaluate <a class="reference external" href="https://towardsdatascience.com/statistics-in-python-collinearity-and-multicollinearity-4cc4dcd82b3f">multicollinerity</a> is computing the Variance Inflation Factor (<strong>VIF</strong>) for every feature, which quantifies the correlation among features.</p>
<p>The first step to compute the VIF is treating a feature as a <a class="reference external" href="https://www.scribbr.com/methodology/independent-and-dependent-variables/#:~:text=The%20independent%20variable%20is%20the,changes%20in%20the%20independent%20variable.">dependent variable</a> and fit a <a class="reference external" href="https://www.youtube.com/watch?v=nk2CQITm_eo">linear regression model</a> using the other features as <a class="reference external" href="https://www.scribbr.com/methodology/independent-and-dependent-variables/#:~:text=The%20independent%20variable%20is%20the,changes%20in%20the%20independent%20variable.">independent variable</a>. Second, store the corresponding mean square errors <span class="math notranslate nohighlight">\(MSE\)</span> yielded by the linear model.</p>
<p>Finally, VIF can be computed for each feature by the following equation:</p>
<div class="math notranslate nohighlight">
\[
VIF_{feature(n)} = 1/(1-MSE^2_{feature(n)})
\]</div>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(VIF_{feature(n)}\)</span> is the variance inflation factor of the <span class="math notranslate nohighlight">\(n_{th}\)</span> feature, and</p></li>
<li><p><span class="math notranslate nohighlight">\(MSE^2_{feature(n)}\)</span> is the mean square error resulting from the linear regression of the <span class="math notranslate nohighlight">\(n_{th}\)</span> feature.</p></li>
</ul>
<p>Note that the smaller the MSE (better linear regression model), the greater is the inflation. In other words, large VIF values indicate high correlation of the feature under consideration with <em>at least</em> one of the other features. Still, it is not possible to say based on VIF only, which <em>other feature</em> is causing VIF to inflate.</p>
<p>As rule of thumb, a VIF greater than 10 (ten) indicates an unsuitable set of features to produce a reliable ML model. Ideally, the VIF should remain smaller than 5 (five), which is considered moderate correlation <span id="id6">[<a class="reference internal" href="../documentation/bibliography.html#id1404" title="George R Franke. Multicollinearity. Wiley international encyclopedia of marketing, 2010.">Fra10</a>]</span>. However, these reference values are not a generally and always applicable rule. VIF equal to or greater than 10 can still yield a good model.</p>
<p>Further analysis to study the impact of a high VIF on correlated features can be carried out by removing each feature at a time and investigate how the feature removal affects the variation of the <a class="reference external" href="https://en.wikipedia.org/wiki/Standard_error">standard error</a> and <a class="reference external" href="https://www.youtube.com/watch?v=Cba9LJ9lS8s&amp;t=53s">p-value</a> of the model.</p>
<p>In this tutorial, 2 features have a VIF <span class="math notranslate nohighlight">\(&gt; \)</span>10 (notably, <span class="math notranslate nohighlight">\(H\)</span> and <span class="math notranslate nohighlight">\(Q/W\)</span>), as the following code block shows.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.linear_model</span> <span class="kn">import</span> <span class="n">LinearRegression</span>

<span class="c1"># compute VIF for the features</span>
<span class="k">def</span> <span class="nf">calculate_vif</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">features</span><span class="p">):</span>
    <span class="n">vif</span><span class="p">,</span> <span class="n">tolerance</span> <span class="o">=</span> <span class="p">{},</span> <span class="p">{}</span>
    
    <span class="k">for</span> <span class="n">feature</span> <span class="ow">in</span> <span class="n">features</span><span class="p">:</span>        
        <span class="c1"># extract all the other features you will regress against</span>
        <span class="n">X</span> <span class="o">=</span> <span class="p">[</span><span class="n">f</span> <span class="k">for</span> <span class="n">f</span> <span class="ow">in</span> <span class="n">features</span> <span class="k">if</span> <span class="n">f</span> <span class="o">!=</span> <span class="n">feature</span><span class="p">]</span>
        <span class="n">X</span><span class="p">,</span> <span class="n">y</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">X</span><span class="p">],</span> <span class="n">df</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span>
        
        <span class="c1"># extract r-squared from the fit</span>
        <span class="n">r2</span> <span class="o">=</span> <span class="n">LinearRegression</span><span class="p">()</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X</span><span class="p">,</span> <span class="n">y</span><span class="p">)</span>

        <span class="c1"># compute VIF</span>
        <span class="n">vif</span><span class="p">[</span><span class="n">feature</span><span class="p">]</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">/</span> <span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="n">r2</span><span class="p">)</span>
    <span class="c1"># return VIF DataFrame</span>
    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;VIF&#39;</span><span class="p">:</span> <span class="n">vif</span><span class="p">})</span>

<span class="c1"># call fuction calculate_vif with features as input</span>
<span class="n">calculate_vif</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> 
              <span class="n">features</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="s2">&quot;Morphology&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VIF</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>H</th>
      <td>14.721236</td>
    </tr>
    <tr>
      <th>Q</th>
      <td>9.278038</td>
    </tr>
    <tr>
      <th>Q/W</th>
      <td>27.648327</td>
    </tr>
    <tr>
      <th>S</th>
      <td>2.983335</td>
    </tr>
    <tr>
      <th>SUH</th>
      <td>3.028896</td>
    </tr>
    <tr>
      <th>U</th>
      <td>6.515027</td>
    </tr>
    <tr>
      <th>W</th>
      <td>4.691707</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="remove-features-to-reduce-vif">
<h2>Remove Features to Reduce VIF<a class="headerlink" href="#remove-features-to-reduce-vif" title="Permalink to this headline">#</a></h2>
<p>With the goal of reducing the feature VIFs to less than 5, we use a trial-and-error approach in this tutorial. Modifying the below code block shows that removing <span class="math notranslate nohighlight">\(H\)</span> and <span class="math notranslate nohighlight">\(Q\)</span> is enough to reduce the VIFs of the remaining features to less than 5. In particular, these two removed variables also go into above-introduced features <span class="math notranslate nohighlight">\(Q/W\)</span> and <span class="math notranslate nohighlight">\(SUH\)</span>. Thus, although <span class="math notranslate nohighlight">\(H\)</span> and <span class="math notranslate nohighlight">\(Q\)</span> are removed, they still “contribute information” to the final model.</p>
<p>Combining correlated features to procduce a new one, and later removing them, is a common approach to reduce VIFs. Since we yielded good VIF values by removing some of the features, no further analysis is necessary.</p>
<div class="admonition-principal-component-analysis-pca admonition">
<p class="admonition-title">Principal Component Analysis (PCA)</p>
<p>Alternatively, a <a class="reference external" href="https://www.youtube.com/watch?v=FgakZw6K1QQ">Principal Component Analysis (PCA)</a> is an effective method for reducing dimensionality (i.e., the number of dataset features going into a model) to increase the reliability of a model, and at the same time, minimize information loss.</p>
</div>
<p>Finally, the features that are used to train and test the SVM model are shown by the output of the code block below.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># try and error approach removing features get VIFs &lt; 10 </span>
<span class="n">data</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span><span class="s2">&quot;H&quot;</span><span class="p">)</span><span class="o">&amp;</span>
                                <span class="p">(</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span><span class="s2">&quot;Q&quot;</span><span class="p">)</span>
                               <span class="p">]</span>
               <span class="p">]</span>

<span class="c1"># compute VIF again to verify if VIFs are less than 5</span>
<span class="n">calculate_vif</span><span class="p">(</span><span class="n">df</span><span class="o">=</span><span class="n">data</span><span class="p">,</span> 
              <span class="n">features</span><span class="o">=</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="s2">&quot;Morphology&quot;</span><span class="p">]</span><span class="o">.</span><span class="n">to_list</span><span class="p">())</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output text_html"><div>
<style scoped>
    .dataframe tbody tr th:only-of-type {
        vertical-align: middle;
    }

    .dataframe tbody tr th {
        vertical-align: top;
    }

    .dataframe thead th {
        text-align: right;
    }
</style>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>VIF</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>Q/W</th>
      <td>3.628840</td>
    </tr>
    <tr>
      <th>S</th>
      <td>2.451387</td>
    </tr>
    <tr>
      <th>SUH</th>
      <td>2.855595</td>
    </tr>
    <tr>
      <th>U</th>
      <td>4.778947</td>
    </tr>
    <tr>
      <th>W</th>
      <td>1.872494</td>
    </tr>
  </tbody>
</table>
</div></div></div>
</div>
</section>
<section id="split-test-and-training-datasets">
<h2>Split Test and Training Datasets<a class="headerlink" href="#split-test-and-training-datasets" title="Permalink to this headline">#</a></h2>
<p>The last preparation step for building the SVM model is to derive a training and a testing dataset from the entire <code class="docutils literal notranslate"><span class="pre">bedload_dataset</span></code>. Choosing a share for data to compose a training and a testing dataset is commonly a heuristic choice. Here,  we use 33% of the data for testing a final hypothesis later. Note that inside the split datasets, the index of the samples (rows of the tabular data) have their corresponding class inside the <em>target datasets</em>.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span> 


<span class="c1"># split dataframes with features and labels only</span>
<span class="n">labels</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="s2">&quot;Morphology&quot;</span><span class="p">]</span>
<span class="n">predictors</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="n">data</span><span class="o">.</span><span class="n">columns</span><span class="p">[</span><span class="n">data</span><span class="o">.</span><span class="n">columns</span> <span class="o">!=</span> <span class="s2">&quot;Morphology&quot;</span><span class="p">]]</span>

<span class="c1"># split testing set as 33% of the data</span>
<span class="c1"># X correspond to the featues (matrix form)</span>
<span class="c1"># y corresponf to the labels (vector form)</span>
<span class="n">X_train</span><span class="p">,</span> <span class="n">X_test</span><span class="p">,</span> <span class="n">y_train</span><span class="p">,</span> <span class="n">y_test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">predictors</span><span class="p">,</span>  
                                                    <span class="n">labels</span><span class="p">,</span>
                                                    <span class="n">test_size</span><span class="o">=</span><span class="mf">0.3</span><span class="p">,</span> 
                                                    <span class="n">random_state</span><span class="o">=</span><span class="mi">42</span> <span class="c1"># seed for random selection of data</span>
                                                   <span class="p">)</span>

<span class="c1"># visualize training and testing sets</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TRAINING DATASET PREDICTORS&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_train</span><span class="o">.</span><span class="n">head</span><span class="p">(),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;dataframe size&quot;</span><span class="p">,</span> <span class="n">X_train</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;------------------------------------------&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TRAINING DATASET TARGET&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_train</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;------------------------------------------------------------------------------------</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>

<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TESTING DATASET PREDICTORS&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">X_test</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;dataframe size&quot;</span><span class="p">,</span> <span class="n">X_test</span><span class="o">.</span><span class="n">shape</span><span class="p">,</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;------------------------------------------&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;TESTING DATASET TARGET&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="n">y_test</span><span class="o">.</span><span class="n">head</span><span class="p">())</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Vector size&quot;</span><span class="p">,</span> <span class="n">y_test</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>TRAINING DATASET PREDICTORS
          W        S     U       SUH       Q/W
256    6.91  0.01100  1.02  0.003366  0.277858
397   88.09  0.00210  1.99  0.008149  3.889545
586   14.02  0.02070  1.34  0.022190  1.078459
526  218.00  0.00041  0.52  0.000175  0.541284
9      8.00  0.02000  1.18  0.007316  0.370000 

dataframe size (726, 5) 

------------------------------------------
TRAINING DATASET TARGET
256      Plane Bed
397      Plane Bed
586      Step-pool
526       Sand bed
9      Riffle-pool
          ...     
89     Riffle-pool
337      Plane Bed
476      Plane Bed
123    Riffle-pool
876       Braiding
Name: Morphology, Length: 726, dtype: object 


------------------------------------------------------------------------------------

TESTING DATASET PREDICTORS
          W        S     U       SUH       Q/W
203    2.57  0.01040  1.58  0.008216  0.793774
937  105.00  0.00096  1.90  0.002918  3.076190
546   93.00  0.00050  1.10  0.001320  2.688172
214   53.04  0.00380  1.44  0.004596  1.211916
312    6.28  0.02020  0.34  0.001511  0.074841
dataframe size (312, 5) 

------------------------------------------
TESTING DATASET TARGET
203    Riffle-pool
937       Braiding
546       Sand bed
214    Riffle-pool
312      Plane Bed
Name: Morphology, dtype: object
Vector size (312,)
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="build-the-svm-model">
<h1>Build the SVM Model<a class="headerlink" href="#build-the-svm-model" title="Permalink to this headline">#</a></h1>
<section id="working-principle">
<h2>Working Principle<a class="headerlink" href="#working-principle" title="Permalink to this headline">#</a></h2>
<p>A Support Vector Machine (SVM) is a learning algorithm that searches for a so-called <strong>hyperplane</strong> that optimally separates feature classes. To find an optimal separation, the algorithm tries to maximize the distance (or margin) from the hyperplane to the nearest data points. The data points near to the limits of the margin are also denominated <strong>support vectors</strong> because they work as a reference to <em>draw</em> the hyperplane (see Fig. <a class="reference internal" href="#svm-margin-morphology"><span class="std std-numref">Fig. 259</span></a> below).</p>
<figure class="align-default" id="svm-margin-morphology">
<img alt="datascience" src="../_images/svm-margin.jpg" />
<figcaption>
<p><span class="caption-number">Fig. 259 </span><span class="caption-text">Illustration of a hyperplane and margins of an SVM. Source: Ricardo Barros</span><a class="headerlink" href="#svm-margin-morphology" title="Permalink to this image">#</a></p>
</figcaption>
</figure>
<p>For instance, assume that two of the above classes are linearly separable. We can define the regions that contain each class by means of the following hyperplane:</p>
<p><span class="math notranslate nohighlight">\( \vec{w}  \vec{X} + b &gt; 1 \)</span> –&gt; <strong>Class Red</strong>, and
<span class="math notranslate nohighlight">\( \vec{w}  \vec{X} + b &lt; 1 \)</span> –&gt; <strong>Class Blue</strong></p>
<p>where</p>
<ul class="simple">
<li><p><span class="math notranslate nohighlight">\(\vec{w}\)</span> is the vector of weights,</p></li>
<li><p><span class="math notranslate nohighlight">\(\vec{X}\)</span> is the matrix of features,</p></li>
<li><p><span class="math notranslate nohighlight">\(b\)</span> is the independent variable (also called <strong>bias</strong>), and</p></li>
<li><p>the value of <span class="math notranslate nohighlight">\(1\)</span> is chosen as a representative simplification, since <span class="math notranslate nohighlight">\(b\)</span> can basically be any value.</p></li>
</ul>
<p>Finally (after some steps that are not discussed here), we can compute an optimal hyperplane by minimizing the following expression:</p>
<p><span class="math notranslate nohighlight">\(min (0.5 \vec{w^t} \vec{w})\)</span></p>
<p>where <span class="math notranslate nohighlight">\(\vec{w^t}\)</span> is the <strong>transposed weight vector</strong>.</p>
<p>In the real world, however, it is common to find problems where classes are not linearly separable. In such situations, so-called <strong>kernels</strong> can be applied. A kernel is a function that transforms <span class="math notranslate nohighlight">\(\vec{X}\)</span> to a matrix with higher dimensions by combining the available features to create new features (i.e., new dimensions).</p>
<p>Here, we apply the <a class="reference external" href="https://towardsdatascience.com/radial-basis-function-rbf-kernel-the-go-to-kernel-acf0d22c798a">Radius Base Function (RBF)</a> kernel. The RBF is a popular kernel because it transforms the <span class="math notranslate nohighlight">\(\vec{X}\)</span> into an infinite dimension matrix without the risk of overfitting the model.</p>
<div class="hint admonition">
<p class="admonition-title">Get more detail…</p>
<ul class="simple">
<li><p>For more details on the <em>SVM</em>  calculation procedure, visit <a class="reference external" href="https://www.analyticsvidhya.com/blog/2021/10/support-vector-machinessvm-a-complete-guide-for-beginners/">analyticsvidhya.com</a>.</p></li>
<li><p>For a complete lecture on <em>SVM</em> (provided by the <a class="reference external" href="https://mit.edu">MIT</a>), visit their <a class="reference external" href="https://www.youtube.com/watch?v=eHsErlPJWUU">YouTube channel</a>.</p></li>
</ul>
</div>
</section>
<section id="k-fold-cross-validation">
<h2>k-fold Cross Validation<a class="headerlink" href="#k-fold-cross-validation" title="Permalink to this headline">#</a></h2>
<p>SVMs composed by an RBF kernel can be validated by tuning two parameters:</p>
<ol class="arabic simple">
<li><p><strong>C</strong>: determines how much are the margins are permissive. It differentiates between a <strong>hard margin</strong> (i.e., a margin that enables little or no penetration of data points) and a <strong>soft margin</strong> (i.e., a margin that enables penetration of data points inside the margin). A higher <strong>C</strong> corresponds to a harder the margin.</p></li>
<li><p><strong>gamma</strong>: determines the region of similarity among samples. It is the only variable of the RBF kernel. The higher gamma is, the broader is the influence of a labeled sample on classifying a new sample.</p></li>
</ol>
<p>Hard margins can also be interpreted as the <strong>sensitivity of the hyperplane</strong> when fitting it with the data. The harder the margin, the more the hyperplane twists to not allow any data point to penetrate the margin.</p>
<p>In this tutorial, we define <em>C</em> based on a try-and-error approach and a gamma stemming from a five-fold <a class="reference external" href="https://machinelearningmastery.com/k-fold-cross-validation/#:~:text=Cross%2Dvalidation%20is%20a%20resampling,k%2Dfold%20cross%2Dvalidation.">cross-validation</a>. The following code block builds the SVM using the <code class="docutils literal notranslate"><span class="pre">sklearn</span></code> library, and prints the validation and training error curves resulting from varying <em>gamma</em>.</p>
<div class="hint admonition">
<p class="admonition-title">Further reading</p>
<p>For a <em>C</em> and <em>gamma</em> search code example, have a look into the <a class="reference external" href="https://scikit-learn.org/stable/auto_examples/svm/plot_rbf_parameters.html#:~:text=Intuitively%2C%20the%20gamma%20parameter%20defines,the%20model%20as%20support%20vectors.">scikit-learn docs</a>.</p>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.svm</span> <span class="kn">import</span> <span class="n">SVC</span> 
<span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">validation_curve</span> 


<span class="c1"># define C, gamma range, kernel and number of cross-val. folds</span>
<span class="n">gamma_range</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logspace</span><span class="p">(</span><span class="o">-</span><span class="mi">5</span><span class="p">,</span> <span class="mi">3</span><span class="p">,</span> <span class="mi">13</span><span class="p">)</span> 
<span class="n">C</span><span class="o">=</span><span class="mi">500</span>  <span class="c1"># chosen hyperparameter through tunnig</span>
<span class="n">kernel</span> <span class="o">=</span> <span class="s2">&quot;rbf&quot;</span>  <span class="c1"># radius base function</span>
<span class="n">n_of_folds</span> <span class="o">=</span> <span class="mi">5</span>

<span class="c1"># Peform 5-fold cross-validation and save training and validation error</span>
<span class="n">train_scores</span><span class="p">,</span> <span class="n">test_scores</span> <span class="o">=</span> <span class="n">validation_curve</span><span class="p">(</span><span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="n">kernel</span><span class="p">,</span> 
                                                 <span class="n">C</span><span class="o">=</span><span class="n">C</span><span class="p">),</span>
                                             <span class="n">X_train</span><span class="p">,</span>
                                             <span class="n">y_train</span><span class="p">,</span>
                                             <span class="n">param_name</span><span class="o">=</span><span class="s2">&quot;gamma&quot;</span><span class="p">,</span>
                                             <span class="n">param_range</span><span class="o">=</span><span class="n">gamma_range</span><span class="p">,</span>
                                             <span class="n">scoring</span><span class="o">=</span><span class="s2">&quot;accuracy&quot;</span><span class="p">,</span>
                                             <span class="n">cv</span><span class="o">=</span><span class="n">n_of_folds</span>
                                            <span class="p">)</span>

<span class="c1"># convert accuracy into error</span>
<span class="n">train_error</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">train_scores</span>
<span class="n">validation_error</span> <span class="o">=</span> <span class="mi">1</span><span class="o">-</span><span class="n">test_scores</span>

<span class="c1"># compute 5-fold cross-validation mean and std of error </span>
<span class="n">train_error_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">train_error</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">train_error_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">train_error</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">validation_error_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">validation_error</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
<span class="n">validation_error_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">validation_error</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>

<span class="c1">#-------------------------------------------------------------------</span>

<span class="c1"># visualization of training and error validation</span>
<span class="n">plt</span><span class="o">.</span><span class="n">title</span><span class="p">(</span><span class="s2">&quot;Validation Curve with SVM&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="sa">r</span><span class="s2">&quot;$\gamma$&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="s2">&quot;Error (1-accuracy)&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">ylim</span><span class="p">(</span><span class="o">-</span><span class="mf">0.01</span><span class="p">,</span> <span class="mf">1.1</span><span class="p">)</span>
<span class="n">lw</span> <span class="o">=</span> <span class="mi">2</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span>
    <span class="n">param_range</span><span class="p">,</span> <span class="n">train_error_mean</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Training error&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkorange&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
    <span class="n">param_range</span><span class="p">,</span>
    <span class="n">train_error_mean</span> <span class="o">-</span> <span class="n">train_error_std</span><span class="p">,</span>
    <span class="n">train_error_mean</span> <span class="o">+</span> <span class="n">train_error_std</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;darkorange&quot;</span><span class="p">,</span>
    <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">semilogx</span><span class="p">(</span>
    <span class="n">param_range</span><span class="p">,</span> <span class="n">validation_error_mean</span><span class="p">,</span> <span class="n">label</span><span class="o">=</span><span class="s2">&quot;Cross-validation error&quot;</span><span class="p">,</span> <span class="n">color</span><span class="o">=</span><span class="s2">&quot;navy&quot;</span><span class="p">,</span> <span class="n">lw</span><span class="o">=</span><span class="n">lw</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">fill_between</span><span class="p">(</span>
    <span class="n">param_range</span><span class="p">,</span>
    <span class="n">validation_error_mean</span> <span class="o">-</span> <span class="n">validation_error_std</span><span class="p">,</span>
    <span class="n">validation_error_mean</span> <span class="o">+</span> <span class="n">validation_error_std</span><span class="p">,</span>
    <span class="n">alpha</span><span class="o">=</span><span class="mf">0.2</span><span class="p">,</span>
    <span class="n">color</span><span class="o">=</span><span class="s2">&quot;navy&quot;</span><span class="p">,</span>
    <span class="n">lw</span><span class="o">=</span><span class="n">lw</span><span class="p">,</span>
<span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">legend</span><span class="p">(</span><span class="n">loc</span><span class="o">=</span><span class="s2">&quot;best&quot;</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/70c862097cbb771a7fa020240c6208da43fe68fb2bbf941c2259da4525658ede.png" src="../_images/70c862097cbb771a7fa020240c6208da43fe68fb2bbf941c2259da4525658ede.png" />
</div>
</div>
</section>
<section id="select-optimum-parameters">
<h2>Select Optimum Parameters<a class="headerlink" href="#select-optimum-parameters" title="Permalink to this headline">#</a></h2>
<p>The decision on optimum parameters for the SVM depends on your opinion. For the purpose of selecting optimum parameters in this tutorial, the below code block quantifies the above-shown plot (in particular, the blue curve) in tabular form and saves the gamma that yields the smallest error (<strong>gamma_opt</strong>).</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># save optimal gamma</span>
<span class="n">index_min</span> <span class="o">=</span> <span class="nb">min</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">validation_error_mean</span><span class="p">)),</span> <span class="n">key</span><span class="o">=</span><span class="n">validation_error_mean</span><span class="o">.</span><span class="fm">__getitem__</span><span class="p">)</span>
<span class="n">validation_error_min</span> <span class="o">=</span> <span class="n">validation_error_mean</span><span class="p">[</span><span class="n">index_min</span><span class="p">]</span>
<span class="n">gamma_opt</span> <span class="o">=</span> <span class="n">param_range</span><span class="p">[</span><span class="n">index_min</span><span class="p">]</span>  <span class="c1"># gamma that gives minimun validation error</span>

<span class="c1"># visualize error evolution with gamma </span>
<span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;Mean validation error&quot;</span><span class="p">,</span><span class="s2">&quot;gamma&quot;</span><span class="p">]</span>
<span class="n">array</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">array</span><span class="p">([</span><span class="n">validation_error_mean</span><span class="p">,</span> <span class="n">param_range</span><span class="p">])</span><span class="o">.</span><span class="n">transpose</span><span class="p">()</span>

<span class="nb">print</span><span class="p">(</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">array</span><span class="p">,</span><span class="n">columns</span><span class="o">=</span><span class="n">columns</span><span class="p">),</span> <span class="s2">&quot;</span><span class="se">\n</span><span class="s2">&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Minimun mean validation error:&quot;</span><span class="p">,</span> <span class="n">validation_error_min</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;optimal gamma:&quot;</span><span class="p">,</span> <span class="n">gamma_opt</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>    Mean validation error        gamma
0                0.575739     0.000010
1                0.524856     0.000046
2                0.471101     0.000215
3                0.446311     0.001000
4                0.388474     0.004642
5                0.341606     0.021544
6                0.294709     0.100000
7                0.254861     0.464159
8                0.318262     2.154435
9                0.391252    10.000000
10               0.409173    46.415888
11               0.515144   215.443469
12               0.637789  1000.000000 

Minimun mean validation error: 0.2548606518658479
optimal gamma: 0.46415888336127725
</pre></div>
</div>
</div>
</div>
</section>
<section id="train-optimum-hypothesis-svm-model">
<h2>Train Optimum Hypothesis SVM Model<a class="headerlink" href="#train-optimum-hypothesis-svm-model" title="Permalink to this headline">#</a></h2>
<p>After defining a gamma yielding the smallest validation error (<strong>gamma_opt</strong>), we can train an optimal hypothesis (<strong>h_opt</strong>) model on the entire training dataset. In addition, we can evaluate the accuracy of the model by using it to classify the testing dataset. The below code block features the training procedure, fitting of the SVM (i.e., an optimum hypothesis), and prints the score of the optimum hypothesis.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># train optimal model and evaluate accuracy </span>
<span class="n">h_opt</span> <span class="o">=</span> <span class="n">SVC</span><span class="p">(</span><span class="n">kernel</span><span class="o">=</span><span class="n">kernel</span><span class="p">,</span>
            <span class="n">gamma</span><span class="o">=</span><span class="n">gamma_opt</span><span class="p">,</span>
            <span class="n">C</span><span class="o">=</span><span class="n">C</span><span class="p">)</span> <span class="c1"># instantiate optimal model </span>
<span class="n">h_opt</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">X_train</span><span class="p">,</span><span class="n">y_train</span><span class="p">)</span> <span class="c1"># train the model with entire training set</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;Error (1-Accuracy) of h_opt on testing data: </span><span class="se">\n</span><span class="s2"> --&gt;&gt;&quot;</span><span class="p">,</span><span class="mi">1</span><span class="o">-</span> <span class="n">h_opt</span><span class="o">.</span><span class="n">score</span><span class="p">(</span><span class="n">X_test</span><span class="p">,</span><span class="n">y_test</span><span class="p">))</span> 
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Error (1-Accuracy) of h_opt on testing data: 
 --&gt;&gt; 0.19551282051282048
</pre></div>
</div>
</div>
</div>
</section>
<section id="performance-evaluation-confusion-matrix">
<h2>Performance Evaluation (Confusion Matrix)<a class="headerlink" href="#performance-evaluation-confusion-matrix" title="Permalink to this headline">#</a></h2>
<p>Finally, the following code block generates the so-called <strong>confusion matrix</strong> to evaluate the optimum hypothesis model performance when classifying the samples with distinct morphologies. The confusion matrix uses the total number of samples and visualizes their true and predicted morphological units.</p>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">from</span> <span class="nn">sklearn.metrics</span> <span class="kn">import</span> <span class="n">plot_confusion_matrix</span> 

<span class="c1">#plot confusion matrix</span>
<span class="n">plot_confusion_matrix</span><span class="p">(</span><span class="n">h_opt</span><span class="p">,</span> <span class="c1"># trained optimal hypothesis model</span>
                      <span class="n">X_test</span><span class="p">,</span> 
                      <span class="n">y_test</span><span class="p">,</span>
                     <span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">xticks</span><span class="p">(</span><span class="n">rotation</span><span class="o">=</span><span class="mi">45</span><span class="p">)</span>
<span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<img alt="../_images/435c6bdeac3b6198b66aac77a67f8de93e770bd80c0e94450f469d6ece2e4ac7.png" src="../_images/435c6bdeac3b6198b66aac77a67f8de93e770bd80c0e94450f469d6ece2e4ac7.png" />
</div>
</div>
<p>The confusion matrix of an exact model only has diagonal entries larger than zero, while all others are zero. Thus, the above-shown confusion matrix shows that our SVM model performs very well in predicting step-pool and riffle-pool morphologies, but unreliably predicts sand bed morphologies because of not many observations. However, the model also made wrong predictions of step-pool and riffle pool features. For instance, according to the confusion matrix, the model predicted 6 times step-pool, where in reality (true label), plane bed morphological units prevailed, and it wrongly predicted one braiding observation to be a step-pool observation. The sand bed predictions are unreliable because there are only 25 true-label sand bed observations (opposed to 66 step-pool observations). Thus, the sand bed observations are unbalanced and a solution to removing the unreliability could be to sample more sand bed morphological units (as above explained).</p>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "hydro-informatics/jupyter-python-course",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./datascience"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
                <footer class="bd-footer-article">
                  
<div class="footer-article-items footer-article__inner">
  
    <div class="footer-article-item"><!-- Previous / next buttons -->
<div class="prev-next-area">
    <a class="left-prev"
       href="kernelized-supervised-models.html"
       title="previous page">
      <i class="fa-solid fa-angle-left"></i>
      <div class="prev-next-info">
        <p class="prev-next-subtitle">previous</p>
        <p class="prev-next-title">Kernels</p>
      </div>
    </a>
    <a class="right-next"
       href="three-based-methods.html"
       title="next page">
      <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Three-based methods (Coming soon)</p>
      </div>
      <i class="fa-solid fa-angle-right"></i>
    </a>
</div></div>
  
</div>

                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">

  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contents
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Support Vector Machine (SVM)</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#theory">Theory</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#pre-processing">Pre-processing</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#load-data">Load Data</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#clean-the-dataset">Clean the Dataset</a><ul class="nav section-nav flex-column">
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#remove-nan-values">Remove NaN Values</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#search-outliers">Search Outliers</a></li>
<li class="toc-h3 nav-item toc-entry"><a class="reference internal nav-link" href="#remove-outliers">Remove Outliers</a></li>
</ul>
</li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-class-proportions">Verify Class Proportions</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#derive-new-predictors">Derive New Predictors</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#verify-multicolinearity">Verify Multicolinearity</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#variance-inflation-factor-vif">Variance Inflation Factor (VIF)</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#remove-features-to-reduce-vif">Remove Features to Reduce VIF</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#split-test-and-training-datasets">Split Test and Training Datasets</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#build-the-svm-model">Build the SVM Model</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#working-principle">Working Principle</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#k-fold-cross-validation">k-fold Cross Validation</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#select-optimum-parameters">Select Optimum Parameters</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#train-optimum-hypothesis-svm-model">Train Optimum Hypothesis SVM Model</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#performance-evaluation-confusion-matrix">Performance Evaluation (Confusion Matrix)</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
By Sebastian Schwindt, Beatriz Negreiros, Federica Scolari, Ricardo Barros
</p>

  </div>
  
  <div class="footer-item">
    
  <p class="copyright">
    
      © Copyright 2024.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../_static/scripts/bootstrap.js?digest=e353d410970836974a52"></script>
<script src="../_static/scripts/pydata-sphinx-theme.js?digest=e353d410970836974a52"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>
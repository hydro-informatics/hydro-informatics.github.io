
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pre-Processing with QGIS &#8212; Hydro-Informatics</title>
    
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/tabs.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://hydro-informatics.github.io/numerics/pre-qgis.html" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="BASEMENT" href="basement.html" />
    <link rel="prev" title="Principles" href="numerical-modeling.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />


<!-- Opengraph tags -->
<meta property="og:url"         content="https://hydro-informatics.github.io/numerics/pre-qgis.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="Pre-Processing with QGIS" />
<meta property="og:description" content="Pre-Processing with QGIS    Pre-processing with QGIS  To start any analysis of rivers and fluvial landscapes, a digital elevation model (DEM) is required. Nowad" />
<meta property="og:image"       content="https://hydro-informatics.github.io/_static/icon.jpg" />

<meta name="twitter:card" content="summary" />


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/icon.jpg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Hydro-Informatics</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <p class="caption collapsible-parent">
 <span class="caption-text">
  Get Started
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../lectures/classroom.html">
   The Virtual Classroom
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/lectures.html">
     Lectures and exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/take_seat.html">
     Take a Seat in the Virtual Classroom
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../get-started/software.html">
   Software Resources
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/vm.html">
     Virtual Machines and Linux
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/vm.html#get-started-with-debian-linux">
     Get started with (Debian) Linux
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/ide.html">
     Anaconda and Integrated Development Environments (IDEs)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/git.html">
     Introduction to git
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/geo.html">
     Geospatial Software
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/install-openfoam.html">
     Install OpenFOAM
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/install-telemac.html">
     open TELEMAC (Installation)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/others.html">
     Other Software Resources
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Python Basics
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../python-basics/python.html">
   Get Started with Python
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../python-basics/pyinstall.html">
     Install Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pybase.html">
     First steps
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pyerror.html">
     Errors, Logging, and Debugging
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pyloop.html">
     Loops and Conditional Statements
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../python-basics/modularize.html">
   Modularization &amp; Object Orientation
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pyfun.html">
     Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pypckg.html">
     Packages, Modules and Libraries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/classes.html">
     Object Orientation and Classes
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../python-basics/data-handling.html">
   Data and File Handling
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pynum.html">
     Load and Write Basic Data Files
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pynum.html#numpy">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pynum.html#pandas">
     Pandas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pynum.html#dates-and-time">
     Dates and Time
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/xml.html">
     Manipulation of Workbooks and JSON Files
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pyplot.html">
     Plotting
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../jupyter/pystyle.html">
   Code Style and Conventions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../jupyter/gui.html">
   Graphical User Interfaces (GUIs)
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../exercises/python-exercises.html">
   Python Exercises
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-ms.html">
     1d Hydraulics (Manning-Strickler Formula)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-sp.html">
     Reservoir Volume Calculation with a Sequent Peak Algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-floods.html">
     Calculate flood return periods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-sediment.html">
     Cross-section Averaged Sediment Transport
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-gui.html">
     Create a
     <strong>
      G
     </strong>
     raphical
     <strong>
      U
     </strong>
     ser
     <strong>
      I
     </strong>
     nterface (GUI)
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Documentation
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../documentation/documentation.html">
   Markdown and Code Documentation
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../exercises/docs-exercises.html">
   Exercises
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-git.html">
     Git and markdown
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Geospatial Analysis
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../geopy/geospatial-data.html">
   Geospatial Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../geopy/use-qgis.html">
   QGIS tutorial
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../geopy/geo-python.html">
   Geospatial Python
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../geopy/geo-pckg.html">
     Geospatial Python - Open Source Packages
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/geo-shp.html">
     Shapefile (vector dataset) handling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/geo-raster.html">
     Raster (Gridded) Dataset Handling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/geo-convert.html">
     Raster to Vector Conversion and Vice Versa
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/geo-arcpy.html">
     The Commercial arcpy Library
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../exercises/geo-exercises.html">
   Exercises
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-geco.html">
     Create a habitat suitability map
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Numerical Modeling
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="numerical-modeling.html">
   Principles
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Pre-Processing with QGIS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="basement.html">
   BASEMENT
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="telemac.html">
   TELEMAC
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="telemac2d.html">
     Pre-Processing for TELEMAC models
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="telemac3d.html">
     3d modeling with TELEMAC
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="telemac-gaia.html">
     Gaia Workflow
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="openfoam.html">
   OpenFOAM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="calibration.html">
   Calibration and Valdiation
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Troubleshoot
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../troubleshoot/dbg-programming.html">
   Programming Tools and IDEs
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-anaconda.html">
     Debugging Anaconda
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-python.html">
     Debugging Python Code
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-jupyter.html">
     Debugging Jupyter
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../troubleshoot/dbg-numerical-models.html">
   Numerical Models
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-basement.html">
     Debugging BASEMENT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-telemac.html">
     Debugging TELEMAC/SALOME
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../troubleshoot/dbg-os.html">
   Operating Systems (Linux and VMs)
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-linux.html">
     Debugging Debian Linux
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-vm.html">
     Debugging Virtual Machines
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Disclaimer and License
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../terms/license.html">
   License
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../terms/disclaimer.html">
   Disclaimer
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Written by <a href="https://sebastian-schwindt.org">Sebastian Schwindt</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/numerics/pre-qgis.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/hydro-informatics/"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#qgis-prepro">
   Pre-processing with
   <em>
    QGIS
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#get-ready-with-qgis">
   Get ready with
   <em>
    QGIS
   </em>
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#elevation-point-data">
   Elevation point data
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#model-boundary">
   Model Boundary
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#breaklines">
   Breaklines
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#tin-elevation-model">
   TIN Elevation Model
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#region-markers-for-quality-meshing">
   Region Markers for Quality Meshing
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#quality-meshing">
   Quality meshing
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#quality-mesh-generation">
     Quality mesh generation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#elevation-data-interpolation-on-a-quality-mesh-a-name-qualm-interp-a">
     Elevation data interpolation on a quality mesh
     <a name="qualm-interp">
     </a>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#verify-quality-mesh-elevation">
     Verify quality mesh elevation
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#export-to-2dm">
   Export to 2dm
  </a>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="pre-processing-with-qgis">
<h1>Pre-Processing with QGIS<a class="headerlink" href="#pre-processing-with-qgis" title="Permalink to this headline">¶</a></h1>
<div class="section" id="qgis-prepro">
<span id="id1"></span><h2>Pre-processing with <em>QGIS</em><a class="headerlink" href="#qgis-prepro" title="Permalink to this headline">¶</a></h2>
<p>To start any analysis of rivers and fluvial landscapes, a digital elevation model (<strong>DEM</strong>) is required. Nowadays, DEMs mostly are a result of light imaging, detection, and ranging (<a class="reference external" href="https://en.wikipedia.org/wiki/Lidar">LiDAR</a> and bathymetric surveys. LiDAR employs lights sources and provides terrain assessments up to 2-m deep water. Deeper water requires additional bathymetric surveys with <a class="reference external" href="https://en.wikipedia.org/wiki/Echo_sounding">echo sounding</a> methods.
Merging LiDAR and bathymetric data produces point clouds that may be stored in many different file types. The first step in river modelling consist in the conversion of such point clouds into usable DEMs and computational meshes. This page guides through the conversion of a point cloud into a computational mesh with <em>QGIS</em> and the <em>BASEmesh</em> plugin. The descriptions refer to the developer’s documentation files (<a class="reference external" href="https://basement.ethz.ch/download/documentation/docu3.html">go to the ETH Zurich’s <em>BASEMENT</em> documentation</a>).</p>
</div>
<div class="section" id="get-ready-with-qgis">
<span id="start-qgis"></span><h2>Get ready with <em>QGIS</em><a class="headerlink" href="#get-ready-with-qgis" title="Permalink to this headline">¶</a></h2>
<div class="admonition-windows admonition">
<p class="admonition-title">Windows</p>
<p>Download and install the latest version of the open-access GIS software <a class="reference external" href="https://www.qgis.org"><em>QGIS</em></a>.</p>
</div>
<div class="admonition-linux admonition">
<p class="admonition-title">Linux</p>
<p>(1) Make sure to <a class="reference external" href="https://flathub.org/apps/details/org.qgis.qgis"><strong>install QGIS v3.16 via <em>Flatpak</em></strong></a> or the <em>Linux</em> <em>Software Manager</em> (open <em>Software Manager</em>, search for <em>QGIS</em> and install the <em>QGIS Flatpak</em>). If <em>Software Manager</em> cannot find <em>QGIS</em>, make sure that <em>Flatpak</em> is added as repository (find the good repository for your Unix-based operating system (OS) <a class="reference external" href="https://flatpak.org/setup/">here</a>).<br><br>
(2) The <strong><em>QGIS Flatpak</em> installation will</strong> most likely <strong>not include <em>scipy</em></strong>. In order to <strong>fix</strong> this issue, <strong>open  <em>Terminal</em></strong> (standard application on Unix-based OS) and type:
<br><br><strong><code class="docutils literal notranslate"><span class="pre">flatpak</span> <span class="pre">run</span> <span class="pre">--command=pip3</span> <span class="pre">org.qgis.qgis</span> <span class="pre">install</span> <span class="pre">scipy</span> <span class="pre">--user</span></code></strong><br><br>
This solution has been tested on <strong><em>Linux Ubuntu</em> and <em>Linux Mint</em>. It potentially also works with <em>Red Hat</em>, <em>openSUSE</em>, <em>Mac OS</em>, <em>Arch</em>, <em>Fedora</em>, <em>Android</em>, <em>Debian</em>, <em>Kubuntu</em></strong> and <a class="reference external" href="https://flatpak.org/setup/">many more</a>. Read more about the <em>QGIS Flatpak</em> installation on the <a class="reference external" href="https://qgis.org/en/site/forusers/alldownloads.html#flatpak"><em>QGIS web site</em></a>.</p>
</div>
<p>Start <em>QGIS</em>, create a new project and save it (<code class="docutils literal notranslate"><span class="pre">Project</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">as...</span></code>). Then, set the project coordinate reference system (CRS) by clicking on <code class="docutils literal notranslate"><span class="pre">Project</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">Properties</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">CRS</span></code> tab and select <code class="docutils literal notranslate"><span class="pre">GERMANY_ZONE_3</span> <span class="pre">(ESRI:31493)</span></code>. Install <em>BASEMENT</em>’s <em>BASEmesh</em> Plugin (instructions from the <em>BASEMENT</em> System Manual):</p>
<ol class="simple">
<li><p>Load the <em>QGIS</em> plugin manager: <code class="docutils literal notranslate"><span class="pre">Plugins</span></code> menu &gt; <code class="docutils literal notranslate"><span class="pre">Manage</span> <span class="pre">and</span> <span class="pre">Install</span> <span class="pre">Plugins</span></code> (see details in <a class="reference internal" href="#qgis-plugins"><span class="std std-numref">Fig. 16</span></a></p></li>
<li><p>Go to the Settings tab; now the <em>QGIS</em> plugin repository connections should be visible at the bottom of the <code class="docutils literal notranslate"><span class="pre">Plugin</span> <span class="pre">Manager</span></code> (<code class="docutils literal notranslate"><span class="pre">Plugin</span> <span class="pre">Repositories</span></code> listbox in <a class="reference internal" href="#qgis-plugins"><span class="std std-numref">Fig. 16</span></a>).</p></li>
<li><p>Scroll to the bottom, click on Add…, and enter a name for the new repository (e.g., <em>BASEmesh</em> repository)</p></li>
<li><p>Enter the repository address: <a class="reference external" href="http://people.ee.ethz.ch/~basement/qgis_plugins/qgis_plugins.xml">http://people.ee.ethz.ch/~basement/qgis_plugins/qgis_plugins.xml</a></p></li>
<li><p>Click <code class="docutils literal notranslate"><span class="pre">OK</span></code>. The new repository should now be visible in the <code class="docutils literal notranslate"><span class="pre">Plugin</span> <span class="pre">Repositories</span></code> listbox. If the connection is <code class="docutils literal notranslate"><span class="pre">OK</span></code>, click on the Close button on the bottom of the window.</p></li>
<li><p>Verify that the <em>BASEmesh</em> plugin is now available in the <em>QGIS</em>’ <code class="docutils literal notranslate"><span class="pre">Plugins</span></code> menu (see <a class="reference internal" href="#qgis-pluggedin"><span class="std std-numref">Fig. 17</span></a>).</p></li>
</ol>
<div class="figure align-default" id="qgis-plugins">
<img alt="qgis basement plugins" src="../_images/qgis-plugins.png" />
<p class="caption"><span class="caption-number">Fig. 16 </span><span class="caption-text">Installation of the BASEmesh plugin.</span><a class="headerlink" href="#qgis-plugins" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="qgis-pluggedin">
<img alt="qgis basement plugins" src="../_images/qgis-pluggedin.png" />
<p class="caption"><span class="caption-number">Fig. 17 </span><span class="caption-text">The BASEmesh plugin is available in QGIS’ Plugins menu after successful installation.</span><a class="headerlink" href="#qgis-pluggedin" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="elevation-point-data">
<span id="epd"></span><h2>Elevation point data<a class="headerlink" href="#elevation-point-data" title="Permalink to this headline">¶</a></h2>
<p>Terrain survey data are mostly delivered in the shape of an x-y-z point dataset. LiDAR produces massive point clouds, which quickly overcharge even powerful computers. Therefore, LiDAR data may need to be break down to smaller zones of less than approximately 106 points and special LiDAR point processing software (e.g., <a class="reference external" href="http://lastools.org/">http://lastools.org/</a>) may be helpful in this task. The range of possible data products and shape from terrain survey is board and this tutorial exemplary uses a set of x-y-z points stored within a text file. Load the points from the provided xyz-points.txt file as follows:</p>
<ol class="simple">
<li><p><a class="reference external" href="https://github.com/hydro-informatics/materials-bm/blob/master/points_raw/points.txt">Download</a> the point file from the repository (if necessary, copy the file contents locally into a text editor and save the file as <code class="docutils literal notranslate"><span class="pre">points.txt</span></code> in a local project directory)</p></li>
<li><p><a class="reference external" href="https://github.com/hydro-informatics/materials-bm/raw/master/breaklines.zip">Download</a> the zipped breaklines shapefile into the project folder and unpack <code class="docutils literal notranslate"><span class="pre">breaklines.shp</span></code>.</p></li>
<li><p>In <em>QGIS</em>, click on the <code class="docutils literal notranslate"><span class="pre">Layer</span></code> menu &gt; <code class="docutils literal notranslate"><span class="pre">Add</span> <span class="pre">Layer</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">Add</span> <span class="pre">Delimited</span> <span class="pre">Text</span> <span class="pre">Layer...</span></code> (see <a class="reference internal" href="#qgis-add-lyr"><span class="std std-numref">Fig. 18</span></a>)</p></li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">Add</span> <span class="pre">Delimited</span> <span class="pre">Text</span> <span class="pre">Layer</span></code> (<code class="docutils literal notranslate"><span class="pre">Data</span> <span class="pre">Source</span> <span class="pre">Manager</span> <span class="pre">|</span> <span class="pre">Delimited</span> <span class="pre">Text</span></code>) wizard (see details in Figure 4):</p>
<ul class="simple">
<li><p>Choose <a class="reference external" href="https://github.com/hydro-informatics/materials-bm/blob/master/points_raw/points.txt"><em>points.txt</em></a> in the <code class="docutils literal notranslate"><span class="pre">File</span> <span class="pre">name</span></code> field (alternatively use <a class="reference external" href="https://github.com/hydro-informatics/materials-bm/blob/master/points_raw/points.csv"><em>points.csv</em></a></p></li>
<li><p>Name the new layer (e.g., points)</p></li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">File</span> <span class="pre">Format</span></code> canvas, select <code class="docutils literal notranslate"><span class="pre">Custom</span> <span class="pre">Delimiters</span></code> and activate the <code class="docutils literal notranslate"><span class="pre">Space</span></code> checkbox</p></li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">Record</span> <span class="pre">and</span> <span class="pre">Field</span> <span class="pre">Options</span></code> canvas, activate the <code class="docutils literal notranslate"><span class="pre">First</span> <span class="pre">record</span> <span class="pre">has</span> <span class="pre">field</span> <span class="pre">names</span></code> checkbox</p></li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">Geometry</span> <span class="pre">Definition</span></code> canvas, define the <code class="docutils literal notranslate"><span class="pre">Point</span> <span class="pre">Coordinates</span></code> as <code class="docutils literal notranslate"><span class="pre">X</span> <span class="pre">Field</span></code> = <code class="docutils literal notranslate"><span class="pre">X</span></code>, <code class="docutils literal notranslate"><span class="pre">Y</span> <span class="pre">Field</span></code> = <code class="docutils literal notranslate"><span class="pre">Y</span></code> and <code class="docutils literal notranslate"><span class="pre">Z</span> <span class="pre">Field</span></code> = <code class="docutils literal notranslate"><span class="pre">Z</span></code>; set the <code class="docutils literal notranslate"><span class="pre">Geometry</span> <span class="pre">CRS</span></code> to the <code class="docutils literal notranslate"><span class="pre">Project</span> <span class="pre">CRS</span></code>.</p></li>
<li><p>Click the <code class="docutils literal notranslate"><span class="pre">Add</span></code> button on the bottom of the wizard window. The points should now be plotted in the main <em>QGIS</em> window.</p></li>
</ul>
</li>
</ol>
<div class="figure align-default" id="qgis-add-lyr">
<img alt="basement qhis add layer" src="../_images/qgis-add-lyr.png" />
<p class="caption"><span class="caption-number">Fig. 18 </span><span class="caption-text">Open the Add Delimited Text Layer import wizard.</span><a class="headerlink" href="#qgis-add-lyr" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="qgis-import-pts">
<img alt="basement qgis import points" src="../_images/qgis-import-pts.png" />
<p class="caption"><span class="caption-number">Fig. 19 </span><span class="caption-text">Load the xyz-points.txt file with QGIS’ Add Delimited Text Layer (Data Source Manager | Delimited Text) wizard.</span><a class="headerlink" href="#qgis-import-pts" title="Permalink to this image">¶</a></p>
</div>
<p>Next, export the new point layer as shapefile: In <em>QGIS</em>’ <code class="docutils literal notranslate"><span class="pre">Layer</span></code>S window, right-click on XYZ-POINTS, then <code class="docutils literal notranslate"><span class="pre">Export</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">Features</span> <span class="pre">As...</span></code> . In the Format field, select <code class="docutils literal notranslate"><span class="pre">ESRI</span> <span class="pre">Shapefile</span></code>. Define a FILE NAME (by clicking on the … button and defining for example <em>C:\QGIS-projects\xyz-points.shp</em>), ensure that the ADD SAVED FILE TO MAP checkbox is activated (on the bottom of the <code class="docutils literal notranslate"><span class="pre">Save</span> <span class="pre">Vector</span> <span class="pre">Layer</span> <span class="pre">As...</span></code> window) and click <code class="docutils literal notranslate"><span class="pre">OK</span></code>. Remove the <code class="docutils literal notranslate"><span class="pre">points</span></code> text layer from the <code class="docutils literal notranslate"><span class="pre">Layers</span></code> window (only the shape file should be visible here now).
Finally, rename the three fields (<code class="docutils literal notranslate"><span class="pre">FIELD_1</span></code>, <code class="docutils literal notranslate"><span class="pre">FIELD_2</span></code>, <code class="docutils literal notranslate"><span class="pre">FIELD_3</span></code>) to <code class="docutils literal notranslate"><span class="pre">X</span></code>, <code class="docutils literal notranslate"><span class="pre">Y</span></code>, and <code class="docutils literal notranslate"><span class="pre">Z</span></code>, respectively. The fields can be renamed with a double-click on the <code class="docutils literal notranslate"><span class="pre">xyz-points</span></code> layer (opens <code class="docutils literal notranslate"><span class="pre">Layer</span> <span class="pre">Properties</span></code>), then left-click on the <code class="docutils literal notranslate"><span class="pre">Fields</span></code> ribbon, activate the editing mode (click on the pen symbol) and edit the <code class="docutils literal notranslate"><span class="pre">Name</span></code> fields.</p>
</div>
<div class="section" id="model-boundary">
<span id="boundary"></span><h2>Model Boundary<a class="headerlink" href="#model-boundary" title="Permalink to this headline">¶</a></h2>
<p>The model boundary defines the calculation extent and needs to be define within a polygon shapefile that encloses all points in the above produced point shapefile. <em>QGIS</em> provides a Convex Hull tool that enables the automated creation of the outer boundary. This tool is used as follows:</p>
<ul class="simple">
<li><p>In <em>QGIS</em>’ <code class="docutils literal notranslate"><span class="pre">Processing</span></code> menu, select <code class="docutils literal notranslate"><span class="pre">Toolbox</span></code> (see <a class="reference internal" href="#qgis-tbx-fig"><span class="std std-numref">Fig. 20</span></a>) The <code class="docutils literal notranslate"><span class="pre">Toolbox</span></code> sub-window opens now.</p></li>
<li><p>In the toolbox, click on <code class="docutils literal notranslate"><span class="pre">Vector</span> <span class="pre">Geometry</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">Concave</span> <span class="pre">Hull</span> <span class="pre">(Alpha</span> <span class="pre">Shapes)</span></code>, which opens the <code class="docutils literal notranslate"><span class="pre">Concave</span> <span class="pre">Hull</span> <span class="pre">(Alpha</span> <span class="pre">Shapes)</span></code> wizard (see <a class="reference internal" href="#qgis-chull"><span class="std std-numref">Fig. 21</span></a>).</p></li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">Concave</span> <span class="pre">Hull</span> <span class="pre">(Alpha</span> <span class="pre">Shapes)</span></code> wizard, select the <code class="docutils literal notranslate"><span class="pre">xyz-points</span></code> layer as <code class="docutils literal notranslate"><span class="pre">Input</span> <span class="pre">Layer</span></code>, set the <code class="docutils literal notranslate"><span class="pre">Threhold</span></code> to 0.300 (keep default), define an output <code class="docutils literal notranslate"><span class="pre">Concave</span> <span class="pre">Hull</span></code> shapefile (e.g., <code class="docutils literal notranslate"><span class="pre">boundary.shp</span></code>) by clicking on the <code class="docutils literal notranslate"><span class="pre">...</span></code> button, and click on <code class="docutils literal notranslate"><span class="pre">Run</span></code>.</p></li>
</ul>
<div class="figure align-default" id="qgis-tbx-fig">
<img alt="qgis basement toolbox" src="../_images/qgis-tbx.png" />
<p class="caption"><span class="caption-number">Fig. 20 </span><span class="caption-text">Open QGIS’ Toolbox from the main menu.</span><a class="headerlink" href="#qgis-tbx-fig" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="qgis-chull">
<img alt="basement qgis convex hull boundary polygon" src="../_images/qgis-chull.png" />
<p class="caption"><span class="caption-number">Fig. 21 </span><span class="caption-text">The Concave Hull (Alpha Shapes) wizard.</span><a class="headerlink" href="#qgis-chull" title="Permalink to this image">¶</a></p>
</div>
<ul class="simple">
<li><p>Right-click on <em>QGIS</em>’ <code class="docutils literal notranslate"><span class="pre">Settings</span></code> menu, and activate the <code class="docutils literal notranslate"><span class="pre">Snapping</span></code> toolbar checkbox. In the now shown snapping toolbar, activate snapping with a click on the horseshoe icon.</p></li>
<li><p>Adapt the boundary.shp polygon to a tighter fit of the shapefile nodes by clicking on the <code class="docutils literal notranslate"><span class="pre">Toggle</span> <span class="pre">editing</span></code> (pen) symbol and activating the <code class="docutils literal notranslate"><span class="pre">Vertex</span> <span class="pre">Tool</span></code> in the toolbar.</p></li>
</ul>
<div class="figure align-default" id="qgis-mod-feat">
<img alt="basement qgis modify feature vertex" src="../_images/qgis-mod-feat.png" />
<p class="caption"><span class="caption-number">Fig. 22 </span><span class="caption-text">Toggle editing and enable the Vertex Tool.</span><a class="headerlink" href="#qgis-mod-feat" title="Permalink to this image">¶</a></p>
</div>
<ul class="simple">
<li><p>Modify the boundary edges (as shown in <a class="reference internal" href="#qgis-mod-boundary"><span class="std std-numref">Fig. 23</span></a>): click on the centre cross (creates a new point) and dragging it to the next outest boundary point of the DEM points. Note:</p>
<ul>
<li><p>The boundary polygon must not be a perfect fit, but it must include all xyz-points with many details in vicinity of the river inflow and outflow regions (dense point cloud in the left part of the point file).</p></li>
<li><p>The more precise the boundary the better will be the quality mesh and the faster and more stable will be the simulation.</p></li>
<li><p>Regularly save edits by clicking on SAVE <code class="docutils literal notranslate"><span class="pre">Layer</span></code> (floppy disk symbol next to the editing pen symbol)</p></li>
</ul>
</li>
</ul>
<div class="figure align-default" id="qgis-mod-boundary">
<img alt="basement qgis modify boundary polygon" src="../_images/qgis-mod-boundary.png" />
<p class="caption"><span class="caption-number">Fig. 23 </span><span class="caption-text">Modify the boundary polygon with a click on the centre cross (creates a new point) and dragging it to the next outest boundary point of the DEM points.</span><a class="headerlink" href="#qgis-mod-boundary" title="Permalink to this image">¶</a></p>
</div>
<div class="figure align-default" id="qgis-fin-boundary">
<img alt="basement qgis boundary polygon" src="../_images/qgis-fin-boundary.png" />
<p class="caption"><span class="caption-number">Fig. 24 </span><span class="caption-text">The final boundary (hull of the point cloud).</span><a class="headerlink" href="#qgis-fin-boundary" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="breaklines">
<span id="id2"></span><h2>Breaklines<a class="headerlink" href="#breaklines" title="Permalink to this headline">¶</a></h2>
<p>Breaklines indicate, for instance, channel banks and the riverbed, and need to coincide with DEM points (shapefile from <a class="reference external" href="#epd">above section</a>). Breaklines a stored in a line (vector) shapefile, which is here already provided (<code class="docutils literal notranslate"><span class="pre">breaklines.shp</span></code>). Integrate the breaklines file into the <em>QGIS</em> project as follows with a click on <em>QGIS</em>’ <code class="docutils literal notranslate"><span class="pre">Layer</span></code> menu &gt; <code class="docutils literal notranslate"><span class="pre">Add</span> <span class="pre">Vector</span> <span class="pre">Layer...</span></code> and select the provided <code class="docutils literal notranslate"><span class="pre">breaklines.shp</span></code> file (if not yet done, <a class="reference external" href="https://github.com/hydro-informatics/materials-bm/raw/master/breaklines.zip">download</a> and unpack the shapefile).
Note: The default layer style <code class="docutils literal notranslate"><span class="pre">Single</span> <span class="pre">Symbol</span></code>. For better representation, double-click on the breaklines layer, got to the <code class="docutils literal notranslate"><span class="pre">Symbology</span></code> ribbon and select <code class="docutils literal notranslate"><span class="pre">Categroized</span></code> (or <code class="docutils literal notranslate"><span class="pre">Graduated</span></code>) instead of <code class="docutils literal notranslate"><span class="pre">Single</span> <span class="pre">Symbol</span></code> (at the very top of the <code class="docutils literal notranslate"><span class="pre">Layer</span> <span class="pre">Properties</span></code> window). In the <code class="docutils literal notranslate"><span class="pre">Value</span></code> field, select <code class="docutils literal notranslate"><span class="pre">type</span></code>, then click the <code class="docutils literal notranslate"><span class="pre">classify</span></code> button on the bottom of the <code class="docutils literal notranslate"><span class="pre">Layer</span> <span class="pre">Properties</span></code> window. The listbox will now show the values bank, bed, hole, and all other values. Change color pattern and/or click <code class="docutils literal notranslate"><span class="pre">OK</span></code> on the bottom-right of the <code class="docutils literal notranslate"><span class="pre">Layer</span> <span class="pre">Properties</span></code> window.</p>
</div>
<div class="section" id="tin-elevation-model">
<span id="tin-dem"></span><h2>TIN Elevation Model<a class="headerlink" href="#tin-elevation-model" title="Permalink to this headline">¶</a></h2>
<p>This section explains the creation of a triangulated irregular network (TIN) with the <em>QGIS</em> plugin <em>BASEmesh</em> (make sure that all steps in the <a class="reference external" href="#start-qgis">above section</a> were successful).</p>
<ol class="simple">
<li><p>To start, click on <em>QGIS</em>’ <code class="docutils literal notranslate"><span class="pre">Plugins</span></code> menu &gt; <em>BASEmesh</em> &gt; <code class="docutils literal notranslate"><span class="pre">Elevation</span> <span class="pre">Meshing</span></code> to open the mesh wizard. Use the following settings (see also <a class="reference internal" href="#qgis-exp-tin"><span class="std std-numref">Fig. 25</span></a>:</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Model</span> <span class="pre">boundary</span></code> = <code class="docutils literal notranslate"><span class="pre">boundary</span></code> layer (<a class="reference external" href="#boundary">see above section</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">elevation</span> <span class="pre">points</span></code> = <code class="docutils literal notranslate"><span class="pre">xyz-points</span></code> (<a class="reference external" href="#epd">see above section</a></p></li>
<li><p>Enable the <code class="docutils literal notranslate"><span class="pre">breaklines</span></code> checkbox and select the <code class="docutils literal notranslate"><span class="pre">breaklines</span></code> layer (<a class="reference external" href="#breaklines">see above section</a></p></li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">Shapefile</span> <span class="pre">output</span></code>canvas, click on the BROWSE button and save the new file as, for example, base_tin.shp.</p></li>
<li><p>Click on <code class="docutils literal notranslate"><span class="pre">Generate</span> <span class="pre">Elevation</span> <span class="pre">Mesh</span></code> and <code class="docutils literal notranslate"><span class="pre">Close</span></code> the wizard after successful execution.</p></li>
</ol>
<p>As a result, two new layers will now show up in the Layers window:</p>
<ol class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">base_tin_elevation_nodes.shp</span></code>, and</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">base_tin_elevation_elements.shp</span></code>.</p></li>
</ol>
<div class="figure align-default" id="qgis-exp-tin">
<img alt="basemesh qgis elevation mesh tin" src="../_images/qgis-exp-tin.png" />
<p class="caption"><span class="caption-number">Fig. 25 </span><span class="caption-text">Setup BASEmesh’s Elevation Meshing wizard.</span><a class="headerlink" href="#qgis-exp-tin" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="region-markers-for-quality-meshing">
<span id="regions"></span><h2>Region Markers for Quality Meshing<a class="headerlink" href="#region-markers-for-quality-meshing" title="Permalink to this headline">¶</a></h2>
<p>Region markers are placed within regions defined by breaklines and assign for instance material identifiers (MATIDs) and maximum mesh areas to ensure high mesh quality (e.g., the mesh area should be small in the active channel bed and can be wider on floodplains). To create a new region marker file:</p>
<ul class="simple">
<li><p>Click on <em>QGIS</em>’ <code class="docutils literal notranslate"><span class="pre">Layers</span></code> menu &gt; <code class="docutils literal notranslate"><span class="pre">Create</span> <span class="pre">Layer</span></code> &gt; <code class="docutils literal notranslate"><span class="pre">New</span> <span class="pre">Shapefile</span> <span class="pre">Layer...</span></code> (see <a class="reference internal" href="#qgis-new-lyr"><span class="std std-numref">Fig. 26</span></a>)</p></li>
</ul>
<div class="figure align-default" id="qgis-new-lyr">
<img alt="qgis new layer basemesh" src="../_images/qgis-new-lyr.png" />
<p class="caption"><span class="caption-number">Fig. 26 </span><span class="caption-text">Create a new point shapefile for region definitions from QGIS’ Layer menu.</span><a class="headerlink" href="#qgis-new-lyr" title="Permalink to this image">¶</a></p>
</div>
<ul class="simple">
<li><p>In the newly opened <code class="docutils literal notranslate"><span class="pre">New</span> <span class="pre">Shapefile</span> <span class="pre">Layer</span></code> window, make the following definitions (see also <a class="reference internal" href="#qgis-reg-lyr"><span class="std std-numref">Fig. 27</span></a>).</p>
<ul>
<li><p>Define the File name as region-points.shp (or similar)</p></li>
<li><p>Ensure the Geometry type is Point and the CRS corresponds to the above definitions (<a class="reference external" href="#start-qgis">see above section</a>)</p></li>
<li><p>Add four <code class="docutils literal notranslate"><span class="pre">New</span> <span class="pre">Field</span></code>s (in addition to the default <code class="docutils literal notranslate"><span class="pre">Integer</span></code> type <code class="docutils literal notranslate"><span class="pre">ID</span></code> field):
+ <code class="docutils literal notranslate"><span class="pre">max_area</span></code> = <code class="docutils literal notranslate"><span class="pre">Decimal</span> <span class="pre">number</span></code> (<code class="docutils literal notranslate"><span class="pre">length</span></code> = 10, <code class="docutils literal notranslate"><span class="pre">precision</span></code> = 3)
+ <code class="docutils literal notranslate"><span class="pre">MATID</span></code> = <code class="docutils literal notranslate"><span class="pre">Whole</span> <span class="pre">number</span></code> (<code class="docutils literal notranslate"><span class="pre">length</span></code> = 3)
+ <code class="docutils literal notranslate"><span class="pre">type</span></code> = <code class="docutils literal notranslate"><span class="pre">Text</span> <span class="pre">data</span></code> (<code class="docutils literal notranslate"><span class="pre">length</span></code> = 20)</p></li>
</ul>
</li>
<li><p>Click <code class="docutils literal notranslate"><span class="pre">OK</span></code> to create the new point shapefile.</p></li>
</ul>
<div class="figure align-default" id="qgis-reg-lyr">
<img alt="basement mesh qgis region layer points" src="../_images/qgis-reg-lyr.png" />
<p class="caption"><span class="caption-number">Fig. 27 </span><span class="caption-text">Definitions and fields to be added to the new regions point shapefile.</span><a class="headerlink" href="#qgis-reg-lyr" title="Permalink to this image">¶</a></p>
</div>
<p>After the successful creation, right-click on the new REGION-<code class="docutils literal notranslate"><span class="pre">points</span></code> layer and select TOGGLE EDITING. Then go to <em>QGIS</em>’ EDIT menu and select ADD POINT FEATURE. Create 9 points to define all areas delineated by the <code class="docutils literal notranslate"><span class="pre">breaklines</span></code> layer. These points should include the following region types:</p>
<table class="colwidths-auto table">
<thead>
<tr class="row-odd"><th class="head"><p>Type</p></th>
<th class="head"><p>riverbed</p></th>
<th class="head"><p>lower_bank</p></th>
<th class="head"><p>upper_bank</p></th>
<th class="head"><p>floodplain</p></th>
<th class="head"><p>street</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><code class="docutils literal notranslate"><span class="pre">MATID</span></code></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>3</p></td>
<td><p>4</p></td>
<td><p>5</p></td>
</tr>
<tr class="row-odd"><td><p>max_area</p></td>
<td><p>25.0</p></td>
<td><p>50.0</p></td>
<td><p>100.0</p></td>
<td><p>400.0</p></td>
<td><p>100</p></td>
</tr>
</tbody>
</table>
<p><a class="reference internal" href="#qgis-reg-pts"><span class="std std-numref">Figure 28</span></a> shows an example for defining points within the areas delineated by the breaklines.</p>
<div class="figure align-default" id="qgis-reg-pts">
<img alt="basemesh region points" src="../_images/qgis-reg-pts.png" />
<p class="caption"><span class="caption-number">Fig. 28 </span><span class="caption-text">Example for distributing region points in the project boundaries (remark: the max_area value may differ and is expert assessment-driven). After the placement of all region points, Save Layer Edits (floppy disk symbol) and Toggle Editing (pencil symbol – turn off).</span><a class="headerlink" href="#qgis-reg-pts" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="quality-meshing">
<span id="qualm"></span><h2>Quality meshing<a class="headerlink" href="#quality-meshing" title="Permalink to this headline">¶</a></h2>
<p>A quality mesh accounts for the definitions made within the regions shapefile (<a class="reference external" href="#regions">see above section</a>, but it does not include elevation data. Thus, after generating a quality mesh, elevation information needs to be added from the TIN (<a class="reference external" href="#tin-dem">see above section</a>). This section first explains the <a class="reference internal" href="#qualm-gen"><span class="std std-ref">generation of a quality mesh</span></a> and then the <a class="reference external" href="#qualm-interp">insertion of elevation data</a>).</p>
<div class="section" id="quality-mesh-generation">
<span id="qualm-gen"></span><h3>Quality mesh generation<a class="headerlink" href="#quality-mesh-generation" title="Permalink to this headline">¶</a></h3>
<p>In <em>QGIS</em>’ <code class="docutils literal notranslate"><span class="pre">Plugins</span></code> menu, click on <em>BASEmesh</em> &gt; QUALITY MESHING to open the Quality meshing wizard. Make the following settings in the window (see also <a class="reference internal" href="#qgis-qualm"><span class="std std-numref">Fig. 29</span></a>):</p>
<ol class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">Model</span> <span class="pre">boundary</span></code> = <code class="docutils literal notranslate"><span class="pre">boundary</span></code> (<a class="reference external" href="#boundary">see above section</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">breaklines</span></code> = <code class="docutils literal notranslate"><span class="pre">breaklines</span></code> (<a class="reference external" href="#breaklines">see above section</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Regions</span></code> = <code class="docutils literal notranslate"><span class="pre">regions-points</span></code> (<a class="reference external" href="#regions">see above section</a> and activate all checkboxes</p></li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">Shapefile</span> <span class="pre">output</span></code> canvas, click on the <code class="docutils literal notranslate"><span class="pre">browse</span></code> button to define the output mesh as (for example) <code class="docutils literal notranslate"><span class="pre">base_qualitymesh.shp</span></code></p></li>
</ol>
<div class="figure align-default" id="qgis-qualm">
<img alt="basement qgis quality mesh tin" src="../_images/qgis-qualm.png" />
<p class="caption"><span class="caption-number">Fig. 29 </span><span class="caption-text">BASEmesh’s Quality Meshing wizard.</span><a class="headerlink" href="#qgis-qualm" title="Permalink to this image">¶</a></p>
</div>
<p>Quality meshing may take time. After successful mesh generation the files <code class="docutils literal notranslate"><span class="pre">base_qualitymesh_qualityNodes.shp</span></code> and <code class="docutils literal notranslate"><span class="pre">base_qualitymesh_qualityElements.shp</span></code> are generated. Finally, click <code class="docutils literal notranslate"><span class="pre">Close</span></code>.</p>
</div>
<div class="section" id="elevation-data-interpolation-on-a-quality-mesh-a-name-qualm-interp-a">
<h3>Elevation data interpolation on a quality mesh<a name="qualm-interp"></a><a class="headerlink" href="#elevation-data-interpolation-on-a-quality-mesh-a-name-qualm-interp-a" title="Permalink to this headline">¶</a></h3>
<p><em>BASEmesh</em>’s <code class="docutils literal notranslate"><span class="pre">Interpolation</span></code> wizard projects elevation data onto the quality mesh by interpolation from a TIN. Make sure to check (show) the <code class="docutils literal notranslate"><span class="pre">base_qualitymesh_qualityNodes</span></code> and <code class="docutils literal notranslate"><span class="pre">base_qualitymesh_qualityElements</span></code> from the last step, and <code class="docutils literal notranslate"><span class="pre">base_tin_elevation_nodes.shp</span></code> and <a class="reference external" href="#tin-dem"><code class="docutils literal notranslate"><span class="pre">base_tin_elevation_elements.shp</span></code></a>. Then, open <em>BASEmesh</em>’s <code class="docutils literal notranslate"><span class="pre">Interpolation</span></code> wizard (<em>QGIS</em> <code class="docutils literal notranslate"><span class="pre">Plugins</span></code> menu &gt; <em>BASEmesh</em> &gt; <code class="docutils literal notranslate"><span class="pre">Interpolation</span></code>) and (see also <a class="reference internal" href="#qgis-qualm-interp"><span class="std std-numref">Fig. 30</span></a>):</p>
<ol class="simple">
<li><p>In the <code class="docutils literal notranslate"><span class="pre">Quality</span> <span class="pre">Mesh</span></code> canvas, select <code class="docutils literal notranslate"><span class="pre">base_qualitymesh_qualityNodes</span></code></p></li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">Elevation</span> <span class="pre">Data</span></code> canvas, activate the <code class="docutils literal notranslate"><span class="pre">Elevation</span> <span class="pre">Mesh</span></code> checkbox and select <code class="docutils literal notranslate"><span class="pre">base_tin_elevation_nodes.shp</span></code> and <a class="reference external" href="#tin-dem"><code class="docutils literal notranslate"><span class="pre">base_tin_elevation_elements.shp</span></code></a></p></li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">Shapefile</span> <span class="pre">output</span></code> canvas, define the output file as finalmesh.shp.</p></li>
<li><p>Click <code class="docutils literal notranslate"><span class="pre">Interpolate</span> <span class="pre">elevations</span></code> (may take a while)
After successful execution, the new layer finalmesh_Interpolated_nodes_elevMesh.shp will be created. Click Close to close the Interpolation wizard.</p></li>
</ol>
<div class="figure align-default" id="qgis-qualm-interp">
<img alt="qgis quality mesh interpolation basement" src="../_images/qgis-qualm-interp.png" />
<p class="caption"><span class="caption-number">Fig. 30 </span><span class="caption-text">BASEmesh’s Interpolation wizard and setup.</span><a class="headerlink" href="#qgis-qualm-interp" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="verify-quality-mesh-elevation">
<span id="qualm-verify"></span><h3>Verify quality mesh elevation<a class="headerlink" href="#verify-quality-mesh-elevation" title="Permalink to this headline">¶</a></h3>
<p>After the elevation interpolation, verify that elevations were correctly assigned. To identify potential outliers double-click on the new <code class="docutils literal notranslate"><span class="pre">finalmesh_interpolated_Nodes_elevMesh</span></code> and go to the <code class="docutils literal notranslate"><span class="pre">Symbology</span></code> ribbon. Select <code class="docutils literal notranslate"><span class="pre">Graduated</span></code> at the very top of the window (instead of <code class="docutils literal notranslate"><span class="pre">Single</span> <span class="pre">Symbol</span></code>), set the <code class="docutils literal notranslate"><span class="pre">Value</span></code> to Z, METHOD to COLOR, choose a color ramp, and click on the <code class="docutils literal notranslate"><span class="pre">classify</span></code> bottom (lower part of the window). Click on <code class="docutils literal notranslate"><span class="pre">Apply</span></code> and <code class="docutils literal notranslate"><span class="pre">OK</span></code> to close the <code class="docutils literal notranslate"><span class="pre">Symbology</span></code> window.
<a class="reference internal" href="#qgis-verify-qualm"><span class="std std-numref">Fig. 31</span></a> shows an example of interpolated mesh, with some irregularities (red points). The irregularities are caused by local imprecision of breaklines (line end points do not coincide with the <a class="reference external" href="#epd"><code class="docutils literal notranslate"><span class="pre">xyz-points.shp</span></code></a>). Also some points of the <a class="reference external" href="#boundary">boundary</a> do not correspond the <code class="docutils literal notranslate"><span class="pre">xyz-points.shp</span></code>. If such irregularities occur, zoom at the red points (irregularities) and ensure that the breakline and boundary nodes all exactly coincide with those stored in <code class="docutils literal notranslate"><span class="pre">xyz-points.shp</span></code>. When all nodes are corrected, repeat all steps from the <a class="reference external" href="#tin-dem">TIN generation</a> onward.</p>
<div class="figure align-default" id="qgis-verify-qualm">
<img alt="basemesh verify quality mesh" src="../_images/qgis-verify-qualm.png" />
<p class="caption"><span class="caption-number">Fig. 31 </span><span class="caption-text">Verify elevation interpolation using graduated color ramps. In this example, the red colored points indicated irregularities in the mesh.</span><a class="headerlink" href="#qgis-verify-qualm" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
<div class="section" id="export-to-2dm">
<span id="dm"></span><h2>Export to 2dm<a class="headerlink" href="#export-to-2dm" title="Permalink to this headline">¶</a></h2>
<p>To run <em>BASEMENT</em>, the mesh needs to be exported in 2dm format. <em>BASEmesh</em>’s <code class="docutils literal notranslate"><span class="pre">Export</span> <span class="pre">Mesh</span></code> wizard (<em>QGIS</em> <code class="docutils literal notranslate"><span class="pre">Plugins</span></code> menu &gt; <em>BASEmesh</em> &gt; <code class="docutils literal notranslate"><span class="pre">Export</span> <span class="pre">Mesh</span></code>) does the job with the following settings (see also <a class="reference internal" href="#qgis-exp-mesh"><span class="std std-numref">Fig. 32</span></a>): Export of the mesh to 2dm format with <em>BASEmesh</em>’s <code class="docutils literal notranslate"><span class="pre">Export</span> <span class="pre">Mesh</span></code> wizard.):</p>
<ol class="simple">
<li><p>Select the checkbox 2D MESH <code class="docutils literal notranslate"><span class="pre">Export</span></code></p></li>
<li><p>Mesh elements = <code class="docutils literal notranslate"><span class="pre">base_qualitymesh_quality_elementy.shp</span></code> (<a class="reference external" href="#qualm-interp">see above</a> with <code class="docutils literal notranslate"><span class="pre">Material</span> <span class="pre">ID</span> <span class="pre">field</span></code> = <code class="docutils literal notranslate"><span class="pre">MATID</span></code></p></li>
<li><p>Mesh nodes = <code class="docutils literal notranslate"><span class="pre">finalmesh_interpolated_nodes_elevmesh.shp</span></code> (<a class="reference external" href="#qualm">see above</a> with <code class="docutils literal notranslate"><span class="pre">Elevation</span> <span class="pre">field</span></code> =<code class="docutils literal notranslate"><span class="pre">Z</span></code></p></li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">Mesh</span> <span class="pre">output</span></code> canvas, click on the <code class="docutils literal notranslate"><span class="pre">Browse</span></code> button and select an export mesh directory and name (e.g., <code class="docutils literal notranslate"><span class="pre">finalmesh.2dm</span></code>).</p></li>
<li><p>Click on <code class="docutils literal notranslate"><span class="pre">Export</span> <span class="pre">Mesh</span></code> (may take a while) and <code class="docutils literal notranslate"><span class="pre">Close</span></code> the wizard afterwards.</p></li>
</ol>
<div class="figure align-default" id="qgis-exp-mesh">
<img alt="basement qgis export mesh 2dm" src="../_images/qgis-exp-mesh.png" />
<p class="caption"><span class="caption-number">Fig. 32 </span><span class="caption-text">Export of the mesh to 2dm format with BASEmesh’s Export Mesh wizard.</span><a class="headerlink" href="#qgis-exp-mesh" title="Permalink to this image">¶</a></p>
</div>
<p>In order to work with <em>BASEMENT</em> v3.x, the .2dm file requires a couple of adaptations. Open the produced finalmesh.2dm in a text editor software (right-click and, for example, edit with <a class="reference external" href="hy_get-started/others.html#npp"><em>Notepad++</em></a> and:</p>
<ul class="simple">
<li><p>At the top, insert the following line at line N°2: <code class="docutils literal notranslate"><span class="pre">NUM_MATERIALS_PER_ELEM</span> <span class="pre">1</span></code></p></li>
</ul>
<div class="figure align-default" id="mod-2dm">
<img alt="modify materials basemesh basement 2dm error fix" src="../_images/mod-2dm.png" />
<p class="caption"><span class="caption-number">Fig. 33 </span><span class="caption-text">Modification of the upper part of the .2dm file.</span><a class="headerlink" href="#mod-2dm" title="Permalink to this image">¶</a></p>
</div>
<ul class="simple">
<li><p>At the bottom of the file, add the node string definitions for the inflow and outflow boundary. Enter the following 2 new lines (where <em>nd<sub>i</sub></em> and <em>nd<sub>j</sub></em> represent the <em>Inflow</em> and <em>Outflow</em> nodes, respectively, of <a class="reference external" href="#qualm-interp">finalmesh_interpolatedNodes_elevMesh.shp</a>:</p>
<ul>
<li><p><em>NS[SPACE][SPACE]nd<sub>1</sub>[SPACE]nd<sub>2</sub>[SPACE]nd<sub>i</sub>[SPACE]nd<sub>n</sub>[SPACE]Inflow</em></p></li>
<li><p><em>NS[SPACE][SPACE]nd<sub>1</sub>[SPACE]nd<sub>2</sub>[SPACE]nd<sub>j</sub>[SPACE]nd<sub>m</sub>[SPACE]Outflow</em></p></li>
</ul>
</li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>To <strong>identify</strong> the <strong>node IDs</strong> open <em>QGIS</em> use <strong><em>BASEmesh</em>’s Stringdef</strong> wizard (from <em>BASEMENT</em> v2.8 user manual - read more below).</p>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>&lt;a name=&quot;stringdef&quot;&gt;&lt;/a&gt;
* *Stringdef* identifies points that have a non-empty `stringdef`-field (i.e., all nodes that are located exactly on that line) and writes them into a text file (*BASEMENT*-like `stringdef` block). The content of the `stringdef`-field represents the `stringdef` name.
* In order to identify the node ids on the inflow and outflow boundary lines, select the final mesh nodes in the *Mesh Nodes* dialogue, select the provided [breaklines shapefile](https://github.com/hydro-informatics/materials-bm/raw/master/breaklines.zip) in the *Breaklines* dialogue and select *stringdef* from the dropdown menu.
* In the *Textfile OUTPUT* dialogue, select an output text file (e.g., `C:/temp/stringdef-breaklines.txt`) and click on ***Find node IDs***
</pre></div>
</div>
<div class="figure align-default" id="bm-str-def-tool">
<img alt="basement stringdef tool" src="../_images/qgis-stringdef.png" />
<p class="caption"><span class="caption-number">Fig. 34 </span><span class="caption-text">BASEmesh’s Stringdef tool.</span><a class="headerlink" href="#bm-str-def-tool" title="Permalink to this image">¶</a></p>
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>* The *Stringdef* tool now has generated  `stringdef`s in upstream-looking right direction (note: to create new boundaries, the lines need to be drawn from the left riverbank to the right riverbank).
* Open the resulting text file (`C:/temp/stringdef-breaklines.txt` in the above example) and copy the node list to the bottom of *finalmesh.2dm* with the above-shown format (i.e., start with *NS*, followed by two SPACEs, then the node IDs *nd&lt;sub&gt;i/j &lt;/sub&gt;* separated by on SPACE, then *Inflow* and *Outflow*, respectively). *Note: The node IDs my vary from those shown in the figure(s).*
</pre></div>
</div>
<div class="figure align-default" id="bm-str-def">
<img alt="basement stringdef" src="../_images/qgis-stringdef-out.png" />
<p class="caption"><span class="caption-number">Fig. 35 </span><span class="caption-text">The output of BASEmesh’s Stringdef tool: Node IDs of the Inflow and Outflow boundaries.</span><a class="headerlink" href="#bm-str-def" title="Permalink to this image">¶</a></p>
</div>
<ul class="simple">
<li><p>Finally, the bottom of the finalmesh.2dm (text editor) should look like this in the text editor (node <code class="docutils literal notranslate"><span class="pre">ID</span></code>s may vary from those in the screenshot):</p></li>
</ul>
<div class="figure align-default" id="mod-2dm-bottom">
<img alt="basement 2dm modify bottom nodes error fix" src="../_images/mod-2dm-bottom.png" />
<p class="caption"><span class="caption-number">Fig. 36 </span><span class="caption-text">Modification of the bottom part of the .2dm file.</span><a class="headerlink" href="#mod-2dm-bottom" title="Permalink to this image">¶</a></p>
</div>
<p>Congratulations, you finished meshing!</p>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "hydro-informatics/",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./numerics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="numerical-modeling.html" title="previous page">Principles</a>
    <a class='right-next' id="next-link" href="basement.html" title="next page">BASEMENT</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Sebastian Schwindt<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>

<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>3d modeling with TELEMAC &#8212; Hydro-Informatics</title>
    
  <link rel="stylesheet" href="../_static/css/index.f658d18f9b420779cfdf24aa0a7e2d77.css">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      
  <link rel="stylesheet"
    href="../_static/vendor/open-sans_all/1.44.1/index.css">
  <link rel="stylesheet"
    href="../_static/vendor/lato_latin-ext/1.44.1/index.css">

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.40e2e510f6b7d1648584402491bb10fe.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.d3f166471bb80abb5163.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/tabs.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.d31b09fe5c1d09cb49b26a786de4a05d.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://hydro-informatics.github.io/numerics/telemac3d.html" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Gaia Workflow" href="telemac-gaia.html" />
    <link rel="prev" title="Pre-Processing for TELEMAC models" href="telemac2d.html" />

    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />


<!-- Opengraph tags -->
<meta property="og:url"         content="https://hydro-informatics.github.io/numerics/telemac3d.html" />
<meta property="og:type"        content="article" />
<meta property="og:title"       content="3d modeling with TELEMAC" />
<meta property="og:description" content="3d modeling with TELEMAC  telemac3d salome med results  This tutorial describes setting up and running a simple three-dimensional (3d) model of a flume based on" />
<meta property="og:image"       content="https://hydro-informatics.github.io/_static/icon.jpg" />

<meta name="twitter:card" content="summary" />


  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
<a class="navbar-brand text-wrap" href="../index.html">
  
  <img src="../_static/icon.jpg" class="logo" alt="logo">
  
  
  <h1 class="site-logo" id="site-title">Hydro-Informatics</h1>
  
</a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form>
<nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <p class="caption collapsible-parent">
 <span class="caption-text">
  Get Started
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../lectures/classroom.html">
   The Virtual Classroom
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/lectures.html">
     Lectures and exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/take_seat.html">
     Take a Seat in the Virtual Classroom
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../get-started/software.html">
   Software Resources
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/vm.html">
     Virtual Machines and Linux
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/vm.html#get-started-with-debian-linux">
     Get started with (Debian) Linux
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/ide.html">
     Anaconda and Integrated Development Environments (IDEs)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/git.html">
     Introduction to git
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/geo.html">
     Geospatial Software
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/install-openfoam.html">
     Install OpenFOAM
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/install-telemac.html">
     open TELEMAC (Installation)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/others.html">
     Other Software Resources
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Python Basics
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../python-basics/python.html">
   Get Started with Python
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../python-basics/pyinstall.html">
     Install Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pybase.html">
     First steps
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pyerror.html">
     Errors, Logging, and Debugging
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pyloop.html">
     Loops and Conditional Statements
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../python-basics/modularize.html">
   Modularization &amp; Object Orientation
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pyfun.html">
     Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pypckg.html">
     Packages, Modules and Libraries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/classes.html">
     Object Orientation and Classes
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../python-basics/data-handling.html">
   Data and File Handling
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pynum.html">
     Load and Write Basic Data Files
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pynum.html#numpy">
     NumPy
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pynum.html#pandas">
     Pandas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pynum.html#dates-and-time">
     Dates and Time
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/xml.html">
     Manipulation of Workbooks and JSON Files
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pyplot.html">
     Plotting
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../jupyter/pystyle.html">
   Code Style and Conventions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../jupyter/gui.html">
   Graphical User Interfaces (GUIs)
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../exercises/python-exercises.html">
   Python Exercises
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-ms.html">
     1d Hydraulics (Manning-Strickler Formula)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-sp.html">
     Reservoir Volume Calculation with a Sequent Peak Algorithm
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-floods.html">
     Calculate flood return periods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-sediment.html">
     Cross-section Averaged Sediment Transport
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-gui.html">
     Create a
     <strong>
      G
     </strong>
     raphical
     <strong>
      U
     </strong>
     ser
     <strong>
      I
     </strong>
     nterface (GUI)
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Documentation
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../documentation/documentation.html">
   Markdown and Code Documentation
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../exercises/docs-exercises.html">
   Exercises
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-git.html">
     Git and markdown
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Geospatial Analysis
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../geopy/geospatial-data.html">
   Geospatial Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../geopy/use-qgis.html">
   QGIS tutorial
  </a>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../geopy/geo-python.html">
   Geospatial Python
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../geopy/geo-pckg.html">
     Geospatial Python - Open Source Packages
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/geo-shp.html">
     Shapefile (vector dataset) handling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/geo-raster.html">
     Raster (Gridded) Dataset Handling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/geo-convert.html">
     Raster to Vector Conversion and Vice Versa
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/geo-arcpy.html">
     The Commercial arcpy Library
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../exercises/geo-exercises.html">
   Exercises
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-geco.html">
     Create a habitat suitability map
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Numerical Modeling
 </span>
</p>
<ul class="current nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="numerical-modeling.html">
   Principles
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="pre-qgis.html">
   Pre-Processing with QGIS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="basement.html">
   BASEMENT
  </a>
 </li>
 <li class="toctree-l1 current active collapsible-parent">
  <a class="reference internal" href="telemac.html">
   TELEMAC
  </a>
  <ul class="current collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="telemac2d.html">
     Pre-Processing for TELEMAC models
    </a>
   </li>
   <li class="toctree-l2 current active">
    <a class="current reference internal" href="#">
     3d modeling with TELEMAC
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="telemac-gaia.html">
     Gaia Workflow
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="openfoam.html">
   OpenFOAM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="calibration.html">
   Calibration and Valdiation
  </a>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Troubleshoot
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../troubleshoot/dbg-programming.html">
   Programming Tools and IDEs
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-anaconda.html">
     Debugging Anaconda
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-python.html">
     Debugging Python Code
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-jupyter.html">
     Debugging Jupyter
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../troubleshoot/dbg-numerical-models.html">
   Numerical Models
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-basement.html">
     Debugging BASEMENT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-telemac.html">
     Debugging TELEMAC/SALOME
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
 <li class="toctree-l1 collapsible-parent">
  <a class="reference internal" href="../troubleshoot/dbg-os.html">
   Operating Systems (Linux and VMs)
  </a>
  <ul class="collapse-ul">
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-linux.html">
     Debugging Debian Linux
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-vm.html">
     Debugging Virtual Machines
    </a>
   </li>
  </ul>
  <i class="fas fa-chevron-down">
  </i>
 </li>
</ul>
<p class="caption collapsible-parent">
 <span class="caption-text">
  Disclaimer and License
 </span>
</p>
<ul class="nav sidenav_l1">
 <li class="toctree-l1">
  <a class="reference internal" href="../terms/license.html">
   License
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../terms/disclaimer.html">
   Disclaimer
  </a>
 </li>
</ul>

</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Written by <a href="https://sebastian-schwindt.org">Sebastian Schwindt</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="row topbar fixed-top container-xl">
    <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show">
    </div>
    <div class="col pl-2 topbar-main">
        
        <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
            data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
            aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
            title="Toggle navigation" data-toggle="tooltip" data-placement="left">
            <i class="fas fa-bars"></i>
            <i class="fas fa-arrow-left"></i>
            <i class="fas fa-arrow-up"></i>
        </button>
        
        
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/numerics/telemac3d.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

        <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/hydro-informatics/"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>


        <!-- Full screen (wrap in <a> to have style consistency -->
        <a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
                data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
                title="Fullscreen mode"><i
                    class="fas fa-expand"></i></button></a>

        <!-- Launch buttons -->

    </div>

    <!-- Table of contents -->
    <div class="d-none d-md-block col-md-2 bd-toc show">
        
        <div class="tocsection onthispage pt-5 pb-3">
            <i class="fas fa-list"></i> Contents
        </div>
        <nav id="bd-toc-nav">
            <ul class="nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#introduction">
   Introduction
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#input-files">
   Input files
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#start-salome-hydro">
   Start SALOME-HYDRO
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#hydro-module">
   HYDRO module
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-contours-polyline">
     Create Contours (Polyline)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-a-natural-object">
     Create a Natural Object
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-a-calculation-case">
     Create a Calculation Case
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#build-the-geometry">
   Build the Geometry
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#generate-a-mesh">
   Generate a Mesh
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#two-dimensional-2d-mesh-of-the-surface">
     Two-dimensional (2d) mesh of the surface
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#one-dimensional-1d-meshes-of-boundary-edges">
     One-dimensional (1d) meshes of boundary edges
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#compute-mesh">
     Compute Mesh
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#verify-mesh">
     Verify Mesh
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#export-med-file">
   Export MED File
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#generate-boundary-conditions">
   Generate Boundary Conditions
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#basic-setup-with-the-hydrosolver-module">
     Basic Setup with the HydroSolver Module
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#modify-the-boundary-file">
     Modify the Boundary File
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#create-simulation-case-cas">
   Create Simulation Case (CAS)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#overview-manual-cas-file-setup-recommended">
     Overview: Manual CAS File Setup (Recommended)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#computation-environment-a-name-comp-env-a">
     Computation Environment
     <a name="comp-env">
     </a>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#general-parameters">
     General Parameters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#vertical-3d-parameters">
     Vertical (3d) Parameters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#numerical-parameters">
     Numerical Parameters
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#hydrodynamic-parameters-a-name-hydrodynamics-a">
     Hydrodynamic Parameters
     <a name="hydrodynamics">
     </a>
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#turbulence">
     Turbulence
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#hydrosolver-cas-file-setup-unstable">
     <em>
      HydroSolver
     </em>
     CAS File Setup (Unstable)
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#run-simulation-compute">
   Run Simulation (Compute)
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#stand-alone-telemac-installation">
     Stand-alone TELEMAC installation
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#salome-hydro-hydrosolver">
     <em>
      SALOME-HYDRO
     </em>
     &amp;
     <em>
      HydroSolver
     </em>
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#post-processing-with-salome-and-paravis">
   Post-Processing with SALOME and ParaVis
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#load-results-med-file">
     Load Results (MED file)
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#export-data">
     Export Data
    </a>
   </li>
  </ul>
 </li>
</ul>

        </nav>
        
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="d-modeling-with-telemac">
<h1>3d modeling with TELEMAC<a class="headerlink" href="#d-modeling-with-telemac" title="Permalink to this headline">¶</a></h1>
<img alt="telemac3d salome med results" src="../_images/telemac3d-header.png" />
<p>This tutorial describes setting up and running a simple three-dimensional (3d) model of a flume based on the <em>MED</em> file library provided by <a class="reference external" href="https://www.salome-platform.org/">salome-platform.org</a>. The explanations build on the <a class="reference external" href="http://ot-svn-public:telemac1*&#64;svn.opentelemac.org/svn/opentelemac/tags/v8p1r2/documentation/telemac2d/user/telemac3d_user_v8p1.pdf">telemac3d user manual (v8p1)</a> and more documentation can be found on <a class="reference external" href="http://wiki.opentelemac.org/doku.php?id=documentation_v8p2r0">opentelemac.org/doku</a>.</p>
<div class="admonition-requirements admonition">
<p class="admonition-title">Requirements</p>
<p>The case featured in this tutorial was established on <em>Debian Linux</em> (<em>buster</em>) with: <br><br><strong>- <a class="reference external" href="../get-started/telemac.html#salome-hydro"><em>SALOME-HYDRO</em> v2_2</a></strong><br><strong>- <a class="reference external" href="../get-started/install-openfoam.html#salome"><em>SALOME 9.6.0</em></a></strong>, and <br><strong>- <a class="reference external" href="../get-started/telemac.html#modular-install"><em>TELEMAC</em> v8p2r0</a></strong> (stand-alone installation).</p>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>All files created in this tutorial can be downloaded <a class="reference external" href="https://github.com/Ecohydraulics/telemac3d-tutorial">here</a> (zip-download or clone the repository).</p>
</div>
<p>To explore example cases of <em>Telemac3d</em>, check out the <em>TELEMAC</em> installation folder, for instance, <strong>/telemac/v8p2/examples/telemac3d/</strong>.</p>
<div class="section" id="introduction">
<h2>Introduction<a class="headerlink" href="#introduction" title="Permalink to this headline">¶</a></h2>
<p><em>Telemac3d</em> solves the Navier-Stokes equations along a three-dimensional (3D) computational grid using a finite element scheme. <em>Telemac3d</em> mounts the tetrahedral 3D mesh from a triangular 2D mesh in a user-defined number of vertical layers. The number of vertical layers to use is defined in the TELEMAC steering (CAS) file. This tutorial walks through the creation of a 2D mesh with SALOME-HYDRO along with boundary and control files. The tutorial also features running a <em>Telemac3d</em> simulation with the files created and plotting results with the <em>ParaVis</em> plugin of <em>SALOME-9.6.0</em> (a tweaked version of <em>ParaView</em> that is able to read <em>MED</em> files).</p>
</div>
<div class="section" id="input-files">
<h2>Input files<a class="headerlink" href="#input-files" title="Permalink to this headline">¶</a></h2>
<p>A <em>Telemac3d</em> simulation requires similar input files as a Telemac2d simulation and this tutorial uses <em>MED</em> files to define the geometry. In particular, the following files will be created:</p>
<ul class="simple">
<li><p>Steering file</p>
<ul>
<li><p>File format: <code class="docutils literal notranslate"><span class="pre">cas</span></code></p></li>
<li><p>Software: SALOME-HYDRO’s <em>HydroSolver</em> module (alternatively: <a class="reference external" href="../get-started/telemac.html#fudaa">Fudaa PrePro</a> or any text editor)</p></li>
</ul>
</li>
<li><p>Geometry file</p>
<ul>
<li><p>File format: <code class="docutils literal notranslate"><span class="pre">med</span></code> or <code class="docutils literal notranslate"><span class="pre">slf</span></code></p></li>
<li><p>Software: SALOME-HYDRO’s <em>Geometry</em> and <em>Mesh</em> modules</p></li>
</ul>
</li>
<li><p>Boundary conditions</p>
<ul>
<li><p>File format: <code class="docutils literal notranslate"><span class="pre">.bnd</span></code></p></li>
<li><p>Software: SALOME-HYDRO’s <em>HydroSolver</em> module</p></li>
</ul>
</li>
<li><p>Unsteady flow conditions</p>
<ul>
<li><p>File format: <code class="docutils literal notranslate"><span class="pre">.qsl</span></code></p></li>
<li><p>Prepare with any text editor</p></li>
</ul>
</li>
</ul>
<p>Optional files such as a friction data file or a liquid boundary file can also be implemented, but are not featured here. Read more about input data files and their formats in the <a class="reference internal" href="telemac.html"><span class="doc std std-doc"><em>TELEMAC</em> introduction</span></a>.</p>
</div>
<div class="section" id="start-salome-hydro">
<span id="prepro-salome"></span><h2>Start SALOME-HYDRO<a class="headerlink" href="#start-salome-hydro" title="Permalink to this headline">¶</a></h2>
<p>With <em>SALOME-HYDRO</em> being installed in a directory called <strong>/home/salome-hydro/appli_V2_2/</strong> (adapt according to the installation directory and version of SALOME-HYDRO), launch <em>SALOME-HYDRO</em> (give it a moment to start up):</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">salome</span><span class="o">-</span><span class="n">hydro</span><span class="o">/</span><span class="n">appli_V2_2</span><span class="o">/</span><span class="n">salome</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Read more about the installation, requirements, and launching (starting) <em>SALOME-HYDRO</em> on the <a class="reference external" href="../get-started/telemac.html#salome-hydro">installation page</a>.</p>
</div>
</div>
<div class="section" id="hydro-module">
<h2>HYDRO module<a class="headerlink" href="#hydro-module" title="Permalink to this headline">¶</a></h2>
<div class="section" id="create-contours-polyline">
<h3>Create Contours (Polyline)<a class="headerlink" href="#create-contours-polyline" title="Permalink to this headline">¶</a></h3>
<p>After starting SALOME-HYDRO, activate the <em>HYDRO</em> module, then find the <em>Object Browser</em> on the right side of the window and the <strong>POLYLINE</strong> folder symbol.</p>
<div class="figure align-default">
<img alt="telemac3d salome hydro start" src="../_images/sah-startup.png" />
</div>
<p>Right-click on the <em>POLYLINE</em> folder, select <strong>Create polyline</strong> and a popup window will open. In the popup window:</p>
<ul class="simple">
<li><p>For <strong>Name</strong> enter: <code class="docutils literal notranslate"><span class="pre">Contour</span></code></p></li>
<li><p>Click on the <em>Insert new section</em> button:</p></li>
</ul>
<div class="figure align-default">
<img alt="telemac salome hydro polyline" src="../_images/sah-hydro-create-polyline.png" />
</div>
<div class="highlight-none notranslate"><div class="highlight"><pre><span></span>+ For **Name** enter: `Section_1`
+ For **Type** select **Polyline**
+ Ensure that the **Closed** box is checked
+ Press **Add**
</pre></div>
</div>
<div class="figure align-default">
<img alt="telemac salome create polyline" src="../_images/sah-create-polyline.png" />
</div>
<ul class="simple">
<li><p>Click on the <em>Addition mode</em> button to draw a polygon: Start with the first point in the upper left corner and move in clock-wise direction to draw the other three points.</p></li>
</ul>
<div class="figure align-default">
<img alt="telemac salome hydro polygon addition" src="../_images/sah-polyline-addition.png" />
</div>
<ul class="simple">
<li><p>The polygon should show up in the viewport as shown below (qualitative match is sufficient for now)</p></li>
</ul>
<div class="figure align-default">
<img alt="telemac salome hydro polygon qualitative" src="../_images/sah-polyline-draw.png" />
</div>
<div class="figure align-default">
<img alt="telemac salome hydro polygon qualitative" src="../_images/sah-polyline-draw-dir.png" />
</div>
<ul class="simple">
<li><p>Press <strong>Apply and close</strong></p></li>
</ul>
<p>In the viewport, click the polyline, then right-click on it and select <strong>Modification mode</strong> in the context menu.</p>
<div class="figure align-default">
<img alt="telemac salome hydro edit polygon" src="../_images/sah-polyline-edit.png" />
</div>
<div class="figure align-default">
<img alt="telemac salome hydro edit polygon modification" src="../_images/sah-polyline-edit-popup.png" />
</div>
<p>To get the data table (<em>Section</em> / <em>Index</em>) visible in the lower part of the popup window, highlight the four edges of the polygon in the viewport with the mouse.</p>
<p>In the popup window, modify the points so that a 500-m long and 100-m wide rectangle occurs as shown below (the section <em>Index</em> numbers will change, so pay attention to not create crossing lines).</p>
<div class="figure align-default">
<img alt="telemac salome hydro edit polygon" src="../_images/sah-polyline-edited.png" />
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Save the project by clicking on the <strong>File</strong> (top menu) &gt; <strong>Save As…</strong>. In the popup menu, select the simulation target folder and define a name such as <em>flume3d</em>. Press <strong>Save</strong> to save the project in <strong>hdf</strong> format and regularly press the save button (disk symbol) in the next steps to avoid losing work. Thus, the project can be saved, closed, and re-opened any time.</p>
</div>
<div class="figure align-default">
<img alt="telemac salome hydro save study as hdf" src="../_images/save-study-as.png" />
</div>
<div class="figure align-default">
<img alt="telemac salome hydro save study hdf" src="../_images/save-study-props.png" />
</div>
</div>
<div class="section" id="create-a-natural-object">
<h3>Create a Natural Object<a class="headerlink" href="#create-a-natural-object" title="Permalink to this headline">¶</a></h3>
<p>From the <em>HYDRO</em> top menu, select <strong>Create immersible zone</strong> to define a wetted area for the later created mesh.</p>
<div class="figure align-default">
<img alt="telemac salome hydro create immersible zone" src="../_images/sah-nat-immersible-zone.png" />
</div>
<p>In the popup window, make the following settings:</p>
<ul class="simple">
<li><p><strong>Name:</strong> <code class="docutils literal notranslate"><span class="pre">wetted_contour</span></code></p></li>
<li><p><strong>Polyline:</strong> Select the previously created <code class="docutils literal notranslate"><span class="pre">Contour</span></code> rectangle (double-click in the field).</p></li>
<li><p><strong>Bathymetry:</strong> Leave empty.</p></li>
</ul>
<div class="figure align-default">
<img alt="telemac salome hydro create wetted area zone" src="../_images/sah-nat-wetted-zone.png" />
</div>
<ul class="simple">
<li><p>Press <strong>Apply and close</strong>.</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>A <strong>bathymetry</strong> file <strong>assigns bottom elevations</strong> to the geometry and can either be directly added in the HYDRO module or later with the <a class="reference external" href="http://ot-svn-public:telemac1*&#64;svn.opentelemac.org/svn/opentelemac/tags/v8p1r1/documentation/stbtel/user/stbtel_user_v8p1.pdf"><em>STBTEL</em> software</a> that comes along with <em>TELEMAC</em>. Not providing a bathymetry file like in this tutorial will set the bottom level to zero.</p>
</div>
</div>
<div class="section" id="create-a-calculation-case">
<h3>Create a Calculation Case<a class="headerlink" href="#create-a-calculation-case" title="Permalink to this headline">¶</a></h3>
<p>One or more calculation cases can be created to define elements for the later simulation. Here, define one calculation case, by clicking on the <strong>HYDRO</strong> top-menu &gt; <strong>Create calculation case</strong>. A popup window opens and guides through setting up the calculation case.</p>
<p><strong>Step 1:</strong> Define the framework:</p>
<ul class="simple">
<li><p><strong>Name</strong>: <code class="docutils literal notranslate"><span class="pre">Hydrodynamic</span></code></p></li>
<li><p><strong>Limits</strong>: <code class="docutils literal notranslate"><span class="pre">Contour</span></code></p></li>
<li><p><strong>Mode</strong>: Select <strong>Manual</strong>.</p></li>
<li><p>Highlight <code class="docutils literal notranslate"><span class="pre">wetted_contour</span></code> and <code class="docutils literal notranslate"><span class="pre">Contour</span></code> in the <em>Objects</em> frame and press <strong>Include &gt;&gt;</strong> to add it to the list of <em>Included objects</em>.</p></li>
<li><p>Press <strong>Next &gt;</strong> (button at the bottom)</p></li>
</ul>
<div class="figure align-default">
<img alt="telemac salome hydro contour create" src="../_images/sah-create-calc-case-popup.png" />
</div>
<p><strong>Step 2:</strong> <strong>Include &gt;&gt;</strong>  <code class="docutils literal notranslate"><span class="pre">wetted_contour_Outer</span></code>and press <strong>Next &gt;</strong>.</p>
<div class="figure align-default">
<img alt="telemac salome hydro contour zone" src="../_images/sah-create-calc-case-groups.png" />
</div>
<p><strong>Step 3:</strong> Leave the boundary polygons window as-is and just click <strong>Next &gt;</strong></p>
<div class="figure align-default">
<img alt="telemac salome hydro contour boundary" src="../_images/sah-create-calc-case-bc.png" />
</div>
<p><strong>Step 4:</strong> Omit the definition of a <em>Strickler table</em> and press <strong>Next &gt;</strong>.</p>
<ul class="simple">
<li><p>Note that this step may be useful to define zones with different roughness attributes.</p></li>
</ul>
<div class="figure align-default">
<img alt="telemac salome hydro contour strickler" src="../_images/sah-create-calc-case-strickler.png" />
</div>
<p><strong>Step 5:</strong> Finalize the calculation case creation by clicking on the <strong>Finish</strong> button.</p>
<div class="figure align-default">
<img alt="telemac salome hydro calculation case" src="../_images/sah-create-calc-case-finish.png" />
</div>
<p>Export the calculation case by right-clicking on the <strong>Hydrodynamic</strong> calculation case in the <em>Object Browser</em>, then <strong>Export calculation case</strong>. As a result, a <em>Geometry</em> entry becomes visible in the <em>Object Browser</em>.</p>
<div class="figure align-default">
<img alt="telemac salome hydro calculation case export menu" src="../_images/sah-export-calc-case-menu.png" />
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Save the project by clicking on the disk symbol.</p>
</div>
</div>
</div>
<div class="section" id="build-the-geometry">
<h2>Build the Geometry<a class="headerlink" href="#build-the-geometry" title="Permalink to this headline">¶</a></h2>
<p>This section guides through the creation of a rectangular geometry surface representing a flume and its boundaries defined with edges (lines). To get ready, activate the <strong>Geometry</strong> module, right-click on <em>HYDRO_Hydrodynamic_1</em>, and select <strong>Show Only</strong>.</p>
<div class="figure align-default">
<img alt="telemac salome hydro calculation case exported geometry" src="../_images/sah-exported-calc-case-geometry.png" />
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>Earlier versions of <em>SALOME-HYDRO</em> will also require to create a surface group, which already exists in this case with <code class="docutils literal notranslate"><span class="pre">Hydrodynamic_Reg_1</span></code>.</p>
</div>
<p>Right-click on <em>HYDRO_Hydrodynamic_1</em> and select <strong>Create Group</strong> from the context menu.
The four boundary edges of the surface will represent an upstream (inflow), a downstream (outflow), a left wall, and a right wall of the flume. To create the four boundary edges repeat the following steps for every edge:</p>
<ul class="simple">
<li><p><strong>Shape Type</strong> (radio buttons in the upper part): select <em>Edge</em> (line symbol)</p></li>
<li><p><strong>Name</strong>: <code class="docutils literal notranslate"><span class="pre">upstream</span></code> (then <code class="docutils literal notranslate"><span class="pre">downstream</span></code>, <code class="docutils literal notranslate"><span class="pre">leftwall</span></code>, and <code class="docutils literal notranslate"><span class="pre">rightwall</span></code>)</p></li>
<li><p><strong>Main Shape</strong>: select <code class="docutils literal notranslate"><span class="pre">HYDRO_Hydrodynamic_1</span></code></p></li>
<li><p>Click on <strong>Show all sub-shapes</strong> &gt; <strong>Select line in the viewport</strong>. In the white frame of the <em>Create Group</em> window, make sure to select the good edge only. <strong>Add</strong> the correct edge and <strong>Remove</strong> all others.</p></li>
</ul>
<div class="figure align-default" id="id1">
<img alt="telemac salome geometry group faces" src="../_images/geo-create-group-upstream.png" />
<p class="caption"><span class="caption-number">Fig. 60 </span><span class="caption-text">Define the upstream edge of the surface.</span><a class="headerlink" href="#id1" title="Permalink to this image">¶</a></p>
</div>
<ul class="simple">
<li><p>For defining the other edges (<code class="docutils literal notranslate"><span class="pre">downstream</span></code>, <code class="docutils literal notranslate"><span class="pre">leftwall</span></code>, and <code class="docutils literal notranslate"><span class="pre">rightwall</span></code>), use the indications in the following figure.</p></li>
</ul>
<div class="figure align-default">
<img alt="telemac salome rectangular flume" src="../_images/tm-rectangular-flume.png" />
</div>
<ul class="simple">
<li><p>Click <strong>Apply</strong> to create the edge boundary and proceed with the next. After the last (fourth) edge, click <strong>Apply and Close</strong>.</p></li>
</ul>
<p>Ultimately, the <em>Geometry</em> block in the <em>Object Browser</em> should look as follows.</p>
<div class="figure align-default">
<img alt="telemac salome geometry group object browser" src="../_images/geo-created-groups-ob.png" />
</div>
</div>
<div class="section" id="generate-a-mesh">
<h2>Generate a Mesh<a class="headerlink" href="#generate-a-mesh" title="Permalink to this headline">¶</a></h2>
<p>To work with the geometry in a numerical model, the geometry needs to be defined as a triangular computational mesh that <em>Telemac3d</em> will extrapolate to a tetrahedral mesh. The <em>Mesh</em> module in <em>SALOME-HYDRO</em> enables the creation of a mesh with just a view clicks. The mesh is generated first for the surface (2d), then for every boundary edge (1d), and eventually computed and verified. To get ready, activate the <strong>Mesh</strong> module from the top menu.</p>
<div class="section" id="two-dimensional-2d-mesh-of-the-surface">
<h3>Two-dimensional (2d) mesh of the surface<a class="headerlink" href="#two-dimensional-2d-mesh-of-the-surface" title="Permalink to this headline">¶</a></h3>
<p><strong>Highlight <em>HYDRO_Hydrodynamic_1</em></strong>  in the <em>Object Browser</em>. Then, go to the <strong>Mesh</strong> top menu (do not confuse with the <em>Mesh</em> module), and select <strong>Create Mesh</strong>.</p>
<div class="figure align-default">
<img alt="telemac salome mesh create" src="../_images/mes-01-create-mesh.png" />
</div>
<p>In the <strong>Create mesh</strong> popup window set the following:</p>
<ul class="simple">
<li><p><strong>Name</strong>: <code class="docutils literal notranslate"><span class="pre">Mesh_Hn_1</span></code></p></li>
<li><p><strong>Geometry</strong>: <code class="docutils literal notranslate"><span class="pre">HYDRO_Hydrodynamic_1</span></code></p></li>
<li><p>Leave the <strong>Mesh type</strong> as <em>Any</em></p></li>
<li><p>In the <strong>2D</strong> tab:</p>
<ul>
<li><p>Choose <em>Netgen 1D-2D</em> for <strong>Algorithm</strong></p></li>
<li><p>Find the cogwheel symbol behind the <strong>Hypothesis</strong> field and click on it to construct hypotheses for <strong>Netgen 2D Parameters</strong>.</p></li>
<li><p>In the <strong>Hypothesis Construction</strong> popup window:</p>
<ul>
<li><p>Define <strong>Name</strong> as <code class="docutils literal notranslate"><span class="pre">NETGEN</span> <span class="pre">2D</span> <span class="pre">Parameters</span> <span class="pre">10_30</span></code></p></li>
<li><p>Set <strong>Max. Size</strong> to <code class="docutils literal notranslate"><span class="pre">30</span></code></p></li>
<li><p>Set <strong>Min. Size</strong> to <code class="docutils literal notranslate"><span class="pre">10</span></code></p></li>
<li><p>Set <strong>Fineness</strong> to <em>Very Fine</em>,</p></li>
<li><p>Leave all other field’s default values and click <strong>OK</strong>.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Back in the <strong>Create mesh</strong> window, set the just created <em>NETGEN 2D Parameters 10_30</em> as <strong>Hypothesis</strong>.</p></li>
<li><p>Click on <strong>Apply and Close</strong> (<strong>Create mesh</strong> popup window)</p></li>
</ul>
<div class="figure align-default">
<img alt="telemac salome mesh create netgen 2d hypothesis" src="../_images/mes-02-create-mesh-netgen2d-hypo.png" />
</div>
<div class="figure align-default">
<img alt="telemac salome mesh create netgen 1d-2d" src="../_images/mes-03-create-mesh-netgen2d.png" />
</div>
</div>
<div class="section" id="one-dimensional-1d-meshes-of-boundary-edges">
<h3>One-dimensional (1d) meshes of boundary edges<a class="headerlink" href="#one-dimensional-1d-meshes-of-boundary-edges" title="Permalink to this headline">¶</a></h3>
<p>The 1d meshes of the boundary edges will represent sub-meshes of the 2d mesh. To create the sub-meshes, <strong>highlight</strong> the previously created <strong>Mesh_Hn_1</strong> in the <em>Object Browser</em> (click on it), then go to the <strong>Mesh</strong> top menu and select <strong>Create Sub-Mesh</strong>.</p>
<div class="figure align-default">
<img alt="telemac salome mesh create" src="../_images/mes-04-create-submesh-menu.png" />
</div>
<p>In the <strong>Create sub-mesh</strong> popup window, start with creating the upstream boundary edge’s mesh:</p>
<ul class="simple">
<li><p><strong>Name</strong>: <code class="docutils literal notranslate"><span class="pre">upstream</span></code></p></li>
<li><p><strong>Mesh</strong>: <code class="docutils literal notranslate"><span class="pre">Mesh_Hn_1</span></code></p></li>
<li><p>Leave the <strong>Mesh type</strong> as <em>Any</em></p></li>
<li><p>In the <strong>1D</strong> tab:</p>
<ul>
<li><p>Choose <code class="docutils literal notranslate"><span class="pre">Wire</span> <span class="pre">Discretisation</span></code> for <strong>Algorithm</strong></p></li>
<li><p>Find the cogwheel symbol behind the <strong>Hypothesis</strong> field and click on it to construct hypotheses for <strong>Number of Segments</strong>.</p></li>
<li><p>In the <strong>Hypothesis Construction</strong> popup window:</p>
<ul>
<li><p>Define <strong>Name</strong> as <code class="docutils literal notranslate"><span class="pre">Segments_10</span></code></p></li>
<li><p>Set <strong>Number of Segments</strong> to <code class="docutils literal notranslate"><span class="pre">10</span></code></p></li>
<li><p>Set <strong>Type of distribution</strong> to <code class="docutils literal notranslate"><span class="pre">Equidistant</span> <span class="pre">distribution</span></code>.</p></li>
</ul>
</li>
</ul>
</li>
<li><p>Back in the <strong>Create Mesh</strong> window, set the just created <em>Segments10</em> as <strong>Hypothesis</strong>.</p></li>
<li><p>Click on <strong>Apply</strong> in the <strong>Create sub-mesh</strong> popup window, which will remain open for the definition of the three other boundary edge’s meshes.</p></li>
</ul>
<div class="figure align-default" id="id2">
<img alt="telemac salome submesh create number of segments hypothesis" src="../_images/mes-05-create-submesh-hypo.png" />
<p class="caption"><span class="caption-number">Fig. 61 </span><span class="caption-text"><code class="docutils literal notranslate"> </code>{figure} …/img/salome/mes-06-create-submesh-seg10us.png
:alt: telemac salome submesh create wire discretisation</span><a class="headerlink" href="#id2" title="Permalink to this image">¶</a></p>
</div>
<p><strong>Repeat</strong> the above steps for creating sub-meshes for the downstream, left wall, and right wall edges, but with different construction hypotheses.</p>
<ul class="simple">
<li><p>For the downstream sub-mesh use <strong>Name</strong> <code class="docutils literal notranslate"><span class="pre">downstream</span></code> and construct the following hypothesis:</p>
<ul>
<li><p>Type: <strong>Number of Segments</strong></p></li>
<li><p>Define <strong>Name</strong> as <code class="docutils literal notranslate"><span class="pre">Segments_05</span></code></p></li>
<li><p>Set <strong>Number of Segments</strong> to <code class="docutils literal notranslate"><span class="pre">5</span></code></p></li>
<li><p>Set <strong>Type of distribution</strong> to  <code class="docutils literal notranslate"><span class="pre">Equidistant</span> <span class="pre">distribution</span></code>.</p></li>
</ul>
</li>
<li><p>For the left wall sub-mesh use <strong>Name</strong> <code class="docutils literal notranslate"><span class="pre">leftwall</span></code> and construct the following hypothesis:</p>
<ul>
<li><p>Type: <strong>Arithmetic Progression 1D</strong></p></li>
<li><p>Define <strong>Name</strong> as <code class="docutils literal notranslate"><span class="pre">Arithmetic1d10_30</span></code></p></li>
<li><p>Set <strong>Start length</strong> to <code class="docutils literal notranslate"><span class="pre">10</span></code></p></li>
<li><p>Set <strong>End length</strong> to <code class="docutils literal notranslate"><span class="pre">30</span></code>.</p></li>
</ul>
</li>
</ul>
<div class="figure align-default">
<img alt="telemac salome submesh create arithmetic progression hypothesis" src="../_images/mes-09-create-submesh-hypoarith1030.png" />
</div>
<div class="figure align-default">
<img alt="telemac salome submesh create wire discretisation arithmetic" src="../_images/mes-10-create-submesh-arith1030lw.png" />
</div>
<ul class="simple">
<li><p>For the right wall sub-mesh use <strong>Name</strong> <code class="docutils literal notranslate"><span class="pre">rightwall</span></code> and construct the following hypothesis:</p>
<ul>
<li><p>Type: <strong>Arithmetic Progression 1D</strong></p></li>
<li><p>Define <strong>Name</strong> as <code class="docutils literal notranslate"><span class="pre">Arithmetic1d15_10</span></code></p></li>
<li><p>Set <strong>Start length</strong> to <code class="docutils literal notranslate"><span class="pre">15</span></code></p></li>
<li><p>Set <strong>End length</strong> to <code class="docutils literal notranslate"><span class="pre">10</span></code>.</p></li>
</ul>
</li>
</ul>
<p>To this end, the <em>Object Browser</em> should include the 5 hypotheses and the non-computed meshes (warning triangles in the below figure indicating the <em>Compute</em> menu).</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Save the project by clicking on the disk symbol.</p>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>If info or warning windows pops up and asks for defining the order to apply, that means the geometry groups contain too many elements. In this case, go back to the <a class="reference external" href="#geo2d">geometry creation</a> and make sure that always only one element is added per group. For more complex models, the order of mesh hypotheses may not be an error, but in this simple case it must not appear being an issue.</p>
</div>
</div>
<div class="section" id="compute-mesh">
<h3>Compute Mesh<a class="headerlink" href="#compute-mesh" title="Permalink to this headline">¶</a></h3>
<p>In the <strong>Object Browser</strong>, extend (un-collapse) the new <em>Mesh</em> block, <strong>right-click</strong> on <strong>Mesh_Hn_1</strong>, and select <strong>Compute</strong>.</p>
<div class="figure align-default">
<img alt="telemac salome compute mesh menu" src="../_images/mes-13-start-compute.png" />
</div>
<p>This will automatically also compute all sub-meshes. After the successful computation of the mesh, <em>SALOME-HYDRO</em> informs about the mesh properties in a popup window.</p>
<div class="figure align-default">
<img alt="smesh compute netgen 2d 3d" src="../_images/mes-14-end-compute.png" />
</div>
<p>In the view port (<em>VTK scene</em> tab), find the <strong>-OZ</strong> button to switch to plane view. If the mesh is not visible even though the computation was successful, right-click on the mesh in the <em>Object Browser</em> and click on <strong>Show</strong>.</p>
<div class="figure align-default">
<img alt="smesh show only" src="../_images/mes-15-gotoOZ.png" />
</div>
</div>
<div class="section" id="verify-mesh">
<h3>Verify Mesh<a class="headerlink" href="#verify-mesh" title="Permalink to this headline">¶</a></h3>
<p><em><strong>Orientation of faces and volumes</strong></em></p>
<p>This step will ensure that the mesh is correctly oriented for the simulation with <em>Telemac3d</em>. In the <em>Object Browser</em>, highlight <em>Mesh_Hn_1</em> and then go to the <strong>Modification</strong> top menu &gt; <strong>Orientation</strong>. In the pop-up window, check the <strong>Apply to all</strong> box. Click the <strong>Apply and close</strong> button. The mesh should have changed from darker blue to a lighter tone of blue (if the inverse is the case, repeat the application of the orientation tool).</p>
<div class="figure align-default">
<img alt="mesh modification orientation" src="../_images/mes-16-mod-orient.png" />
</div>
<p><em><strong>Identify and reconcile over-constraint elements</strong></em></p>
<p>In the <em>Object Browser</em>, <strong>highlight <em>Mesh_Hn_1</em></strong>. Then go to the <strong>Controls</strong> top menu &gt; <strong>Face Controls</strong> &gt; <strong>Over-constraint faces</strong>. Over-constrained triangles in the <em>Mesh_Hn_1</em> will turn red in the viewport (<em>VTK scene:1</em>) and at the bottom of the viewport, the note <em>Over-constrained faces: 3</em> will appear.</p>
<div class="figure align-default">
<img alt="mesh over constrained constraint faces" src="../_images/mes-17-mod-over-const.png" />
</div>
<p>To reconcile the edge cause the triangle’s over-constrain, go to the <strong>Modification</strong> top menu &gt; <strong>Diagonal inversion</strong>, and select the internal edge of the concerned triangles.</p>
<div class="figure align-default">
<img alt="mesh over-constrained diagonal inversion internal edges triangle" src="../_images/mes-18-mod-over-const-edge-select.png" />
</div>
<p>Over-constrained triangles might be hidden by the axes arrows in the corner. Thus, pay attention to sufficiently zoom into the corner unless the <em>Over-constrained faces</em> notification in the viewport shows <strong>0</strong>.</p>
<div class="figure align-default">
<img alt="mesh over-constrained diagonal inversion hidden edges faces" src="../_images/mes-19-mod-over-const-edge-hidden.png" />
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Save the project by clicking on the disk symbol.</p>
</div>
</div>
</div>
<div class="section" id="export-med-file">
<span id="med-export"></span><h2>Export MED File<a class="headerlink" href="#export-med-file" title="Permalink to this headline">¶</a></h2>
<p>Exporting the mesh to a MED file requires the definition of mesh groups. To do so, highlight <em>Mesh_Hn_1</em> in the object browser and right-click on it. Select <strong>Create Groups from Geometry</strong> from the mesh context menu.</p>
<div class="figure align-default">
<img alt="mesh export create groups context menu" src="../_images/mes-20-create-group-menu.png" />
</div>
<p>In the popup window, select all groups and sub shapes of the <em>FLUME</em> geometry and all groups of <strong>mesh elements</strong> and <strong>mesh nodes</strong>. For selecting multiple geometries, hold down the <code class="docutils literal notranslate"><span class="pre">CTRL</span></code> (<code class="docutils literal notranslate"><span class="pre">Strg</span></code>) and <code class="docutils literal notranslate"><span class="pre">Shift</span></code> keys on the keyboard and select the geometry/mesh groups. The tool will automatically add all nodes selected. Press <strong>Apply and close</strong> to finalize the creation of groups.</p>
<div class="figure align-default">
<img alt="mesh export create groups select" src="../_images/mes-21-create-group.png" />
</div>
<p>Verify the created groups by right-clicking on the top of the project tree in the <em>Object Browser</em> and selecting <em>Show only</em> with the option <em>Auto Color</em>.</p>
<div class="figure align-default">
<img alt="mesh export create groups final control" src="../_images/mes-21-final-groups.png" />
</div>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>Make sure that every group element is unique within every group. If an element appears twice in one group, the next step (export mesh) will through a warning message about double-defined group elements, which will lead to an error later.</p>
</div>
<p>If the groups seems correct (see above figure), export them with <strong>File</strong> (top menu) &gt; <strong>Export</strong> &gt; <strong>MED</strong>.</p>
<div class="figure align-default">
<img alt="mesh export med context menu" src="../_images/mes-22-export-med-menu.png" />
</div>
<p>In the <strong>Export mesh</strong> popup window, define:</p>
<ul class="simple">
<li><p><strong>File name</strong> <code class="docutils literal notranslate"><span class="pre">Mesh_Hn_1</span></code> (or whatever you prefer)</p></li>
<li><p><strong>Files of type</strong> <code class="docutils literal notranslate"><span class="pre">MED</span> <span class="pre">4.1</span> <span class="pre">files</span></code> <br><em>Note: The installation of <em>TELEMAC</em> described in the <a class="reference external" href="../get-started/telemac.html#med-hdf">installation section</a> requires to use <strong><code class="docutils literal notranslate"><span class="pre">MED</span> <span class="pre">3.2</span> <span class="pre">files</span></code></strong>.</em></p></li>
<li><p>Choose a convenient directory (<em>Quick path</em>) for saving the <em>MED</em> file</p></li>
<li><p>Leave all other default settings.</p></li>
<li><p>Click on <strong>Save</strong> to save the <em>MED</em> file.</p></li>
</ul>
<div class="figure align-default">
<img alt="telemac salome save med file" src="../_images/mes-23-export-med.png" />
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Save the project by clicking on the disk symbol.</p>
</div>
</div>
<div class="section" id="generate-boundary-conditions">
<h2>Generate Boundary Conditions<a class="headerlink" href="#generate-boundary-conditions" title="Permalink to this headline">¶</a></h2>
<div class="section" id="basic-setup-with-the-hydrosolver-module">
<h3>Basic Setup with the HydroSolver Module<a class="headerlink" href="#basic-setup-with-the-hydrosolver-module" title="Permalink to this headline">¶</a></h3>
<p>Activate the <strong>HydroSolver</strong> module from the top menu and click on the <em>Edit boundary conditions file</em> button to create a new boundary condition file.</p>
<div class="figure align-default">
<img alt="telemac salome hydrosolver create edit boundary conditions menu" src="../_images/hs01-edit-bc.png" />
</div>
<p>In the opening popup window, select the just exported <strong>MED</strong> file containing the mesh and leave the <em>Boundary conditions file</em> field in the <em>Input files</em> frame free. In the <strong>Output files</strong> frame, click on <strong>…</strong> and define a boundary conditions file (e.g., <code class="docutils literal notranslate"><span class="pre">flume3d_bc.bnd</span></code>).</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Make sure that all model files (<em>MED</em>, <em>BND</em>, and others such as the later defined <em>CAS</em> file) are all located in the same folder.</p>
</div>
<p>Make the following definitions in the <strong>Boundary conditions</strong> frame (table):</p>
<ul class="simple">
<li><p>Group <strong>Hydrodynamic_wetted_contour_Outer</strong>: Set <strong>Preset</strong> to <strong>Custom</strong> and all values to <code class="docutils literal notranslate"><span class="pre">0</span></code></p></li>
<li><p>Group <strong>downstream</strong>: Set <strong>Preset</strong> to <strong>Prescribed H / free T</strong></p></li>
<li><p>Group <strong>leftwall</strong>: Set <strong>Preset</strong> to <strong>Closed boundaries/walls</strong></p></li>
<li><p>Group <strong>rightwall</strong>: Set <strong>Preset</strong> to <strong>Closed boundaries/walls</strong></p></li>
<li><p>Group <strong>upstream</strong>: Set <strong>Preset</strong> to <strong>Prescribed Q / free T</strong></p></li>
</ul>
<div class="figure align-default">
<img alt="telemac salome hydrosolver create edit boundary conditions" src="../_images/hs02-create-bc.png" />
</div>
<p>Then click on <strong>Apply and Close</strong>.</p>
</div>
<div class="section" id="modify-the-boundary-file">
<span id="bnd-mod"></span><h3>Modify the Boundary File<a class="headerlink" href="#modify-the-boundary-file" title="Permalink to this headline">¶</a></h3>
<p>The boundary file created with the <em>HydroSolver</em> involves a couple of issues that need to be resolved to enable <em>TELEMAC</em> assigning the correct boundary conditions. For this purpose, open the boundary condition file in a text editor (e.g., on <em>Xfce</em> desktop use right-click &gt; <em>mousepad</em>) and make the following adaptations.</p>
<ul class="simple">
<li><p>Only 4 edge boundaries are needed:</p>
<ul>
<li><p>Set the single number in the first line to <code class="docutils literal notranslate"><span class="pre">4</span></code></p></li>
<li><p>Remove the entire line (2) describing  Group <strong>Hydrodynamic_wetted_contour_Outer</strong></p></li>
</ul>
</li>
<li><p>To enable the coherent use of flow rates for liquid boundaries, make sure that:</p>
<ul>
<li><p>Line 2 defines <code class="docutils literal notranslate"><span class="pre">LIHBOR</span></code> with <code class="docutils literal notranslate"><span class="pre">5</span></code> (prescribed depth), <code class="docutils literal notranslate"><span class="pre">LIUBOR</span></code> and <code class="docutils literal notranslate"><span class="pre">LIVBOR</span></code> with <code class="docutils literal notranslate"><span class="pre">4</span></code> (free velocity), and <code class="docutils literal notranslate"><span class="pre">LITBOR</span></code> with <code class="docutils literal notranslate"><span class="pre">4</span></code> (free tracer) for the <strong>downstream</strong> boundary edge.</p></li>
<li><p>Line 3 defines <code class="docutils literal notranslate"><span class="pre">LIHBOR</span></code> with <code class="docutils literal notranslate"><span class="pre">4</span></code> (free depth), <code class="docutils literal notranslate"><span class="pre">LIUBOR</span></code> and <code class="docutils literal notranslate"><span class="pre">LIVBOR</span></code> with <code class="docutils literal notranslate"><span class="pre">5</span></code> (prescribed flow rate), and <code class="docutils literal notranslate"><span class="pre">LITBOR</span></code> with <code class="docutils literal notranslate"><span class="pre">4</span></code> (free tracer) for the <strong>upstream</strong> boundary edge. Note that the line needs to be copied from the bottom to the top when using the <em>bnd</em> file created with the <em>HydroSolver</em> module.</p></li>
</ul>
</li>
<li><p>Assign wall friction (i.e., zero velocities) to the left and right wall edges:</p>
<ul>
<li><p>In Line 4, set <code class="docutils literal notranslate"><span class="pre">LIUBOR</span></code> and <code class="docutils literal notranslate"><span class="pre">LIVBOR</span></code> to <code class="docutils literal notranslate"><span class="pre">0</span></code> (zero <em>U</em> and <em>V</em> velocities, respectively) for the <strong>leftwall</strong> boundary edge.</p></li>
<li><p>In Line 5, set <code class="docutils literal notranslate"><span class="pre">LIUBOR</span></code> and <code class="docutils literal notranslate"><span class="pre">LIVBOR</span></code> to <code class="docutils literal notranslate"><span class="pre">0</span></code> (zero <em>U</em> and <em>V</em> velocities, respectively) for the <strong>rightwall</strong> boundary edge.</p></li>
</ul>
</li>
</ul>
<p>The boundary file should now resemble the block below (can also be downloaded <a class="reference external" href="https://raw.githubusercontent.com/Ecohydraulics/telemac-helpers/master/model-templates/flume3d_bc.bnd">here</a>). Save and close the <em>bnd</em> file.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="mi">4</span>
<span class="mi">5</span> <span class="mi">4</span> <span class="mi">4</span> <span class="mi">4</span> <span class="n">downstream</span>
<span class="mi">4</span> <span class="mi">5</span> <span class="mi">5</span> <span class="mi">4</span> <span class="n">upstream</span>
<span class="mi">2</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">2</span> <span class="n">leftwall</span>
<span class="mi">2</span> <span class="mi">0</span> <span class="mi">0</span> <span class="mi">2</span> <span class="n">rightwall</span>

</pre></div>
</div>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p><em>SLF</em> geometry files require more complex (node-wise) definitions of boundaries, which need to be setup with <a class="reference external" href="../get-started/telemac.html#bluekenue"><em>BlueKenue<sup>TM</sup></em></a> and <a class="reference external" href="../get-started/telemac.html#fudaa"><em>Fudaa-PrePro</em></a>.</p>
</div>
</div>
</div>
<div class="section" id="create-simulation-case-cas">
<h2>Create Simulation Case (CAS)<a class="headerlink" href="#create-simulation-case-cas" title="Permalink to this headline">¶</a></h2>
<p>The <em>CAS</em> (<code class="docutils literal notranslate"><span class="pre">.cas</span></code>) file is the control (or <em>steering</em>) file for any <em>TELEMAC</em> simulation and links all model parameters. This section guides through setting up a simple <em>CAS</em> file for <em>Telemac3d</em> simulations either manually based on a template or with the <em>HydroSolver module</em> in <em>SALOME-HYDRO</em>. Because of program instabilities and incoherent linking of file names (directories) in <em>SALOME-HYDRO</em>, it is recommended to work with the manual CAS file setup (or with Fudaa PrePro).</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Copy a sample case from the <em>TELEMAC</em> folder (<em>/telemac/v8p2/examples/telemac3d/</em>) and edit it for convenience.</p>
</div>
<div class="admonition-windows admonition">
<p class="admonition-title">Windows</p>
<p>The <em>CAS</em> file can also be edited/created with <a class="reference external" href="../get-started/telemac.html#fudaa">Fudaa PrePro</a> - or any text editor software -  for use with <em>Salome-Hydro</em> on a <em>Linux</em> system later.</p>
</div>
<div class="section" id="overview-manual-cas-file-setup-recommended">
<h3>Overview: Manual CAS File Setup (Recommended)<a class="headerlink" href="#overview-manual-cas-file-setup-recommended" title="Permalink to this headline">¶</a></h3>
<p>The following CAS template uses the following input files:</p>
<ul class="simple">
<li><p>The boundary condition file named <code class="docutils literal notranslate"><span class="pre">flume3d_bc.bnd</span></code> (see <a class="reference external" href="#bnd-mod">boundary file section</a></p></li>
<li><p>The geometry <em>MED</em> file <code class="docutils literal notranslate"><span class="pre">Mesh_Hn_1.med</span></code> (see <a class="reference external" href="#med-export">med file export section</a></p></li>
<li><p>Do <strong>not include any directory names</strong> (file paths) and make sure that <strong>all model files are in the same folder</strong>.</p></li>
</ul>
<p>The CAS file defines a steady, hydrodynamic model with an inflow rate of 50 m<sup>3</sup>/s (prescribed upstream flow rate boundary) and an outflow depth of 2 m (prescribed downstream elevation). The simulation uses 5 vertical layers that constitute a numerical grid of prisms. 3d outputs of <em>U</em> (<em>x</em>-direction), <em>V</em> (<em>y</em>-direction), and <em>W</em> (<em>z</em>-direction) velocities, as well as the elevation <em>Z</em>, are written to a file named <code class="docutils literal notranslate"><span class="pre">r3d_canal-t3d.med</span></code>. 2d outputs of depth-averaged <em>U</em> velocity (<em>x</em>-direction), depth-averaged <em>V</em> velocity (<em>y</em>-direction), and water depth <em>h</em> are written to a file named <code class="docutils literal notranslate"><span class="pre">r2d3d_canal-t3d.med</span></code>.</p>
<p>The below code block shows the steering file <code class="docutils literal notranslate"><span class="pre">t3d_flume.cas</span></code> and details for every parameter are provided after the code block. The <code class="docutils literal notranslate"><span class="pre">\</span></code> escape character comments out lines (i.e., <em>TELEMAC</em> will ignore anything in a line the <code class="docutils literal notranslate"><span class="pre">\</span></code> character). The <code class="docutils literal notranslate"><span class="pre">:</span></code> character separates <code class="docutils literal notranslate"><span class="pre">VARIABLE</span> <span class="pre">NAME</span></code> and <code class="docutils literal notranslate"><span class="pre">VALUE</span></code>s. Alternatively to the <code class="docutils literal notranslate"><span class="pre">:</span></code>, also a <code class="docutils literal notranslate"><span class="pre">=</span></code> sign may be used. The <code class="docutils literal notranslate"><span class="pre">&amp;ETA</span></code> at the end of the file makes <em>TELEMAC</em> printing out a list of keywords applied (in the <em>DAMOCLES</em> routine).</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>To facilitate setting up the steering (CAS) file for this tutorial, <a class="reference external" href="https://raw.githubusercontent.com/Ecohydraulics/telemac-helpers/master/model-templates/t3d_template.cas">download the template</a> (right-click on the link &gt; <em>Save Link As…</em> &gt; navigate to the local tutorial folder), which contains more descriptions and options for simulation parameters.</p>
</div>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="o">/</span> <span class="n">t3d_flume</span><span class="p">.</span><span class="n">cas</span>
<span class="o">/------------------------------------------------------------------/</span>
<span class="o">/</span>			<span class="n">COMPUTATION</span> <span class="n">ENVIRONMENT</span>
<span class="o">/------------------------------------------------------------------/</span>
<span class="n">TITLE</span> <span class="p">:</span> <span class="s1">&#39;TELEMAC 3D FLUME&#39;</span>
<span class="n">MASS</span><span class="o">-</span><span class="n">BALANCE</span> <span class="p">:</span> <span class="n">YES</span>
<span class="o">/</span>
<span class="n">BOUNDARY</span> <span class="n">CONDITIONS</span> <span class="k">FILE</span> <span class="p">:</span> <span class="n">flume3d_bc</span><span class="p">.</span><span class="n">bnd</span>
<span class="n">GEOMETRY</span> <span class="k">FILE</span>            <span class="p">:</span> <span class="n">Mesh_Hn_1</span><span class="p">.</span><span class="n">med</span>
<span class="n">GEOMETRY</span> <span class="k">FILE FORMAT</span> 	 <span class="p">:</span> <span class="s1">&#39;MED&#39;</span>
<span class="mi">3</span><span class="n">D</span> <span class="k">RESULT FILE</span>           <span class="p">:</span> <span class="n">r3d_canal</span><span class="o">-</span><span class="n">t3d</span><span class="p">.</span><span class="n">med</span>
<span class="mi">3</span><span class="n">D</span> <span class="k">RESULT FILE FORMAT</span>    <span class="p">:</span> <span class="s1">&#39;MED&#39;</span>
<span class="mi">2</span><span class="n">D</span> <span class="k">RESULT FILE</span>           <span class="p">:</span> <span class="n">r2d3d_canal</span><span class="o">-</span><span class="n">t3d</span><span class="p">.</span><span class="n">med</span>
<span class="mi">2</span><span class="n">D</span> <span class="k">RESULT FILE FORMAT</span>    <span class="p">:</span> <span class="s1">&#39;MED&#39;</span>
<span class="o">/</span>
<span class="n">VARIABLES</span> <span class="n">FOR</span> <span class="mi">2</span><span class="n">D</span> <span class="n">GRAPHIC</span> <span class="n">PRINTOUTS</span> <span class="p">:</span> <span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">H</span>
<span class="n">VARIABLES</span> <span class="n">FOR</span> <span class="mi">3</span><span class="n">D</span> <span class="n">GRAPHIC</span> <span class="n">PRINTOUTS</span> <span class="p">:</span> <span class="n">Z</span><span class="p">,</span><span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">W</span>
<span class="o">/</span>
<span class="o">/------------------------------------------------------------------/</span>
<span class="o">/</span>			<span class="n">GENERAL</span> <span class="n">PARAMETERS</span>
<span class="o">/------------------------------------------------------------------/</span>
<span class="nb">TIME </span><span class="n">STEP</span> <span class="p">:</span> <span class="mf">1.</span>
<span class="n">NUMBER</span> <span class="n">OF</span> <span class="nb">TIME </span><span class="n">STEPS</span> <span class="p">:</span> <span class="mi">5000</span>
<span class="n">GRAPHIC</span> <span class="n">PRINTOUT</span> <span class="n">PERIOD</span> <span class="p">:</span> <span class="mi">100</span>
<span class="n">LISTING</span> <span class="n">PRINTOUT</span> <span class="n">PERIOD</span> <span class="p">:</span> <span class="mi">100</span>
<span class="o">/</span>
<span class="o">/------------------------------------------------------------------/</span>
<span class="o">/</span>			<span class="n">VERTICAL</span>
<span class="o">/------------------------------------------------------------------/</span>
<span class="o">/</span> <span class="n">vertical</span> <span class="n">cell</span> <span class="n">height</span> <span class="n">defined</span> <span class="n">by</span> <span class="n">initial</span> <span class="n">condition</span> <span class="n">x</span> <span class="n">no</span><span class="p">.</span> <span class="n">of</span> <span class="n">levels</span>
<span class="o">/</span> <span class="n">default</span> <span class="nb">and </span><span class="n">minimum</span> <span class="k">is </span><span class="mi">2</span><span class="p">,</span> <span class="n">upward</span> <span class="n">vertical</span> <span class="n">direction</span>
<span class="n">NUMBER</span> <span class="n">OF</span> <span class="n">HORIZONTAL</span> <span class="n">LEVELS</span> <span class="p">:</span> <span class="mi">5</span>
<span class="o">/</span>
<span class="o">/------------------------------------------------------------------/</span>
<span class="o">/</span>			<span class="n">NUMERICAL</span> <span class="n">PARAMETERS</span>
<span class="o">/------------------------------------------------------------------/</span>
<span class="o">/</span>
<span class="o">/</span> <span class="n">CONVECTION</span><span class="o">-</span><span class="n">DIFFUSION</span>
<span class="o">/------------------------------------------------------------------</span>
<span class="n">SCHEME</span> <span class="n">FOR</span> <span class="n">ADVECTION</span> <span class="n">OF</span> <span class="n">VELOCITIES</span> <span class="p">:</span> <span class="mi">5</span>
<span class="n">SCHEME</span> <span class="n">FOR</span> <span class="n">ADVECTION</span> <span class="n">OF</span> <span class="n">K</span><span class="o">-</span><span class="nb">EPSILON</span> <span class="p">:</span> <span class="mi">5</span>
<span class="n">SCHEME</span> <span class="n">FOR</span> <span class="n">ADVECTION</span> <span class="n">OF</span> <span class="n">TRACERS</span> <span class="p">:</span> <span class="mi">5</span>
<span class="o">/</span> <span class="n">scheme</span> <span class="k">options</span> <span class="o">-</span> <span class="k">use </span><span class="mi">2</span> <span class="n">for</span> <span class="n">disabling</span> <span class="n">tidal</span> <span class="n">flats</span> <span class="nb">and </span><span class="n">increase</span> <span class="n">speed</span>
<span class="n">SCHEME</span> <span class="n">OPTION</span> <span class="n">FOR</span> <span class="n">ADVECTION</span> <span class="n">OF</span> <span class="n">VELOCITIES</span> <span class="p">:</span> <span class="mi">4</span>
<span class="n">SCHEME</span> <span class="n">OPTION</span> <span class="n">FOR</span> <span class="n">ADVECTION</span> <span class="n">OF</span> <span class="n">K</span><span class="o">-</span><span class="nb">EPSILON</span> <span class="p">:</span> <span class="mi">4</span>
<span class="n">SCHEME</span> <span class="n">OPTION</span> <span class="n">FOR</span> <span class="n">ADVECTION</span> <span class="n">OF</span> <span class="n">TRACERS</span> <span class="p">:</span> <span class="mi">4</span>
<span class="o">/</span>
<span class="n">SUPG</span> <span class="n">OPTION</span> <span class="p">:</span> <span class="mi">2</span><span class="p">;</span><span class="mi">2</span><span class="p">;</span><span class="mi">2</span><span class="p">;</span><span class="mi">2</span>  <span class="o">/</span> <span class="n">classic</span> <span class="n">supg</span> <span class="n">for</span> <span class="n">U</span> <span class="nb">and </span><span class="n">V</span>  <span class="n">see</span> <span class="n">docs</span> <span class="n">sec</span> <span class="mf">6.2</span><span class="p">.</span><span class="mi">2</span>
<span class="o">/</span>
<span class="o">/</span> <span class="n">PROPAGATION</span> <span class="n">HEIGHT</span> <span class="nb">AND </span><span class="n">STABILITY</span>
<span class="o">/</span> <span class="o">------------------------------------------------------------------</span>
<span class="n">IMPLICITATION</span> <span class="n">FOR</span> <span class="n">DEPTH</span> <span class="p">:</span> <span class="mf">0.55</span> <span class="o">/</span> <span class="n">should</span> <span class="n">be</span> <span class="n">between</span> <span class="mf">0.55</span> <span class="nb">and </span><span class="mf">0.6</span>
<span class="n">IMPLICITATION</span> <span class="n">FOR</span> <span class="n">VELOCITIES</span> <span class="p">:</span> <span class="mf">0.55</span> <span class="o">/</span> <span class="n">should</span> <span class="n">be</span> <span class="n">between</span> <span class="mf">0.55</span> <span class="nb">and </span><span class="mf">0.6</span>
<span class="n">IMPLICITATION</span> <span class="n">FOR</span> <span class="n">DIFFUSION</span> <span class="p">:</span> <span class="mf">1.</span>
<span class="n">FREE</span> <span class="n">SURFACE</span> <span class="n">GRADIENT</span> <span class="n">COMPATIBILITY</span> <span class="p">:</span> <span class="mf">0.1</span>  <span class="o">/</span> <span class="n">default</span> <span class="mf">1.</span>
<span class="o">/</span>
<span class="o">/------------------------------------------------------------------/</span>
<span class="o">/</span>			<span class="n">HYDRODYNAMICS</span>
<span class="o">/------------------------------------------------------------------/</span>
<span class="o">/</span>
<span class="o">/</span> <span class="n">HYDRODYNAMIC</span> <span class="n">SOLVER</span>
<span class="o">/------------------------------------------------------------------</span>
<span class="n">NON</span><span class="o">-</span><span class="n">HYDROSTATIC</span> <span class="n">VERSION</span> <span class="p">:</span> <span class="n">YES</span> <span class="o">/</span> <span class="k">use </span><span class="n">default</span> <span class="n">solver</span> <span class="n">number</span> <span class="mi">7</span> <span class="p">(</span><span class="n">GMRES</span><span class="p">)</span>
<span class="n">MAXIMUM</span> <span class="n">NUMBER</span> <span class="n">OF</span> <span class="n">ITERATIONS</span> <span class="n">FOR</span> <span class="n">DIFFUSION</span> <span class="n">OF</span> <span class="n">VELOCITIES</span> <span class="p">:</span> <span class="mi">100</span> <span class="o">/</span> <span class="n">default</span> <span class="k">is </span><span class="mi">60</span>
<span class="o">/</span>
<span class="o">/</span> <span class="n">BOUNDARY</span> <span class="n">CONDITIONS</span>
<span class="o">/------------------------------------------------------------------</span>
<span class="o">/</span> <span class="k">Use </span><span class="n">Nikuradse</span> <span class="n">roughness</span> <span class="n">law</span> <span class="o">-</span> <span class="k">all </span><span class="n">others</span> <span class="n">are</span> <span class="nb">not </span><span class="mi">3</span><span class="n">D</span> <span class="n">compatible</span>
<span class="n">LAW</span> <span class="n">OF</span> <span class="n">BOTTOM</span> <span class="n">FRICTION</span> <span class="p">:</span> <span class="mi">5</span>
<span class="n">LAW</span> <span class="n">OF</span> <span class="n">FRICTION</span> <span class="n">ON</span> <span class="n">LATERAL</span> <span class="n">BOUNDARIES</span> <span class="p">:</span> <span class="mi">5</span>  <span class="o">/</span> <span class="n">for</span> <span class="n">natural</span> <span class="n">banks</span> <span class="o">-</span> <span class="mi">0</span> <span class="n">for</span> <span class="n">symmetry</span>
<span class="n">FRICTION</span> <span class="n">COEFFICIENT</span> <span class="n">FOR</span> <span class="n">THE</span> <span class="n">BOTTOM</span> <span class="p">:</span> <span class="mf">0.1</span> <span class="o">/</span> <span class="mi">3</span> <span class="n">times</span> <span class="n">d90</span> <span class="n">according</span> <span class="n">to</span> <span class="n">van</span> <span class="n">Rijn</span>
<span class="o">/</span>
<span class="o">/</span> <span class="n">Liquid</span> <span class="n">boundaries</span>
<span class="n">PRESCRIBED</span> <span class="n">FLOWRATES</span>  <span class="p">:</span> <span class="mi">5</span><span class="mf">0.</span><span class="p">;</span><span class="mi">5</span><span class="mf">0.</span>
<span class="n">PRESCRIBED</span> <span class="n">ELEVATIONS</span> <span class="p">:</span> <span class="mf">2.</span><span class="p">;</span><span class="mf">0.</span>
<span class="o">/</span>
<span class="o">/</span> <span class="n">INITIAL</span> <span class="n">CONDITIONS</span>
<span class="o">/</span> <span class="o">------------------------------------------------------------------</span>
<span class="n">INITIAL</span> <span class="n">CONDITIONS</span> <span class="p">:</span> <span class="s1">&#39;CONSTANT ELEVATION&#39;</span>
<span class="n">INITIAL</span> <span class="n">ELEVATION</span> <span class="p">:</span> <span class="mi">50</span> <span class="o">/</span> <span class="n">corresponds</span> <span class="n">to</span> <span class="n">depth</span> <span class="n">here</span> <span class="o">-</span> <span class="nb">not </span><span class="n">so</span> <span class="n">in</span> <span class="n">the</span> <span class="n">boundary</span> <span class="k">file</span>
<span class="n">INITIAL</span> <span class="n">GUESS</span> <span class="n">FOR</span> <span class="n">DEPTH</span> <span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="kt">INTEGER </span><span class="n">for</span> <span class="n">speeding</span> <span class="n">up</span> <span class="n">calculations</span>
<span class="o">/</span>
<span class="o">/</span> <span class="k">Type </span><span class="n">of</span> <span class="n">velocity</span> <span class="n">profile</span> <span class="n">can</span> <span class="n">be</span> <span class="mi">0</span><span class="o">-</span><span class="n">user</span> <span class="n">defined</span><span class="p">)</span> <span class="mi">1</span><span class="o">-</span><span class="n">constant</span> <span class="p">(</span><span class="n">default</span><span class="p">),</span> <span class="mi">2</span><span class="o">-</span><span class="nb">Log</span>
<span class="n">VELOCITY</span> <span class="n">PROFILE</span> <span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">horizontal</span> <span class="n">profile</span>
<span class="n">VELOCITY</span> <span class="n">VERTICAL</span> <span class="n">PROFILES</span> <span class="p">:</span> <span class="mi">2</span><span class="p">;</span><span class="mi">2</span>
<span class="o">/</span>
<span class="o">/------------------------------------------------------------------/</span>
<span class="o">/</span>			<span class="n">TURBULENCE</span>
<span class="o">/------------------------------------------------------------------/</span>
<span class="o">/</span> <span class="n">in</span> <span class="mi">3</span><span class="n">d</span> <span class="k">use </span><span class="mi">3</span><span class="o">-</span><span class="n">k</span><span class="o">-</span><span class="nb">epsilon </span><span class="n">model</span><span class="p">,</span> <span class="n">alternatively</span> <span class="mi">5</span><span class="o">-</span><span class="n">Spalart</span><span class="o">-</span><span class="n">Allmaras</span> <span class="nb">or </span><span class="mi">4</span><span class="o">-</span><span class="n">Smagorinsky</span> <span class="n">for</span> <span class="n">highly</span> <span class="n">non</span><span class="o">-</span><span class="n">linear</span> <span class="n">flow</span>
<span class="n">HORIZONTAL</span> <span class="n">TURBULENCE</span> <span class="n">MODEL</span> <span class="p">:</span> <span class="mi">3</span>
<span class="n">VERTICAL</span> <span class="n">TURBULENCE</span> <span class="n">MODEL</span> <span class="p">:</span> <span class="mi">3</span>
<span class="o">/</span>
<span class="p">&amp;</span><span class="n">ETA</span>
</pre></div>
</div>
</div>
<div class="section" id="computation-environment-a-name-comp-env-a">
<h3>Computation Environment <a name="comp-env"></a><a class="headerlink" href="#computation-environment-a-name-comp-env-a" title="Permalink to this headline">¶</a></h3>
<p>The computation environment defines a <strong>Title</strong> (e.g., <code class="docutils literal notranslate"><span class="pre">TELEMAC</span> <span class="pre">3D</span> <span class="pre">FLUME</span></code>). The most important parameters involve the <strong>input</strong> files:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">GEOMETRY</span> <span class="pre">FILE</span></code>: <code class="docutils literal notranslate"><span class="pre">Mesh_Hn_1.med</span></code> - alternatively, select a <em>serafin</em> (SLF) geometry file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Geometry</span> <span class="pre">file</span> <span class="pre">format</span></code>: <code class="docutils literal notranslate"><span class="pre">MED</span></code> - omit this parameter when use a <em>SLF</em> geometry file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">Boundary</span> <span class="pre">conditions</span> <span class="pre">file</span></code>: <code class="docutils literal notranslate"><span class="pre">flume3d_bc.bnd</span></code> - with a <em>SLF</em> file, use a <em>CLI</em> boundary file</p></li>
</ul>
<p>The <strong>output</strong> can be defined with the following keywords:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">3D</span> <span class="pre">RESULT</span> <span class="pre">FILE</span></code>: <code class="docutils literal notranslate"><span class="pre">r3d_canal.med</span></code> - can be either a <em>MED</em> file or a <em>SLF</em> file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2D</span> <span class="pre">RESULT</span> <span class="pre">FILE</span></code>: <code class="docutils literal notranslate"><span class="pre">r2d3d_canal.med</span></code> - can be either a <em>MED</em> file or a <em>SLF</em> file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">3D</span> <span class="pre">RESULT</span> <span class="pre">FILE</span> <span class="pre">FORMAT</span></code>: <code class="docutils literal notranslate"><span class="pre">'MED'</span></code> - can be omitted when using <em>SLF</em> output files</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2D</span> <span class="pre">RESULT</span> <span class="pre">FILE</span> <span class="pre">FORMAT</span></code>: <code class="docutils literal notranslate"><span class="pre">'MED'</span></code> - can be omitted when using <em>SLF</em> output files</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VARIABLES</span> <span class="pre">FOR</span> <span class="pre">3D</span> <span class="pre">GRAPHIC</span> <span class="pre">PRINTOUTS</span></code>:  <code class="docutils literal notranslate"><span class="pre">Z,U,V,W</span></code> - many more options can be found in section 3.12 of the <a class="reference external" href="http://ot-svn-public:telemac1*&#64;svn.opentelemac.org/svn/opentelemac/tags/v8p1r1/documentation/telemac3d/user/telemac3d_user_v8p1.pdf">Telemac 3d docs</a></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VARIABLES</span> <span class="pre">FOR</span> <span class="pre">2D</span> <span class="pre">GRAPHIC</span> <span class="pre">PRINTOUTS</span></code>:  <code class="docutils literal notranslate"><span class="pre">U,V,H</span></code> - many more options can be found in section 3.13 of the <a class="reference external" href="http://ot-svn-public:telemac1*&#64;svn.opentelemac.org/svn/opentelemac/tags/v8p1r1/documentation/telemac3d/user/telemac3d_user_v8p1.pdf">Telemac 3d docs</a></p></li>
</ul>
<p>In addition, the <code class="docutils literal notranslate"><span class="pre">MASS-BALANCE</span> <span class="pre">:</span> <span class="pre">YES</span></code> setting will printout the mass fluxes and errors in the computation region, which is an important parameter for verifying the plausibility of the model.</p>
</div>
<div class="section" id="general-parameters">
<h3>General Parameters<a class="headerlink" href="#general-parameters" title="Permalink to this headline">¶</a></h3>
<p>The <em>General parameters</em> specify <em>time</em> and <em>location</em> settings for the simulation:</p>
<ul class="simple">
<li><p><strong>Location</strong> can be used for geo-referencing of outputs (not to set in this tutorial).</p></li>
<li><p><strong>Time</strong>:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">TIME</span> <span class="pre">STEP</span></code>: <code class="docutils literal notranslate"><span class="pre">1.0</span></code> defines the time step as a multiple of graphic/listing printout periods.<br><em>Use small enough and sufficient time steps to achieve/increase computational stability and increase to yield computational efficiency.</em></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">NUMBER</span> <span class="pre">OF</span> <span class="pre">TIME</span> <span class="pre">STEPS</span></code>: <code class="docutils literal notranslate"><span class="pre">5000</span></code> defines the overall simulation length. <br><em>Limit the number of time steps to a minimum (e.g., until equilibrium conditions are reached in a steady simulation).</em></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GRAPHIC</span> <span class="pre">PRINTOUT</span> <span class="pre">PERIOD</span></code> : <code class="docutils literal notranslate"><span class="pre">100</span></code> time step at which graphic variables are written (in this example <code class="docutils literal notranslate"><span class="pre">5000</span></code> / (<code class="docutils literal notranslate"><span class="pre">100</span></code> · <code class="docutils literal notranslate"><span class="pre">1.0</span></code>) = 50 graphic printouts will be produced, i.e., every <code class="docutils literal notranslate"><span class="pre">100</span></code> · <code class="docutils literal notranslate"><span class="pre">1.0</span></code> = 100 seconds)</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LISTING</span> <span class="pre">PRINTOUT</span> <span class="pre">PERIOD</span></code>: <code class="docutils literal notranslate"><span class="pre">100</span></code> time step multiplier at which listing variables are printed (in this example, listings are printed every <code class="docutils literal notranslate"><span class="pre">100</span></code> · <code class="docutils literal notranslate"><span class="pre">1</span></code> = 100 seconds)</p></li>
</ul>
</li>
</ul>
<p>Modify the time parameters to examine the effect in the simulation later.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>Graphic printouts, just like all other data printouts, are time consuming and will slow down the simulation.</p>
</div>
</div>
<div class="section" id="vertical-3d-parameters">
<h3>Vertical (3d) Parameters<a class="headerlink" href="#vertical-3d-parameters" title="Permalink to this headline">¶</a></h3>
<p><em>Telemac3d</em> will add <em>Horizontal levels</em> (i.e., layers) that correspond to copies of the 2d-mesh to build a 3d-mesh of prisms (default) or tetrahedrons. These parameters can be defined with:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">NUMBER</span> <span class="pre">OF</span> <span class="pre">HORIZONTAL</span> <span class="pre">LEVELS</span></code>: <code class="docutils literal notranslate"><span class="pre">5</span></code> where the default and minimum is <code class="docutils literal notranslate"><span class="pre">2</span></code> and the horizontal levels point in upward vertical direction. The thickness of vertical layers results from the water depth, which can be user-defined through the <code class="docutils literal notranslate"><span class="pre">INITIAL</span> <span class="pre">ELEVATION</span></code> parameter (see <a class="reference external" href="#inc">initial conditions</a>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">MESH</span> <span class="pre">TRANSFORMATION</span></code>: <code class="docutils literal notranslate"><span class="pre">1</span></code> is the kind of level for the distribution (default is <code class="docutils literal notranslate"><span class="pre">1</span></code>, a homogenous sigma distribution). For unsteady simulations, set this value to <code class="docutils literal notranslate"><span class="pre">2</span></code> (or <code class="docutils literal notranslate"><span class="pre">0</span></code> - calcot) and implement a <code class="docutils literal notranslate"><span class="pre">ZSTAR</span></code> array in a user Fortran file (<code class="docutils literal notranslate"><span class="pre">USER_MESH_TRANSFORM</span></code> subroutine).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ELEMENT</span></code>: <code class="docutils literal notranslate"><span class="pre">'PRISM'</span></code> (default) and prisms can optionally split into tetrahedrons by settings this parameter to <code class="docutils literal notranslate"><span class="pre">'TETRAHEDRON'</span></code> (can potentially crash the simulation).</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>For unsteady simulations (time-variable inflow/outflow rates), pre-define the thickness of vertical layers with the <code class="docutils literal notranslate"><span class="pre">ZSTAR</span></code> parameter in a user Fortran file (subroutine) as described in section 4.1 of the <a class="reference external" href="http://ot-svn-public:telemac1*&#64;svn.opentelemac.org/svn/opentelemac/tags/v8p1r1/documentation/telemac3d/user/telemac3d_user_v8p1.pdf">Telemac 3d docs</a>.</p>
</div>
<p>To get started with writing subroutines (it is no magic neither), have a look at the <strong>bottom_bc</strong> example (<code class="docutils literal notranslate"><span class="pre">~/telemac/v8p2/examples/telemac3d/bottom_bc/</span></code>). In particular, examine the user fortran file <code class="docutils literal notranslate"><span class="pre">/user_fortran-source/user_mesh_transf.f</span></code> and its call in the steering file <code class="docutils literal notranslate"><span class="pre">t3d_bottom_source.cas</span></code> through the definition of the <code class="docutils literal notranslate"><span class="pre">FORTRAN</span> <span class="pre">FILE</span></code> keyword and setting of <code class="docutils literal notranslate"><span class="pre">MESH</span> <span class="pre">TRANSFORMATION</span> <span class="pre">=</span> <span class="pre">2</span></code>.</p>
</div>
<div class="section" id="numerical-parameters">
<h3>Numerical Parameters<a class="headerlink" href="#numerical-parameters" title="Permalink to this headline">¶</a></h3>
<p>This section defines internal numerical parameters for the <em>Advection</em> and <em>Diffusion</em> solvers, which are also sometimes listed in the section of <a class="reference external" href="#hydrodynamics">hydrodynamic parameters</a> in <em>TELEMAC</em> documentations.</p>
<p>In <em>Telemac3d</em>, it is recommended to use the so-called distributive predictor-corrector (PSI) scheme (<a class="reference external" href="https://henry.baw.de/bitstream/handle/20.500.11970/104314/13_Hervouet_2015.pdf?sequence=1&amp;isAllowed=y">read more</a> at the BAW’s hydraulic engineering repository) with local implication for tidal flats (for velocity, tracers, and k-epsilon):</p>
<ul class="simple">
<li><p>Set the PSI scheme:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">SCHEME</span> <span class="pre">FOR</span> <span class="pre">ADVECTION</span> <span class="pre">OF</span> <span class="pre">VELOCITIES</span></code>: <code class="docutils literal notranslate"><span class="pre">5</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SCHEME</span> <span class="pre">FOR</span> <span class="pre">ADVECTION</span> <span class="pre">OF</span> <span class="pre">K-EPSILON</span></code>: <code class="docutils literal notranslate"><span class="pre">5</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SCHEME</span> <span class="pre">FOR</span> <span class="pre">ADVECTION</span> <span class="pre">OF</span> <span class="pre">TRACERS</span></code>: <code class="docutils literal notranslate"><span class="pre">5</span></code></p></li>
</ul>
</li>
<li><p>Enable predictor-corrector with local implication:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">SCHEME</span> <span class="pre">OPTION</span> <span class="pre">FOR</span> <span class="pre">ADVECTION</span> <span class="pre">OF</span> <span class="pre">VELOCITIES</span></code>: <code class="docutils literal notranslate"><span class="pre">4</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SCHEME</span> <span class="pre">OPTION</span> <span class="pre">FOR</span> <span class="pre">ADVECTION</span> <span class="pre">OF</span> <span class="pre">K-EPSILON</span></code>: <code class="docutils literal notranslate"><span class="pre">4</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">SCHEME</span> <span class="pre">OPTION</span> <span class="pre">FOR</span> <span class="pre">ADVECTION</span> <span class="pre">OF</span> <span class="pre">TRACERS</span></code>: <code class="docutils literal notranslate"><span class="pre">4</span></code></p></li>
</ul>
</li>
</ul>
<p>These values (<code class="docutils literal notranslate"><span class="pre">5</span></code> for the scheme and <code class="docutils literal notranslate"><span class="pre">4</span></code> for the scheme option) are default values since <em>TELEMAC v8p1</em>, but it still makes sense to define these parameters for enabling backward compatibility of the steering file. If the occurrence of tidal flats can be excluded (note that already a little backwater upstream of a barrier can represent a tidal flat), the <code class="docutils literal notranslate"><span class="pre">SCHEME</span> <span class="pre">OPTIONS</span></code> can generally set to <code class="docutils literal notranslate"><span class="pre">2</span></code> for speeding up the simulation.</p>
<p>Similar to advection, the above keywords can be used to define diffusion steps (replace <code class="docutils literal notranslate"><span class="pre">ADVECTION</span></code> with <code class="docutils literal notranslate"><span class="pre">DIFFUSION</span></code> in the keywords), where a value of <code class="docutils literal notranslate"><span class="pre">0</span></code> can be used to override the default value of <code class="docutils literal notranslate"><span class="pre">1</span></code> and disable diffusion.</p>
<div class="admonition hint">
<p class="admonition-title">Hint</p>
<p><strong>Recall</strong>: <strong>Advection</strong> represents the motion of particles along with the bulk flow. <strong>Diffusion</strong> is the result of random motion of particles, driven by differences in concentration (e.g., dissipation of highly concentrated particles towards regions of low concentration). <strong>Convection</strong> encompassed both time-dependent phenomena.</p>
</div>
<p>The <code class="docutils literal notranslate"><span class="pre">SUPG</span> <span class="pre">OPTION</span></code> (Streamline Upwind Petrov Galerkin) keyword is a list of four integers that define if upwinding applies and what type of upwinding applies. The integers may take the following values:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code> disables upwinding,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> enables upwinding with a classical SUPG scheme (recommended when the <a class="reference external" href="https://en.wikipedia.org/wiki/Courant-Friedrichs-Lewy_condition">Courant number</a> is unknown), and</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> enables upwinding with a modified SUPG scheme, where upwinding corresponds to the Courant number.</p></li>
</ul>
<p>The default is <code class="docutils literal notranslate"><span class="pre">SUPG</span> <span class="pre">OPTION</span> <span class="pre">:</span> <span class="pre">1;0;1;1</span></code>, where the first list element refers to flow velocity (default <code class="docutils literal notranslate"><span class="pre">1</span></code>), the second to water depth (default <code class="docutils literal notranslate"><span class="pre">0</span></code>), the third to tracers (default <code class="docutils literal notranslate"><span class="pre">1</span></code>), and the last to the k-epsilon model (default <code class="docutils literal notranslate"><span class="pre">1</span></code>). Read more in section 6.2.2 of the <a class="reference external" href="http://ot-svn-public:telemac1*&#64;svn.opentelemac.org/svn/opentelemac/tags/v8p1r1/documentation/telemac3d/user/telemac3d_user_v8p1.pdf">Telemac 3d docs</a>.</p>
<p>An additional option for speeding up is to enable mass lumping for diffusion, depth, and/or weak characteristics. Mass lumping results in faster convergence, but it introduces artificial dispersion in the results, which is why enabling mass lumping is discouraged by the <em>TELEMAC</em> developers. The provided <a class="reference external" href="https://raw.githubusercontent.com/Ecohydraulics/telemac-helpers/master/model-templates/t3d_template.cas"><em>t3d_template.cas</em></a> includes the keywords for mass lumping, though they are disabled.</p>
<p><strong>Implication parameters</strong> (<code class="docutils literal notranslate"><span class="pre">IMPLICITATION</span> <span class="pre">FOR</span> <span class="pre">DEPTH</span></code> and <code class="docutils literal notranslate"><span class="pre">IMPLICITATION</span> <span class="pre">FOR</span> <span class="pre">VELOCITIES</span></code>) should be set between 0.55 and 0.60 (default is 0.55 since <em>TELEMAC v8p1</em>) and can be considered as a degree of implicitation. <code class="docutils literal notranslate"><span class="pre">IMPLICITATION</span> <span class="pre">FOR</span> <span class="pre">DIFFUSION</span></code> is set to <code class="docutils literal notranslate"><span class="pre">1.0</span></code> by default. Read more in section 6.4 of the <a class="reference external" href="http://ot-svn-public:telemac1*&#64;svn.opentelemac.org/svn/opentelemac/tags/v8p1r1/documentation/telemac3d/user/telemac3d_user_v8p1.pdf">Telemac 3d docs</a>.</p>
<p>The parameter <code class="docutils literal notranslate"><span class="pre">FREE</span> <span class="pre">SURFACE</span> <span class="pre">GRADIENT</span></code> can be used for increasing the stability of a model. Its default value is <code class="docutils literal notranslate"><span class="pre">1.0</span></code>, but it can be reduced to <code class="docutils literal notranslate"><span class="pre">0.1</span></code> to achieve stability.</p>
</div>
<div class="section" id="hydrodynamic-parameters-a-name-hydrodynamics-a">
<h3>Hydrodynamic Parameters <a name="hydrodynamics"></a><a class="headerlink" href="#hydrodynamic-parameters-a-name-hydrodynamics-a" title="Permalink to this headline">¶</a></h3>
<p>In river analyses, the non-hydrostatic version of <em>TELEMAC</em> should be used through the following keyword: `NON-HYDROSTATIC VERSION : YES``.</p>
<p>Depending on the type of analysis, the solver-related parameters of <code class="docutils literal notranslate"><span class="pre">SOLVER</span></code>, <code class="docutils literal notranslate"><span class="pre">SOLVER</span> <span class="pre">OPTIONS</span></code>, <code class="docutils literal notranslate"><span class="pre">MAXIMUM</span> <span class="pre">NUMBER</span> <span class="pre">OF</span> <span class="pre">ITERATION</span></code>, <code class="docutils literal notranslate"><span class="pre">ACCURACY</span></code>, and <code class="docutils literal notranslate"><span class="pre">PRECONDITIONING</span></code> may be modified. The provided <a class="reference external" href="https://raw.githubusercontent.com/Ecohydraulics/telemac-helpers/master/model-templates/t3d_template.cas"><em>t3d_template.cas</em></a> includes solver keywords and comments for modifications, but the default options already provide a coherent a stable setup. Read more about solver parameters in section 6.5 of the <a class="reference external" href="http://ot-svn-public:telemac1*&#64;svn.opentelemac.org/svn/opentelemac/tags/v8p1r1/documentation/telemac3d/user/telemac3d_user_v8p1.pdf">Telemac 3d docs</a>.</p>
<p>Parameters for <strong>Boundary Conditions</strong> enable the definition of roughness laws and properties of liquid boundaries.</p>
<p>With respect to roughness, <em>TELEMAC</em> developers recommend using the <a class="reference external" href="https://en.wikipedia.org/wiki/Johann_Nikuradse"><em>Nikuradse</em></a> roughness law in 3d (number <code class="docutils literal notranslate"><span class="pre">5</span></code>), because all others are not meaningful or not integrally implemented in the 3d version. To apply the <em>Nikuradse</em> roughness law to the bottom and the boundaries use:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">LAW</span> <span class="pre">OF</span> <span class="pre">BOTTOM</span> <span class="pre">FRICTION</span></code>: <code class="docutils literal notranslate"><span class="pre">5</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">LAW</span> <span class="pre">OF</span> <span class="pre">FRICTION</span> <span class="pre">ON</span> <span class="pre">LATERAL</span> <span class="pre">BOUNDARIES</span></code>: <code class="docutils literal notranslate"><span class="pre">5</span></code>, which can well be applied to model natural banks, or set to <code class="docutils literal notranslate"><span class="pre">0</span></code> (no-slip) for symmetry.<br>*Note that the <a class="reference external" href="#bnd-mod">boundary conditions file</a> sets the <code class="docutils literal notranslate"><span class="pre">LIUBOR</span></code> and <code class="docutils literal notranslate"><span class="pre">LIVBOR</span></code> for the <code class="docutils literal notranslate"><span class="pre">leftwall</span></code> and <code class="docutils literal notranslate"><span class="pre">rightwall</span></code> boundary edges to zero, to enable friction.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FRICTION</span> <span class="pre">COEFFICIENT</span> <span class="pre">FOR</span> <span class="pre">THE</span> <span class="pre">BOTTOM</span></code>: <code class="docutils literal notranslate"><span class="pre">0.1</span></code> corresponds to 3 times a hypothetical <em>d90</em> (grain diameter of which 90% of the surface grain mixture are finer) according to <a class="reference external" href="https://www.leovanrijn-sediment.com/">van Rijn</a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">FRICTION</span> <span class="pre">COEFFICIENT</span> <span class="pre">FOR</span> <span class="pre">LATERAL</span> <span class="pre">SOLID</span> <span class="pre">BOUNDARIES</span></code>: <code class="docutils literal notranslate"><span class="pre">0.1</span></code> corresponds to 3 times a hypothetical <em>d90</em>, similar as for the bottom.</p></li>
</ul>
<p>The liquid boundary definitions for <code class="docutils literal notranslate"><span class="pre">PRESCRIBED</span> <span class="pre">FLOWRATES</span></code> and <code class="docutils literal notranslate"><span class="pre">PRESCRIBED</span> <span class="pre">ELEVATIONS</span></code> correspond to the definitions of the <strong>downstream</strong> boundary edge in line 2 and the <strong>upstream</strong> boundary edge in line 3 (see <a class="reference external" href="#bnd-mod">boundary definitions section</a>). From the boundary file, <em>TELEMAC</em> will understand the <strong>downstream</strong> boundary as edge number <strong>1</strong> (first list element) and the <strong>upstream</strong> boundary as edge number <strong>2</strong> (second list element). Hence:</p>
<ul class="simple">
<li><p>The list parameter <code class="docutils literal notranslate"><span class="pre">PRESCRIBED</span> <span class="pre">FLOWRATES</span> <span class="pre">:</span> <span class="pre">50.;50.</span></code> assigns a flow rate of 50 m<sup>3</sup>/s to the <strong>downstream</strong> and the <strong>upstream</strong> boundary edges.</p></li>
<li><p>The list parameter <code class="docutils literal notranslate"><span class="pre">PRESCRIBED</span> <span class="pre">ELEVATIONS</span> <span class="pre">:</span> <span class="pre">2.;0.</span></code> assigns an elevation (i.e., water depth) of two m to the <strong>downstream</strong> boundary and a water depth of 0.0 m to the <strong>upstream</strong> boundary.</p></li>
</ul>
<!--The `0.` value for the flow rate does physically not make sense at the downstream boundary, but because they do not make sense, and because the boundary file (`flume3d_bc.bnd`) only defines (*prescribes*) water depth, *TELEMAC* will ignore the zero-flow rate at the downstream boundary.-->
<p>The <code class="docutils literal notranslate"><span class="pre">0.</span></code> value for the water does physically not make sense at the upstream boundary, but because they do not make sense, and because the boundary file (<code class="docutils literal notranslate"><span class="pre">flume3d_bc.bnd</span></code>) only defines (<em>prescribes</em>) a flow rate (by setting <code class="docutils literal notranslate"><span class="pre">LIUBOR</span></code> and <code class="docutils literal notranslate"><span class="pre">LIVBOR</span></code> to <code class="docutils literal notranslate"><span class="pre">5</span></code>), <em>TELEMAC</em> will ignore the zero-water depth at the upstream boundary.</p>
<p>Instead of a list in the steering <em>CAS</em> file, the liquid boundary conditions can also be defined with a liquid boundary condition file in <em>ASCII</em> text format. For this purpose, a <code class="docutils literal notranslate"><span class="pre">LIQUID</span> <span class="pre">BOUNDARIES</span> <span class="pre">FILE</span></code> or a <code class="docutils literal notranslate"><span class="pre">STAGE-DISCHARGE</span> <span class="pre">CURVES</span> <span class="pre">FILE</span></code> (sections 4.3.8 and 4.3.10 in the <a class="reference external" href="http://ot-svn-public:telemac1*&#64;svn.opentelemac.org/svn/opentelemac/tags/v8p1r1/documentation/telemac3d/user/telemac3d_user_v8p1.pdf">Telemac 3d docs</a>, respectively can be defined. The <a class="reference external" href="https://raw.githubusercontent.com/Ecohydraulics/telemac-helpers/master/model-templates/t3d_template.cas"><em>t3d_template.cas</em></a> file includes these keywords in the <em>COMPUTATION ENVIRONMENT</em> section, even though they are disabled. A liquid boundary file (<em>QSL</em>) may look like this:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="cp"># t3d_canal.qsl</span>
<span class="cp"># time-dependent inflow upstream-discharge Q(2) and outflow downstream-depth SL(1)</span>
<span class="n">T</span>           <span class="n">Q</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>     <span class="n">SL</span><span class="p">(</span><span class="mi">1</span><span class="p">)</span>
<span class="n">s</span>           <span class="n">m3</span><span class="o">/</span><span class="n">s</span>     <span class="n">m</span>
<span class="mf">0.</span>            <span class="mf">0.</span>     <span class="mf">5.0</span>
<span class="mi">50</span><span class="mf">0.</span>        <span class="mi">10</span><span class="mf">0.</span>     <span class="mf">5.0</span>
<span class="mi">500</span><span class="mf">0.</span>       <span class="mi">15</span><span class="mf">0.</span>     <span class="mf">5.0</span>
</pre></div>
</div>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>The <code class="docutils literal notranslate"><span class="pre">ELEVATION</span></code> parameter in the <em>CAS</em> file denotes water depth, while the <code class="docutils literal notranslate"><span class="pre">ELEVATION</span></code> keyword in an external liquid boundary file (e.g. stage-discharge curve) refers to absolute (geodetic) elevation (<code class="docutils literal notranslate"><span class="pre">Z</span></code> plus <code class="docutils literal notranslate"><span class="pre">H</span></code>).</p>
</div>
<p>With a prescribed flow rate, a horizontal and a vertical velocity profile can be prescribed for all liquid boundaries. With only a <strong>downstream</strong> and an <strong>upstream</strong> liquid boundary (in that order according to the above-defined boundary file), the velocity profile keywords are lists of two elements each, where the first entry refers to the <strong>downstream</strong> and the second element to <strong>upstream</strong> boundary edges:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">VELOCITY</span> <span class="pre">PROFILES</span></code>: <code class="docutils literal notranslate"><span class="pre">1;1</span></code> is the default option for the <strong>horizontal</strong> profiles. If set to <code class="docutils literal notranslate"><span class="pre">2;2</span></code>, the velocity profiles will be read from the boundary condition file.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VELOCITY</span> <span class="pre">VERTICAL</span> <span class="pre">PROFILES</span></code>: <code class="docutils literal notranslate"><span class="pre">2;2</span></code> sets the <strong>vertical</strong> velocity profiles to logarithmic. The default is <code class="docutils literal notranslate"><span class="pre">1;1</span></code> (constant). Alternatively, a user-defined <code class="docutils literal notranslate"><span class="pre">USER_VEL_PROF_Z</span></code> subroutine can be implemented in a fortran file.</p></li>
</ul>
<p>Read more about options for defining velocity profiles in section 4.3.12 of the <a class="reference external" href="http://ot-svn-public:telemac1*&#64;svn.opentelemac.org/svn/opentelemac/tags/v8p1r1/documentation/telemac3d/user/telemac3d_user_v8p1.pdf">Telemac 3d docs</a>.</p>
<p><a name="inc"></a>
The <strong>initial conditions</strong> describe the condition at the beginning of the simulation. This tutorial uses a constant elevation (corresponding to a constant water depth) of <code class="docutils literal notranslate"><span class="pre">2.</span></code>, and enables using an initial guess for the water depth to speed up the simulation:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">INITIAL</span> <span class="pre">CONDITIONS</span></code>: <code class="docutils literal notranslate"><span class="pre">'CONSTANT</span> <span class="pre">ELEVATION'</span></code> can alternatively be set to <code class="docutils literal notranslate"><span class="pre">'CONSTANT</span> <span class="pre">DEPTH'</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">INITIAL</span> <span class="pre">ELEVATION</span></code>: <code class="docutils literal notranslate"><span class="pre">50.</span></code> corresponds to depth here, but would be different in an external liquid boundary file (see above).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">INITIAL</span> <span class="pre">DEPTH</span></code>: <code class="docutils literal notranslate"> <span class="pre">2.</span></code> is not used in this tutorial.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">INITIAL</span> <span class="pre">GUESS</span> <span class="pre">FOR</span> <span class="pre">DEPTH</span></code>: <code class="docutils literal notranslate"><span class="pre">1</span></code> must be an <strong>integer</strong> value and speeds up the calculation (convergence).</p></li>
</ul>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>In this scenario, <code class="docutils literal notranslate"><span class="pre">INITIAL</span> <span class="pre">ELEVATION</span></code>: <code class="docutils literal notranslate"><span class="pre">50</span></code> makes that the computational mesh is 50 m high, which makes sense in the context of a 100-m wide and 500-m long flume. However, this setting requires careful revision in other cases.</p>
</div>
<p>Read more about the initial conditions in section 4.2 of the <a class="reference external" href="http://ot-svn-public:telemac1*&#64;svn.opentelemac.org/svn/opentelemac/tags/v8p1r1/documentation/telemac3d/user/telemac3d_user_v8p1.pdf">Telemac 3d docs</a>.</p>
</div>
<div class="section" id="turbulence">
<h3>Turbulence<a class="headerlink" href="#turbulence" title="Permalink to this headline">¶</a></h3>
<p>Turbulence describes a seemingly random and chaotic state of fluid motion in the form of three-dimensional vortices (eddies). True turbulence is only present in 3d vorticity and when it occurs, it mostly dominates all other flow phenomena through increases in energy dissipation, drag, heat transfer, and mixing. The phenomenon of turbulence has been a mystery to science for a long time, since turbulent flows have been observed, but could not be directly explained by the systems of linear equations. Today, turbulence is considered a random phenomenon that can be accounted for in linear equations, for instance, by introducing statistical parameters. Not surprisingly, there are a variety of options for implementing turbulence in numerical models. The horizontal and vertical dimensions of turbulent eddies can vary greatly, especially in rivers and transitions to backwater zones (tidal flats), with large flow widths (horizontal dimension) compared to small water depths (vertical dimension). For these reasons, <em>TELEMAC</em> provides multiple turbulence models that can be applied in the vertical and horizontal dimensions.</p>
<p>In 3d, <em>TELEMAC</em> developers recommend using either the <em>k-ε</em> model (<code class="docutils literal notranslate"><span class="pre">3</span></code>) or the <em>Spalart-Allmaras</em> model (<code class="docutils literal notranslate"><span class="pre">5</span></code>) in lieu of the mixing length model (<code class="docutils literal notranslate"><span class="pre">2</span></code>):</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">HORIZONTAL</span> <span class="pre">TURBULENCE</span> <span class="pre">MODEL</span></code>: <code class="docutils literal notranslate"><span class="pre">3</span></code></p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VERTICAL</span> <span class="pre">TURBULENCE</span> <span class="pre">MODEL</span></code>: <code class="docutils literal notranslate"><span class="pre">3</span></code></p></li>
</ul>
<p>If the <code class="docutils literal notranslate"><span class="pre">VERTICAL</span> <span class="pre">TURBULENCE</span> <span class="pre">MODEL</span></code> is set to <code class="docutils literal notranslate"><span class="pre">2</span></code> (<code class="docutils literal notranslate"><span class="pre">'MIXING</span> <span class="pre">LENGTH'</span></code>), a <code class="docutils literal notranslate"><span class="pre">MIXING</span> <span class="pre">LENGTH</span> <span class="pre">MODEL</span></code> can be assigned. The default is <code class="docutils literal notranslate"><span class="pre">1</span></code>, which is preferable for strong tidal influences and a value of <code class="docutils literal notranslate"><span class="pre">3</span></code> sets the length for computing vertical diffusivity to *Nezu and <em>Nakagawa</em>.</p>
<p>Read more about turbulence in <em>TELEMAC</em> in section 5.2 and the mixing length in section 5.2.2 of the <a class="reference external" href="http://ot-svn-public:telemac1*&#64;svn.opentelemac.org/svn/opentelemac/tags/v8p1r1/documentation/telemac3d/user/telemac3d_user_v8p1.pdf">Telemac 3d docs</a>.</p>
</div>
<div class="section" id="hydrosolver-cas-file-setup-unstable">
<h3><em>HydroSolver</em> CAS File Setup (Unstable)<a class="headerlink" href="#hydrosolver-cas-file-setup-unstable" title="Permalink to this headline">¶</a></h3>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>Skip this section if you already set up the CAS file manually.</p>
</div>
<p>A <em>CAS</em> file can be created with the <em>HydroSolver</em> module in <em>SALOME-HYDRO</em> as follows:</p>
<ol class="simple">
<li><p>Go to the <strong>Hydro</strong> top menu &gt; <strong>Edit cas file (English)</strong> and a popup window along with a new frame will open. The popup window will ask for the version of <em>TELEMAC</em> (i.e., the solver) to use. Select <strong>telemac3d</strong> and clock <strong>Ok</strong>.</p></li>
<li><p>In the new frame (<em>Eficas Telemac</em> viewport), go to <strong>File</strong> &gt; <strong>New</strong> for creating a new <em>CAS</em> (case or <em>French</em> <em>cas</em>).</p></li>
<li><p>Save the new <em>CAS</em> file (e.g., <code class="docutils literal notranslate"><span class="pre">flume3d-steady.cas</span></code>) in the same directory where all other simulation files live.</p></li>
</ol>
<div class="figure align-default">
<img alt="telemac salome hydro hydrosolver new cas file save as" src="../_images/hs-create-cas.png" />
</div>
<p>A new <em>unnamed file1</em> case is created and opens up in the <em>Computation environment</em> frame. To make sure that no information will be lost, save the <em>CAS</em> file regularly. The <em>HydroSolver</em> module guides through parameter definitions as above shown (starting with the <em>COMPUTATION_ENVIRONMENT</em> block), with built-in explanations on the sidebar.</p>
<div class="admonition attention">
<p class="admonition-title">Attention</p>
<p>After finalizing the <em>CAS</em> file with <em>HydroSolver</em>, open the <em>CAS</em> file in a text editor and make sure that all parameters are coherently defined as described above. In particular, pay attention to the non-use of file directories.</p>
</div>
</div>
</div>
<div class="section" id="run-simulation-compute">
<h2>Run Simulation (Compute)<a class="headerlink" href="#run-simulation-compute" title="Permalink to this headline">¶</a></h2>
<div class="section" id="stand-alone-telemac-installation">
<h3>Stand-alone TELEMAC installation<a class="headerlink" href="#stand-alone-telemac-installation" title="Permalink to this headline">¶</a></h3>
<p>Go to the configuration folder of the local <em>TELEMAC</em> installation (e.g., <code class="docutils literal notranslate"><span class="pre">~/telemac/v8p2/configs/</span></code>) and launch the environment (e.g., <code class="docutils literal notranslate"><span class="pre">pysource.openmpi.sh</span></code> - use the same as for compiling <em>TELEMAC</em>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~/</span><span class="n">telemac</span><span class="o">/</span><span class="n">v8p2</span><span class="o">/</span><span class="n">configs</span>
<span class="n">source</span> <span class="n">pysource</span><span class="o">.</span><span class="n">openmpi</span><span class="o">.</span><span class="n">sh</span>
<span class="n">config</span><span class="o">.</span><span class="n">py</span>
</pre></div>
</div>
<p>With the <em>TELEMAC</em> environment loaded, change to the directory where the above-created 3d-flume simulation lives (e.g., <code class="docutils literal notranslate"><span class="pre">/home/modelling/flume3d-tutorial/</span></code>) and run the <em>CAS</em> file by calling the <strong><a class="reference external" href="http://telemac3d.py">telemac3d.py</a></strong> script.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~/</span><span class="n">modelling</span><span class="o">/</span><span class="n">flume3d</span><span class="o">-</span><span class="n">tutorial</span><span class="o">/</span>
<span class="n">telemac3d</span><span class="o">.</span><span class="n">py</span> <span class="n">flume3d</span><span class="o">.</span><span class="n">cas</span>
</pre></div>
</div>
<p>As a result, a successful computation should end with the following lines (or similar) in <em>Terminal</em>:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="p">[...]</span>
<span class="n">BOUNDARY</span> <span class="n">FLUXES</span> <span class="n">FOR</span> <span class="n">WATER</span> <span class="n">IN</span> <span class="n">M3</span><span class="o">/</span><span class="n">S</span> <span class="p">(</span> <span class="o">&gt;</span><span class="mi">0</span> <span class="p">:</span> <span class="n">ENTERING</span> <span class="p">)</span>
<span class="n">FLUX</span> <span class="n">BOUNDARY</span>      <span class="mi">1</span>                          <span class="p">:</span>    <span class="o">-</span><span class="mi">4</span><span class="mf">9.85411</span>
<span class="n">FLUX</span> <span class="n">BOUNDARY</span>      <span class="mi">2</span>                          <span class="p">:</span>     <span class="mi">5</span><span class="mf">0.00000</span>
<span class="o">--------------------------------------------------------------------------------</span>
                <span class="k">FINAL </span><span class="n">MASS</span> <span class="n">BALANCE</span>
<span class="n">T</span> <span class="o">=</span>        <span class="mi">500</span><span class="mf">0.0000</span>

<span class="o">---</span> <span class="n">WATER</span> <span class="o">---</span>
<span class="n">INITIAL</span> <span class="n">MASS</span>                        <span class="p">:</span>     <span class="mi">250000</span><span class="mf">0.</span>
<span class="k">FINAL </span><span class="n">MASS</span>                          <span class="p">:</span>     <span class="mi">10034</span><span class="mf">3.0</span>
<span class="n">MASS</span> <span class="n">LEAVING</span> <span class="n">THE</span> <span class="n">DOMAIN</span> <span class="p">(</span><span class="nb">OR </span><span class="n">SOURCE</span><span class="p">)</span> <span class="p">:</span>     <span class="mi">238421</span><span class="mf">7.</span>
<span class="n">MASS</span> <span class="n">LOSS</span>                           <span class="p">:</span>     <span class="mi">1544</span><span class="mf">0.06</span>

 <span class="k">END </span><span class="n">OF</span> <span class="nb">TIME </span><span class="n">LOOP</span>

 <span class="n">EXITING</span> <span class="n">MPI</span>
                     <span class="o">*************************************</span><span class="k">STOP </span><span class="mi">0</span>
                     <span class="o">*</span>    <span class="k">END </span><span class="n">OF</span> <span class="k">MEMORY </span><span class="n">ORGANIZATION</span><span class="p">:</span>    <span class="o">*</span>
                     <span class="o">*************************************</span>

 <span class="n">CORRECT</span> <span class="k">END </span><span class="n">OF</span> <span class="n">RUN</span>

 <span class="n">ELAPSE</span> <span class="nb">TIME</span> <span class="p">:</span>
                             <span class="mi">44</span>  <span class="n">SECONDS</span>
<span class="p">...</span> <span class="n">merging</span> <span class="n">separated</span> <span class="k">result </span><span class="n">files</span>

<span class="p">...</span> <span class="n">handling</span> <span class="k">result </span><span class="n">files</span>
        <span class="n">moving</span><span class="p">:</span> <span class="n">r3d_canal</span><span class="o">-</span><span class="n">t3d</span><span class="p">.</span><span class="n">med</span>
        <span class="n">moving</span><span class="p">:</span> <span class="n">r2d3d_canal</span><span class="o">-</span><span class="n">t3d</span><span class="p">.</span><span class="n">med</span>
<span class="p">...</span> <span class="n">deleting</span> <span class="n">working</span> <span class="n">dir</span>

<span class="n">My</span> <span class="n">work</span> <span class="k">is </span><span class="n">done</span>
</pre></div>
</div>
<p>Thus, <em>Telemac3d</em> produced the files <code class="docutils literal notranslate"><span class="pre">r3d_canal-t3d.med</span></code> and <code class="docutils literal notranslate"><span class="pre">r2d3d_canal-t3d.med</span></code>, which can now be analyzed in the <a class="reference external" href="#postproc">post-processing with SALOME</a>.</p>
</div>
<div class="section" id="salome-hydro-hydrosolver">
<h3><em>SALOME-HYDRO</em> &amp; <em>HydroSolver</em><a class="headerlink" href="#salome-hydro-hydrosolver" title="Permalink to this headline">¶</a></h3>
<div class="admonition warning">
<p class="admonition-title">Warning</p>
<p>On newer systems (e.g., Debian 10), it is highly likely, that the local libraries are newer than the ones used for compiling <em>TELEMAC</em> in the <em>SALOME-HYDRO</em> environment. Thus, simulations may fail, for example when <em>SALOME-HYDRO</em> tries to communicate with the local <em>openmpi</em> libraries. For this reason, it is recommended to use a <a class="reference external" href="#modular-install"><em>TELEMAC</em> stand-alone installation</a> of <em>TELEMAC</em> for running simulations.</p>
</div>
<p>If the new PYTEL case is not showing up in the <em>Object Browser</em>, save the project (e.g., <em>tetrahedral_3d.hdf</em>), close, and restart <em>SALOME-HYDRO</em>. Re-open the project <em>hdf</em> file and re-activate the HydroSolver module.</p>
<ul class="simple">
<li><p>In the <em>Object Browser</em>, click on <em>tetrahedral_steering</em> (highlights in blue).</p></li>
<li><p>With the steering file highlighted, find the <em>Edit Pytel case for execution</em> button in the menu bar and click on it.</p></li>
<li><p>Enable the PYTEL radio button</p></li>
<li><p>In the <em>Object Browser</em>, right-click on HydroSolver and click <em>Refresh</em>. An <em>EXE</em> sign next to <em>tetrahedral steering</em> should show up*.</p></li>
<li><p>Right-click on the new <em>EXE tetrahedral steering</em> item in the <em>Object Browser</em>, then click on <em>Compute</em></p></li>
</ul>
</div>
</div>
<div class="section" id="post-processing-with-salome-and-paravis">
<span id="postproc"></span><h2>Post-Processing with SALOME and ParaVis<a class="headerlink" href="#post-processing-with-salome-and-paravis" title="Permalink to this headline">¶</a></h2>
<p>Go to the installation folder where <em>SALOME</em> is installed (e.g., <code class="docutils literal notranslate"><span class="pre">/home/SALOME-9.6.0/</span></code>) and launch <em>SALOME</em> (recall the installation instructions for <a class="reference external" href="../get-started/install-openfoam.html#salome"><em>SALOME</em></a>).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~/</span><span class="n">SALOME</span><span class="o">-</span><span class="mf">9.6</span><span class="o">.</span><span class="mi">0</span><span class="o">/</span>
<span class="n">source</span> <span class="n">env_launch</span><span class="o">.</span><span class="n">sh</span>
<span class="o">./</span><span class="n">salome</span>
</pre></div>
</div>
<p>Once <em>SALOME</em> opened up, activate the <strong>ParaVis</strong> module from the top menu.</p>
<div class="admonition note">
<p class="admonition-title">Note</p>
<p>In theory, also <em>SALOME-HYDRO</em> does the job, but the <em>ParaVis</em> module may run unstable here. Moreover, <em>ParaView</em> can handle similar data formats, but the default installation of <em>ParaView</em> cannot handle <em>MED</em> files. For these reasons, working with the latest official <em>SALOME</em> release is the best option to post-process <em>MED</em> files.</p>
</div>
<p>Both the 3d (<code class="docutils literal notranslate"><span class="pre">r3d_canal-t3d.med</span></code>) and 2d (<code class="docutils literal notranslate"><span class="pre">r2d3d_canal-t3d.med</span></code>) results files can be loaded the same way and data export works similarly. Thus, the following sections illustrate loading and extracting data from the 3d (<code class="docutils literal notranslate"><span class="pre">r3d_canal-t3d.med</span></code>) results file only.</p>
<div class="section" id="load-results-med-file">
<h3>Load Results (MED file)<a class="headerlink" href="#load-results-med-file" title="Permalink to this headline">¶</a></h3>
<p>To open a results (or any other) <em>MED</em> file, right-click on the <strong>builtin:</strong> symbol in the <strong>Pipeline Browser</strong> on the top-left of the window and select <strong>Open</strong>.</p>
<div class="figure align-default">
<img alt="telemac salome open med file pipelinebrowser" src="../_images/pv01-open.png" />
</div>
<p>In the popup window, use the frames on the left to navigate to the folder where the simulation and its results live. Select <code class="docutils literal notranslate"><span class="pre">r3d_canal-t3d.med</span></code> and click <strong>OK</strong>.</p>
<div class="figure align-default">
<img alt="telemac salome open 3d med file" src="../_images/pv02-open-res3d.png" />
</div>
<p>The file <code class="docutils literal notranslate"><span class="pre">r3d_canal-t3d.med</span></code> appears in the <em>Pipeline Browser</em>. Click on the green <strong>Apply</strong> button in the <em>Properties</em> tab.</p>
<div class="figure align-default">
<img alt="telemac salome apply 3d med file" src="../_images/pv05-apply3d.png" />
</div>
<p>The model block (i.e., the flume, or channel - <em>French: canal</em>) becomes visible in the viewport. Click on the block in the viewport (left mouse button), hold down and move the mouse to get an impression of the flume. To visualize the results, find the variable drop-down menu in the upper part of the window (initially shows <strong>Solid Color</strong>), and select <strong>VELOCITY U</strong>.</p>
<div class="figure align-default">
<img alt="telemac salome load results velocity" src="../_images/pv06-vis-u.png" />
</div>
<p>Click on the <em>Play</em> <strong>&gt;</strong> button (top-right of the window) to animate the results illustration to the last time step (<em>50</em> - which is the result of <code class="docutils literal notranslate"><span class="pre">5000</span></code> times steps divided by the graphical printout period of <code class="docutils literal notranslate"><span class="pre">100</span></code>).</p>
<div class="figure align-default">
<img alt="telemac salome visualize results" src="../_images/pv07-vis-ut.png" />
</div>
<p>Set the visualization to <strong>Surface with Edges</strong> (instead of <em>Surface</em>), next to the <em>VELOCITY U</em> drop-down menu, and export the current visualization by click on the <strong>Capture screenshot …</strong> button in the viewport.</p>
<div class="figure align-default">
<img alt="telemac salome save screenshot surface with edges" src="../_images/pv08-save-screenshot-with-edges.png" />
</div>
</div>
<div class="section" id="export-data">
<h3>Export Data<a class="headerlink" href="#export-data" title="Permalink to this headline">¶</a></h3>
<p>To export data from a results file, go to <strong>File</strong> &gt; **Save Data…*.</p>
<div class="figure align-default">
<img alt="telemac3d salome save export data" src="../_images/pv10-data-save.png" />
</div>
<p>In the popup window define a file name and ending, which can be either <em>csv</em>, <em>tsv</em>, or <em>txt</em>. The selected ending will call the appropriate assistant to define export details. In this example, use <strong>csv</strong> by typing <code class="docutils literal notranslate"><span class="pre">flume3d-export.csv</span></code>.</p>
<div class="figure align-default">
<img alt="telemac3d salome save export data csv paravis" src="../_images/pv11-export-data-csv.png" />
</div>
<p>Select relevant data (e.g., <code class="docutils literal notranslate"><span class="pre">U</span></code>, <code class="docutils literal notranslate"><span class="pre">V</span></code>, <code class="docutils literal notranslate"><span class="pre">W</span></code>, and <code class="docutils literal notranslate"><span class="pre">Z</span></code>) by checking the *<em>Choose Arrays to Write</em> box and enable <strong>Add Time</strong>. Click <strong>OK</strong> to finalize the data export.</p>
<div class="figure align-default">
<img alt="telemac3d salome export data csv paravis configure" src="../_images/pv12-export-data-csv-config.png" />
</div>
<p>The resulting data export file may look like this:</p>
<div class="figure align-default">
<img alt="telemac3d salome exported data csv file" src="../_images/pv13-exported-csv.png" />
</div>
<p>Recall that many other variables can be exported by defining them in the <em>CAS</em> file as above described in the [computational environment]](#comp-env). A full list of 2d and 3d output parameters in available sections 3.13 and 3.12, respectively, of the <a class="reference external" href="http://ot-svn-public:telemac1*&#64;svn.opentelemac.org/svn/opentelemac/tags/v8p1r1/documentation/telemac3d/user/telemac3d_user_v8p1.pdf">Telemac 3d docs</a>.</p>
<div class="admonition tip">
<p class="admonition-title">Tip</p>
<p>There is much more to discover in <em>ParaVis</em>. For instance, apply <em>Filters</em> (right-click on <code class="docutils literal notranslate"><span class="pre">r3d_canal-t3d.med</span></code> in the <em>Pipeline Browser</em> and go to <em>Add Filter</em>) to extract particular data at particular sections.</p>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "hydro-informatics/",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./numerics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        </div>
    </div>
    
    
    <div class='prev-next-bottom'>
        
    <a class='left-prev' id="prev-link" href="telemac2d.html" title="previous page">Pre-Processing for TELEMAC models</a>
    <a class='right-next' id="next-link" href="telemac-gaia.html" title="next page">Gaia Workflow</a>

    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Sebastian Schwindt<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>

    
  <script src="../_static/js/index.d3f166471bb80abb5163.js"></script>


    
  </body>
</html>
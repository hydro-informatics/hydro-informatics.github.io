
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Pre-processing with QGIS &#8212; Hydro-Informatics</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" href="../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../_static/sphinx-book-theme.acff12b8f9c144ce68a297486a2fa670.css" type="text/css" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script id="documentation_options" data-url_root="../" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/tabs.js"></script>
    <script >var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebelab@latest/lib/index.js"></script>
    <script >
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://hydro-informatics.github.io/numerics/pre-qgis.html" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="BASEMENT" href="basement.html" />
    <link rel="prev" title="Principles" href="numerical-modeling.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      <img src="../_static/icon.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Hydro-Informatics</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main navigation">
    <div class="bd-toc-item active">
        <p class="caption">
 <span class="caption-text">
  Get Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/classroom.html">
   The Virtual Classroom
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/lectures.html">
     Lectures and Exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/take_seat.html">
     Take a Seat
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../get-started/software.html">
   Software Resources
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/vm.html">
     Virtual Machines and Linux
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/ide.html">
     Integrated Development Environments (IDEs)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python-basics/pyinstall.html">
     Install Python
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/git.html">
     Introduction to git
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/geo.html">
     Geospatial Software
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/install-openfoam.html">
     OpenFOAM (Installation)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/install-telemac.html">
     TELEMAC (Installation)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/others.html">
     Other Software Resources
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Python Basics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../python-basics/python.html">
   First Steps
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pybase.html">
     Hello Data Types
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pyerror.html">
     Errors, Logging, and Debugging
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pyloop.html">
     Loops and Conditional Statements
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../python-basics/modularize.html">
   Object Orientation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pyfun.html">
     Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pypckg.html">
     Packages, Modules and Libraries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/classes.html">
     Object Orientation and Classes
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../python-basics/data-handling.html">
   Data and File Handling
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pynum.html">
     Load and Write Basic Data Files
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/xml.html">
     Workbooks (xlsx) and JSON
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pyplot.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../jupyter/pystyle.html">
   Code Style and Conventions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../jupyter/gui.html">
   Graphical User Interfaces (GUIs)
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../exercises/python-exercises.html">
   Python Exercises
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-ms.html">
     1d Hydraulics (Manning-Strickler Formula)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-sp.html">
     Reservoir Volume (Sequent Peak Algorithm)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-floods.html">
     Flood Return Periods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-sediment.html">
     1d Sediment Transport
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-gui.html">
     Create a GUI
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Geospatial Analysis
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../geopy/geospatial-data.html">
   Geospatial Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../geopy/use-qgis.html">
   QGIS Tutorial
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../geopy/geo-python.html">
   Geospatial Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../geopy/geo-pckg.html">
     Geospatial Open Source Python Libraries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/geo-shp.html">
     Shapefile (Vector Dataset) Handling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/geo-raster.html">
     Raster (Gridded) Dataset Handling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/geo-convert.html">
     Raster to Vector Conversion and Vice Versa
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/geo-arcpy.html">
     The Commercial arcpy Library
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../exercises/geo-exercises.html">
   Exercises
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-geco.html">
     Script a Habitat Suitability Map
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Numerical Modeling
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="numerical-modeling.html">
   Principles
  </a>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Pre-processing with QGIS
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="basement.html">
   BASEMENT
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="telemac.html">
   TELEMAC
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="telemac2d.html">
     Telemac2d
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
    <label for="toctree-checkbox-10">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="telemac2d-steady.html">
       Steady 2d Simulation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="telemac2d-unsteady.html">
       Unsteady 2d Simulation
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="telemac-gaia.html">
       Unsteady Hydro-Morphodynamic 2d Simulation (Gaia)
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="telemac3d.html">
     Telemac3d
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
    <label for="toctree-checkbox-11">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="telemac3d-slf.html">
       Telemac3d (SLF)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="telemac3d-med.html">
       Telemac3d: Salome-Hydro and MED
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="telemac-postpro.html">
     TELEMAC Post-processing
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="openfoam.html">
   OpenFOAM
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="calibration.html">
   Calibration and Validation
  </a>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Documentation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../documentation/documentation.html">
   Markdown and Code Documentation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../documentation/glossary.html">
   Glossary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../documentation/bibliography.html">
   References
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../exercises/docs-exercises.html">
   Exercises
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-git.html">
     Git and markdown
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Troubleshoot
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../troubleshoot/dbg-programming.html">
   Programming Tools and IDEs
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-anaconda.html">
     Debugging Anaconda
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-python.html">
     Debugging Python Code
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-jupyter.html">
     Debugging Jupyter
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../troubleshoot/dbg-numerical-models.html">
   Numerical Models
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
  <label for="toctree-checkbox-14">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-basement.html">
     Debugging BASEMENT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-telemac.html">
     Debugging TELEMAC/SALOME
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../troubleshoot/dbg-os.html">
   Operating Systems (Linux and VMs)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
  <label for="toctree-checkbox-15">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-linux.html">
     Debugging Debian Linux
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-vm.html">
     Debugging Virtual Machines
    </a>
   </li>
  </ul>
 </li>
</ul>
<p class="caption">
 <span class="caption-text">
  Disclaimer and License
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../terms/license.html">
   License
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../terms/disclaimer.html">
   Disclaimer
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Written by <a href="https://sebastian-schwindt.org">Sebastian Schwindt</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/numerics/pre-qgis.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/hydro-informatics/hydro-informatics.github.io"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#qgis-project-setup">
   QGIS Project Setup
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#load-dem">
   Load DEM
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#basement-telemac-create-2dm-mesh">
   BASEMENT / TELEMAC: Create 2dm Mesh
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-the-basemesh-plugin">
     Get the BASEmesh Plugin
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#model-boundary-and-breaklines">
     Model Boundary and Breaklines
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#liquid-hydraulic-boundaries">
     Liquid (Hydraulic) Boundaries
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#region-markers">
     Region Markers
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#create-a-quality-mesh">
     Create a Quality Mesh
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#interpolate-bottom-elevation-to-quality-mesh">
     Interpolate Bottom Elevation to Quality Mesh
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#usage-with-basement">
     Usage with BASEMENT
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#usage-with-telemac">
     Usage with TELEMAC
    </a>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#openfoam-export-dem-to-stl">
   OpenFOAM: Export DEM to STL
  </a>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#other-mesh-generator-plugins">
   Other Mesh Generator Plugins
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="section" id="pre-processing-with-qgis">
<span id="qgis-prepro"></span><h1>Pre-processing with QGIS<a class="headerlink" href="#pre-processing-with-qgis" title="Permalink to this headline">¶</a></h1>
<div class="attention admonition">
<p class="admonition-title">Requirements</p>
<p>Before diving into this tutorial make sure to:</p>
<ul class="simple">
<li><p>Follow the installation instructions for <a class="reference internal" href="../get-started/geo.html#qgis-install"><span class="std std-ref">QGIS</span></a> in this eBook.</p></li>
<li><p>Read (or watch) and understand this eBook’s <a class="reference internal" href="../geopy/use-qgis.html#qgis-tutorial"><span class="std std-ref">QGIS Tutorial</span></a>.</p></li>
</ul>
</div>
<p>The first steps in numerical modeling of a river consist in the conversion of a Digital Elevation Model (<strong><a class="reference internal" href="../documentation/glossary.html#term-DEM"><span class="xref std std-term">DEM</span></a></strong>) into a computational mesh. This tutorial guides through the creation of a QGIS project for converting a <a class="reference internal" href="../documentation/glossary.html#term-DEM"><span class="xref std std-term">DEM</span></a> (<a class="reference internal" href="../documentation/glossary.html#term-GeoTIFF"><span class="xref std std-term">GeoTIFF</span></a>) into a computational mesh that can be used with various numerical modeling software featured in this eBook. At the end of this tutorial, <a class="reference internal" href="basement.html#chpt-basement"><span class="std std-ref">BASEMENT</span></a> and <a class="reference internal" href="telemac.html#chpt-telemac"><span class="std std-ref">TELEMAC</span></a> users will have generated a computational grid in the <a class="reference internal" href="../documentation/glossary.html#term-SMS-2dm"><span class="xref std std-term">SMS 2dm</span></a> format. <a class="reference internal" href="openfoam.html#chpt-openfoam"><span class="std std-ref">OpenFOAM</span></a> modelers will have a exported the <a class="reference internal" href="../documentation/glossary.html#term-DEM"><span class="xref std std-term">DEM</span></a> in <a class="reference internal" href="../documentation/glossary.html#term-STL"><span class="xref std std-term">STL</span></a> file format that still needs to be meshed as explained later in this eBook’s <em>OpenFOAM</em> <a class="reference internal" href="openfoam.html#of-mesh"><span class="std std-ref">Meshing (tutorial under construction)</span></a> section.</p>
<div class="tip admonition">
<p class="admonition-title">Platform compatibility</p>
<p>All software applications featured in this tutorial can be run on <em>Linux</em>, <em>Windows</em>, and <em>macOS</em> (in theory - not tested) platforms. Note that some numerical models, such as <a class="reference internal" href="basement.html#chpt-basement"><span class="std std-ref">BASEMENT</span></a>, will not work on <em>macOS</em> platforms.</p>
</div>
<div class="section" id="qgis-project-setup">
<span id="start-qgis"></span><h2>QGIS Project Setup<a class="headerlink" href="#qgis-project-setup" title="Permalink to this headline">¶</a></h2>
<p>Launch QGIS and <a class="reference internal" href="../geopy/use-qgis.html#qgis-project"><span class="std std-ref">create a new QGIS project</span></a> to get started with this tutorial.
As featured in the <a class="reference internal" href="../geopy/use-qgis.html#qgis-tutorial"><span class="std std-ref">QGIS Tutorial</span></a>, set up a coordinate reference system (CRS) for the project. This example uses data of a river in Bavaria (Germany zone 4), which requires the following CRS:</p>
<ul class="simple">
<li><p>In the QGIS top menu go to <strong>Project</strong> &gt; <strong>Properties</strong>.</p></li>
<li><p>Activate the <strong>CRS</strong> tab.</p></li>
<li><p>Enter <code class="docutils literal notranslate"><span class="pre">Germany_Zone_4</span></code> and select the CRS shown in <a class="reference internal" href="#qgis-crs"><span class="std std-numref">Fig. 25</span></a>.</p></li>
<li><p>Click <strong>Apply</strong> and <strong>OK</strong>.</p></li>
</ul>
<div class="figure align-default" id="qgis-crs">
<img alt="qgis set coordinate reference system crs germany zone_4 Inn river" src="../_images/inn-crs.png" />
<p class="caption"><span class="caption-number">Fig. 25 </span><span class="caption-text">Define Germany_Zone_4 as project CRS.</span><a class="headerlink" href="#qgis-crs" title="Permalink to this image">¶</a></p>
</div>
<div class="tip admonition">
<p class="admonition-title">Save the project…</p>
<p>Save the QGIS project (<strong>Project</strong> &gt; <strong>Save As…</strong>), for example, under the name <strong>prepro-tutorial.qgz</strong>.</p>
</div>
</div>
<div class="section" id="load-dem">
<span id="get-dem"></span><h2>Load DEM<a class="headerlink" href="#load-dem" title="Permalink to this headline">¶</a></h2>
<p>A digital elevation model (<strong><a class="reference internal" href="../documentation/glossary.html#term-DEM"><span class="xref std std-term">DEM</span></a></strong>) represents the baseline for any physical analysis of a river ecosystem. Nowadays, <a class="reference internal" href="../documentation/glossary.html#term-DEM"><span class="xref std std-term">DEM</span></a>s often stem from light imaging, detection, and ranging (<a class="reference external" href="https://en.wikipedia.org/wiki/Lidar">LiDAR</a>) combined with bathymetric surveys. Older approaches rely on manual surveying (e.g., with a total station) of cross-sectional profiles and interpolating the terrain between the profiles. The newer LiDAR technique employs lights sources and provides terrain assessments up to 2-m deep water. Bathymetric <a class="reference external" href="https://en.wikipedia.org/wiki/Echo_sounding">echo sounding</a> is often necessary to map the ground of deeper waters. Thus, merged LiDAR and echo-sounding datasets produce seamless point clouds of river ecosystems, which may be stored in many different file types.</p>
<p>This tutorial uses an application-ready <a class="reference internal" href="../documentation/glossary.html#term-DEM"><span class="xref std std-term">DEM</span></a> in <a class="reference internal" href="../documentation/glossary.html#term-GeoTIFF"><span class="xref std std-term">GeoTIFF</span></a> <a class="reference internal" href="../geopy/geospatial-data.html#raster"><span class="std std-ref">Gridded Cell (Raster) Data</span></a> format that stems from a LiDAR point cloud. The <a class="reference internal" href="../documentation/glossary.html#term-DEM"><span class="xref std std-term">DEM</span></a> raster provides height (Z) information from a section of a gravel-cobble bed river in South-East Germany, which constitutes the baseline for the computational grids featured in the next sections. To get the provided DEM in the <em>QGIS</em> project:</p>
<ul class="simple">
<li><p><strong>Download the example DEM GeoTIFF</strong>](<a class="reference external" href="https://github.com/hydro-informatics/materials-bm/raw/main/rasters/dem.tif">https://github.com/hydro-informatics/materials-bm/raw/main/rasters/dem.tif</a>) and save it in the same folder (<code class="docutils literal notranslate"><span class="pre">/Project</span> <span class="pre">Home/</span></code> or a sub-directory) as the above-create <strong>qgz</strong> project.</p></li>
<li><p>Add the downloaded DEM as a new raster layer in <em>QGIS</em>:</p>
<ul>
<li><p>In <em>QGIS</em>’ <strong>Browser</strong> panel find the <strong>Project Home</strong> directory where you downloaded the DEM <em>tif</em>.</p></li>
<li><p>Drag the DEM <em>tif</em> from the <strong>Project Home</strong> folder into QGIS’ <strong>Layer</strong> panel.</p></li>
</ul>
</li>
<li><p>To facilitate delineating specific regions of the river ecosystem later, add a <a class="reference internal" href="../geopy/use-qgis.html#basemap"><span class="std std-ref">satellite imagery basemap</span></a> (XYZ tile) under the <a class="reference internal" href="../documentation/glossary.html#term-DEM"><span class="xref std std-term">DEM</span></a> and customize the layer symbology.</p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">What are QGIS panels again?</p>
<p>Learn more in the <em>QGIS</em> tutorial on <a class="reference internal" href="../geopy/use-qgis.html#qgis-tbx-install"><span class="std std-ref">Panels, Toolbars, and Plugins</span></a>.</p>
</div>
<p>The DEM should now be displayed on the map (if not: right-click on the DEM layer and click on <strong>Zoom to Layer(s)</strong> in the context menu) as shown in <a class="reference internal" href="#qgis-dem-basemap"><span class="std std-numref">Fig. 26</span></a>.</p>
<div class="figure align-default" id="qgis-dem-basemap">
<img alt="qgis import raster DEM basemap" src="../_images/dem-basemap.png" />
<p class="caption"><span class="caption-number">Fig. 26 </span><span class="caption-text">The imported DEM on a Google Satellite imagery basemap (source: Google / GeoBasis-DEBKG 2019). The flow direction is from left to right following the <strong>Q</strong> arrow.</span><a class="headerlink" href="#qgis-dem-basemap" title="Permalink to this image">¶</a></p>
</div>
<div class="tip admonition">
<p class="admonition-title">From LiDAR point clouds to a Raster DEM</p>
<p>Terrain survey data are mostly delivered in the shape of an x-y-z point dataset. LiDAR produces massive point clouds, which quickly overcharge even powerful computers. Therefore, LiDAR data may need to be broken down into smaller zones of less than approximately 106 points and special LiDAR point processing software (e.g., <a class="reference external" href="http://lastools.org/">LAStools</a>) may be helpful in this task. The range of possible data products and shapes from terrain survey is board and this tutorial exemplary uses a set of x-y-z points stored within a text file.</p>
</div>
<div class="admonition-openfoam-modelers admonition">
<p class="admonition-title">OpenFOAM modelers…</p>
<p>For three-dimensional (3d) modeling with OpenFOAM, the creation of a 2dm file is not necessary. Therefore, OpenFOAM users can export the terrain in QGIS directly as an <a class="reference internal" href="../documentation/glossary.html#term-STL"><span class="xref std std-term">STL</span></a> file, as described at the bottom of this section (jump to the <a class="reference internal" href="#dem2stl"><span class="std std-ref">OpenFOAM: Export DEM to STL</span></a> paragraph).</p>
</div>
</div>
<div class="section" id="basement-telemac-create-2dm-mesh">
<span id="make-2dm"></span><h2>BASEMENT / TELEMAC: Create 2dm Mesh<a class="headerlink" href="#basement-telemac-create-2dm-mesh" title="Permalink to this headline">¶</a></h2>
<p>The generation of a <a class="reference internal" href="../documentation/glossary.html#term-SMS-2dm"><span class="xref std std-term">SMS 2dm</span></a> uses the <a class="reference internal" href="#get-basemesh"><span class="std std-ref">QGIS BASEmesh plugin</span></a> and requires drawing a</p>
<ul class="simple">
<li><p><a class="reference internal" href="../geopy/use-qgis.html#create-line-shp"><span class="std std-ref">Line Shapefile</span></a> containing model boundaries and internal breaklines between model regions with different characteristics (section on <a class="reference internal" href="#boundary"><span class="std std-ref">Model Boundary and Breaklines</span></a>);</p></li>
<li><p><a class="reference internal" href="../geopy/use-qgis.html#create-line-shp"><span class="std std-ref">Line Shapefile</span></a> containing model boundaries for assigning inflow and outflow conditions (section on <a class="reference internal" href="#liquid-boundary"><span class="std std-ref">Liquid (Hydraulic) Boundaries</span></a>); and a</p></li>
<li><p><a class="reference internal" href="../geopy/use-qgis.html#create-point-shp"><span class="std std-ref">Point Shapefile</span></a> containing markers for the definition of characteristics of model regions (section on <a class="reference internal" href="#regions"><span class="std std-ref">Region Markers</span></a>).</p></li>
</ul>
<p>These two shapefiles enable to <a class="reference internal" href="#qualm"><span class="std std-ref">Create a Quality Mesh</span></a>. Ultimately, height information is <a class="reference internal" href="#qualm-interp"><span class="std std-ref">interpolated to the quality mesh</span></a> and the resulting mesh is saved as <a class="reference internal" href="../documentation/glossary.html#term-SMS-2dm"><span class="xref std std-term">SMS 2dm</span></a> file. The next sections walk through the procedure step by step with detailed explanations. Additional materials and intermediate data products are provided in the supplemental data repository (<a class="reference external" href="https://github.com/hydro-informatics/materials-bm">materials-bm</a>) for this tutorial.</p>
<div class="section" id="get-the-basemesh-plugin">
<span id="get-basemesh"></span><h3>Get the BASEmesh Plugin<a class="headerlink" href="#get-the-basemesh-plugin" title="Permalink to this headline">¶</a></h3>
<p>Install <em>BASEMENT</em>’s <em>BASEmesh</em> Plugin (instructions from the <em>BASEMENT</em> System Manual):</p>
<ul class="simple">
<li><p>Load the <em>QGIS</em> plugin manager: <strong>Plugins</strong> menu &gt; <strong>Manage and Install Plugins</strong>.</p></li>
<li><p>Go to the <strong>Settings</strong> tab.</p></li>
<li><p>Scroll to the bottom (<strong>Plugin Repositories</strong> listbox in <a class="reference internal" href="#qgis-plugins"><span class="std std-numref">Fig. 27</span></a>), click on <strong>Add…</strong>.</p></li>
<li><p>In the popup window enter:</p>
<ul>
<li><p>a name for the new repository, for instance, <code class="docutils literal notranslate"><span class="pre">BASEmesh</span> <span class="pre">Plugin</span> <span class="pre">Repository</span></code>;</p></li>
<li><p>the repository address: <a class="reference external" href="https://people.ee.ethz.ch/~basement/qgis_plugins/qgis_plugins.xml">https://people.ee.ethz.ch/~basement/qgis_plugins/qgis_plugins.xml</a>.</p></li>
</ul>
</li>
<li><p>Click <strong>OK</strong>. The new repository should now be visible in the <strong>Plugin Repositories</strong> listbox. If the connection is <strong>OK</strong>.</p></li>
</ul>
<div class="figure align-default" id="qgis-plugins">
<img alt="qgis basement plugins" src="../_images/bm-plugin.png" />
<p class="caption"><span class="caption-number">Fig. 27 </span><span class="caption-text">Add the BASEMENT repository to QGIS’ Plugins Manager.</span><a class="headerlink" href="#qgis-plugins" title="Permalink to this image">¶</a></p>
</div>
<ul class="simple">
<li><p>Still in the <strong>Plugins</strong> popup window go back to the <strong>All</strong> tab an enter <code class="docutils literal notranslate"><span class="pre">basemesh</span></code> in the search field.</p></li>
<li><p>Find the <strong>newest BASEmesh</strong> (i.e., <strong>Available version</strong> &gt;= 2.0.0) plugin and click on <strong>Install Plugin</strong>.</p></li>
<li><p><strong>TELEMAC users</strong> will also need the <strong>Crayfish</strong> plugin (find and install by typing <code class="docutils literal notranslate"><span class="pre">crayfish</span></code> in the <strong>All</strong> tab).</p></li>
<li><p>After the successful installation <strong>Close</strong> the <strong>Plugins</strong> popup window.</p></li>
<li><p>Verify that the <em>BASEmesh 2</em> plugin is now available in the <em>QGIS</em>’ <strong>Plugins</strong> menu (see <a class="reference internal" href="#qgis-pluggedin"><span class="std std-numref">Fig. 28</span></a>).</p></li>
</ul>
<div class="figure align-default" id="qgis-pluggedin">
<img alt="qgis basement plugins" src="../_images/bm-pluggedin.png" />
<p class="caption"><span class="caption-number">Fig. 28 </span><span class="caption-text">The BASEmesh 2 plugin is available in QGIS’ Plugins menu after the successful installation.</span><a class="headerlink" href="#qgis-pluggedin" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="model-boundary-and-breaklines">
<span id="boundary"></span><h3>Model Boundary and Breaklines<a class="headerlink" href="#model-boundary-and-breaklines" title="Permalink to this headline">¶</a></h3>
<p>The model boundary defines the model extent and can be divided into regions with different characteristics (e.g., roughness values) through breaklines. Breaklines indicate, for instance, channel banks and the riverbed (main channel), and need to be inside the DEM extents. Boundary lines and breaklines a stored in a <a class="reference internal" href="../geopy/use-qgis.html#create-line-shp"><span class="std std-ref">Line Shapefile</span></a> that BASEmesh uses to find both model boundaries and internal breaklines between model regions. For this purpose, <a class="reference internal" href="../geopy/use-qgis.html#create-line-shp"><span class="std std-ref">Create a Line Shapefile</span></a> with <strong>one Text Field</strong> called <strong>LineType</strong> and call it <strong>breaklines.shp</strong> (<strong>Layer</strong> &gt; <strong>Create Layer</strong> &gt; <strong>New Shapefile Layer</strong>). Click on <em>QGIS</em>’ <strong>Layers</strong> menu &gt; <strong>Create Layer</strong> &gt; <strong>New Shapefile Layer…</strong> (see <a class="reference internal" href="#qgis-new-lyr"><span class="std std-numref">Fig. 29</span></a>).</p>
<div class="figure align-default" id="qgis-new-lyr">
<img alt="qgis new layer basemesh" src="../_images/create-shp-layer.png" />
<p class="caption"><span class="caption-number">Fig. 29 </span><span class="caption-text">Create a new shapefile from QGIS’ Layers menu.</span><a class="headerlink" href="#qgis-new-lyr" title="Permalink to this image">¶</a></p>
</div>
<p>It is important that the lines do not overlap to avoid ambiguous or missing definitions of regions and to ensure that all boundary lines form closed regions (areas). Therefore, activate snapping:</p>
<ul class="simple">
<li><p>Activate the <em>Snapping Toolbar</em>: <strong>View</strong> &gt; <strong>Toolbars</strong> &gt; <strong>Snapping Toolbar</strong></p></li>
<li><p>In the <strong>Snapping toolbar</strong> &gt; <strong>Enable Snapping</strong> <img alt="../_images/snapping-horseshoe.png" src="../_images/snapping-horseshoe.png" /></p></li>
<li><p>Enable snapping for</p>
<ul>
<li><p><strong>Vertex</strong>, <strong>Segment</strong>, and <strong>Middle of Segments</strong> <img alt="../_images/snapping-vertex-segments.png" src="../_images/snapping-vertex-segments.png" />.</p></li>
<li><p><strong>Snapping on Intersections</strong> <img alt="../_images/snapping-intersection.png" src="../_images/snapping-intersection.png" />.</p></li>
</ul>
</li>
</ul>
<p>Next, start to edit <strong>breaklines.shp</strong> by clicking on the yellow pen <img alt="../_images/yellow-pen.png" src="../_images/yellow-pen.png" /> and draw the lines indicated in <a class="reference internal" href="#breaklines"><span class="std std-numref">Fig. 30</span></a> by activating <strong>Add Line Feature</strong> <img alt="../_images/sym-add-line.png" src="../_images/sym-add-line.png" />.</p>
<ul class="simple">
<li><p><strong>Boundaries of the</strong> model at the left and the right <strong>floodplain limits</strong>:</p>
<ul>
<li><p>Delineate the outer bounds of the floodplains.</p></li>
<li><p>Make sure that all points and lines are inside the <a class="reference internal" href="#get-dem"><span class="std std-ref">DEM layer</span></a>.</p></li>
<li><p>Do not cross the river (wetted area indicated by the satellite imagery basemap).</p></li>
<li><p><strong>Finalize</strong> every line with a <strong>right-click</strong>.</p></li>
<li><p>For the <strong>LineType</strong> field use text values such as <strong>boundary left/right floodplain</strong>.</p></li>
<li><p>Refer to the <strong>red lines in <a class="reference internal" href="#breaklines"><span class="std std-numref">Fig. 30</span></a></strong>.</p></li>
</ul>
</li>
<li><p><strong>Breaklines of the left bank (LB) and right bank (RB)</strong>:</p>
<ul>
<li><p>Draw lines along the wetted main channel indicated in the satellite imagery basemap.</p></li>
<li><p>Make sure that line ends perfectly coincide with the before-created floodplain boundary lines (this is where snapping helps); thus, the main channel’s hard breaklines and the floodplain boundary lines need to enclose the floodplains without any gap between the lines.</p></li>
<li><p>For the <strong>LineType</strong> field use text values such as <strong>hardline LB/RB</strong>.</p></li>
<li><p>Refer to the <strong>yellow-orange lines in <a class="reference internal" href="#breaklines"><span class="std std-numref">Fig. 30</span></a></strong> (note the delineation of the small tributaries in the top left at the left bank and in the bottom right at the right bank).</p></li>
</ul>
</li>
<li><p><strong>Breaklines of gravel banks</strong>:</p>
<ul>
<li><p>Draw lines along the gravel banks that are visible in the satellite imagery basemap in the main channel.</p></li>
<li><p>Make sure that the line ends perfectly coincide with the before-created main channel breaklines (hardlines); thus, the main channel’s hard breaklines and the gravel bank breaklines need to enclose the gravel banks without any gap between the lines.</p></li>
<li><p>For the <strong>LineType</strong> field use text values such as <strong>hardline gravel bank</strong>.</p></li>
<li><p>Refer to the <strong>green-ish lines in <a class="reference internal" href="#breaklines"><span class="std std-numref">Fig. 30</span></a></strong>.</p></li>
</ul>
</li>
<li><p>Optional: <strong>Breaklines of block ramps</strong>:</p>
<ul>
<li><p>Find the rough block ramps (effervescing waters) in the satellite imagery basemap and delineate them by drawing lines across the wetted main channel.</p></li>
<li><p>Make sure that the line ends perfectly coincide with the main channel breaklines; thus, the main channel’s hard breaklines and the block ramp breaklines need to enclose the block ramps without any gap between the lines.</p></li>
<li><p>For the <strong>LineType</strong> field use text values such as <strong>hardline sss</strong> (or anything else - the example refers to the German word <u>S</u>chütt<u>s</u>tein<u>s</u>chwelle).</p></li>
<li><p>Refer to the <strong>blue lines in <a class="reference internal" href="#breaklines"><span class="std std-numref">Fig. 30</span></a></strong>.</p></li>
</ul>
</li>
<li><p>Optional: <strong>Breakline of a sandbank</strong>:</p>
<ul>
<li><p>Find the sandbank deposit in the upper left corner in <a class="reference internal" href="#breaklines"><span class="std std-numref">Fig. 30</span></a> on the satellite imagery basemap and delineate it by drawing a smoothly curved line.</p></li>
<li><p>Make sure that the line ends perfectly coincide with the main channel breaklines and embrace a closed area without any gap between the lines.</p></li>
<li><p>For the <strong>LineType</strong> field use text values such as <strong>hardline sand</strong>.</p></li>
<li><p>Refer to the <strong>purple line</strong> in the upper left corner <strong>in <a class="reference internal" href="#breaklines"><span class="std std-numref">Fig. 30</span></a></strong>.</p></li>
</ul>
</li>
</ul>
<p>To <strong>correct drawing errors</strong> use the <strong>Vertex Tool</strong> <img alt="../_images/sym-vertex-tool.png" src="../_images/sym-vertex-tool.png" />. Finally, save the new lines (edits of <strong>breaklines.shp</strong>) by clicking on the <strong>Save Layer Edits</strong> <img alt="../_images/sym-save-edits.png" src="../_images/sym-save-edits.png" /> symbol. <strong>Stop (Toggle) Editing</strong> by clicking again on the yellow pen <img alt="../_images/yellow-pen.png" src="../_images/yellow-pen.png" /> symbol.</p>
<div class="figure align-default" id="breaklines">
<img alt="qgis basement basemesh draw breaklines boundaries" src="../_images/breaklines.png" />
<p class="caption"><span class="caption-number">Fig. 30 </span><span class="caption-text">Boundary and breaklines to draw in <strong>breaklines.shp</strong>. Left and right banks and floodplains are orientated in the flow direction (<strong>Q</strong> arrow).</span><a class="headerlink" href="#breaklines" title="Permalink to this image">¶</a></p>
</div>
<div class="tip admonition">
<p class="admonition-title">Troubles with drawing boundaries and breaklines?</p>
<p>Download the <a class="reference external" href="https://github.com/hydro-informatics/materials-bm/raw/main/shapefiles/breaklines.zip">zipped breaklines shapefile</a> shown in the above figure and unpack it into the project folder, for instance, <code class="docutils literal notranslate"><span class="pre">/Project</span> <span class="pre">Home/shapefiles/breaklines.[SHP]</span></code>.</p>
</div>
<p>The default layer style is <strong>Single Symbol</strong>. For better representation, double-click on the breaklines layer, go to the <strong>Symbology</strong> tab and select <strong>Categorized</strong> (or <strong>Graduated</strong>) instead of <strong>Single Symbol</strong> (at the very top of the <strong>Layer Properties</strong> window). In the <strong>Value</strong> field, select <strong>LineType</strong>, then click the <strong>classify</strong> button on the bottom of the <strong>Layer Properties</strong> window. The listbox will now show the <em>LineType</em> values.</p>
<div class="tip admonition">
<p class="admonition-title">Draw boundaries of complex DEMs…</p>
<p>Drawing boundaries manually around large <a class="reference internal" href="../documentation/glossary.html#term-DEM"><span class="xref std std-term">DEM</span></a>s can be very time consuming, in particular, if the raw data are a point cloud and not yet converted to a <a class="reference internal" href="../geopy/geospatial-data.html#raster"><span class="std std-ref">Gridded Cell (Raster) Data</span></a>.</p>
<p>If you are dealing with a point cloud, consider using <em>QGIS</em> <a class="reference external" href="https://docs.qgis.org/3.16/en/docs/training_manual/vector_analysis/spatial_statistics.html?highlight=convex%20hull#basic-fa-create-a-test-dataset">Convex Hull tool</a> that draws a tight bounding polygon around points.</p>
<p>If you are dealing with a large <a class="reference internal" href="../documentation/glossary.html#term-GeoTIFF"><span class="xref std std-term">GeoTIFF</span></a>, consider using QGIS’ <a class="reference external" href="https://docs.qgis.org/3.16/en/docs/training_manual/complete_analysis/raster_to_vector.html">Raster to Vector</a> tool.</p>
</div>
</div>
<div class="section" id="liquid-hydraulic-boundaries">
<span id="liquid-boundary"></span><h3>Liquid (Hydraulic) Boundaries<a class="headerlink" href="#liquid-hydraulic-boundaries" title="Permalink to this headline">¶</a></h3>
<p>The liquid boundaries define where hydraulic conditions, such as a given discharge or stage-discharge relationship, apply at the model inflow (upstream) and outflow (downstream) limits. Thus, a functional river model requires at least one inflow boundary (line) where mass flow into the model and one outflow boundary (line) where mass fluxes leave the model. For this purpose, <a class="reference internal" href="../geopy/use-qgis.html#create-line-shp"><span class="std std-ref">Create a Line Shapefile</span></a> called <strong>liquid-boundaries.shp</strong> and define <strong>two text data fields</strong> named <strong>type</strong> and <strong>stringdef</strong>. Make sure that <strong>snapping</strong> is still <strong>enabled</strong> (as above explained in the <a class="reference internal" href="#boundary"><span class="std std-ref">Model Boundary and Breaklines</span></a> section) and <strong>Toggle (Start) Editing</strong> <img alt="../_images/yellow-pen.png" src="../_images/yellow-pen.png" /> the new <strong>liquid-boundaries.shp</strong>. Then draw two lines:</p>
<ul class="simple">
<li><p>Activate <strong>Add Line Feature</strong> <img alt="../_images/sym-add-line.png" src="../_images/sym-add-line.png" />.</p></li>
<li><p>Draw an inflow boundary line (see also <a class="reference internal" href="#inflow-boundary"><span class="std std-numref">Fig. 31</span></a>):</p>
<ul>
<li><p>Zoom to the inflow region of the DEM limits, where there is a <strong>gap between</strong> the above-created <strong>floodplain boundary breaklines</strong>.</p></li>
<li><p>Start drawing a line on the left bank (left side of the below figure) and moved Eastwards (i.e., to the right) to make seven more points across the river.</p></li>
<li><p>The <strong>seventh point</strong> needs to <strong>coincide</strong> with the end of the right bank’s <strong>floodplain boundary breakline</strong>.</p></li>
<li><p>Thus, the upstream flow is coming from the right-hand side of the inflow boundary line (i.e., the upstream flow direction will be <code class="docutils literal notranslate"><span class="pre">right</span></code> for the numerical model).</p></li>
<li><p><strong>Finalize</strong> the line with a <strong>right-click</strong>, and enter <code class="docutils literal notranslate"><span class="pre">Inflow</span></code> in the <strong>type</strong> field and <code class="docutils literal notranslate"><span class="pre">inflow</span></code> in the <strong>stringdef</strong> field (the case matters).</p></li>
<li><p>To <strong>correct drawing errors</strong> use the <strong>Vertex Tool</strong> <img alt="../_images/sym-vertex-tool.png" src="../_images/sym-vertex-tool.png" />.</p></li>
</ul>
</li>
</ul>
<div class="figure align-default" id="inflow-boundary">
<img alt="qgis basemesh draw inflow boundary line" src="../_images/inflow-boundary.png" />
<p class="caption"><span class="caption-number">Fig. 31 </span><span class="caption-text">The inflow boundary line is drawn from the left to the right (i.e., the upstream flow is coming from the right-hand side of the inflow boundary line). The sequence of buttons to use is highlighted by the red boxes.</span><a class="headerlink" href="#inflow-boundary" title="Permalink to this image">¶</a></p>
</div>
<ul class="simple">
<li><p>Next, draw an outflow boundary line (see also <a class="reference internal" href="#outflow-boundary"><span class="std std-numref">Fig. 32</span></a>):</p>
<ul>
<li><p>Zoom to the outflow region of the DEM limits, where there is a <strong>gap between</strong> the above-created <strong>floodplain boundary breaklines</strong>.</p></li>
<li><p>Start drawing a line on the left bank (top of the below figure) and move Southwestwards (i.e., to the bottom) to make seven more points across the river.</p></li>
<li><p>The <strong>seventh point</strong> needs to <strong>coincide</strong> with the end of the right bank’s <strong>floodplain boundary breakline</strong>.</p></li>
<li><p>Thus, the upstream flow is coming from the right-hand side of the outflow boundary line (i.e., the upstream flow direction will be <code class="docutils literal notranslate"><span class="pre">right</span></code> for the numerical model).</p></li>
<li><p><strong>Finalize</strong> the line with a <strong>right-click</strong>, and enter <code class="docutils literal notranslate"><span class="pre">Outflow</span></code> in the <strong>type</strong> field and <code class="docutils literal notranslate"><span class="pre">outflow</span></code> in the <strong>stringdef</strong> field (the case matters).</p></li>
<li><p>To <strong>correct drawing errors</strong> use the <strong>Vertex Tool</strong> <img alt="../_images/sym-vertex-tool.png" src="../_images/sym-vertex-tool.png" />.</p></li>
</ul>
</li>
</ul>
<div class="figure align-default" id="outflow-boundary">
<img alt="qgis basemesh draw outflow boundary line" src="../_images/outflow-boundary.png" />
<p class="caption"><span class="caption-number">Fig. 32 </span><span class="caption-text">The outflow boundary line is drawn from the top to the bottom (i.e., the upstream flow is coming from the right hand-side of the outflow boundary line).</span><a class="headerlink" href="#outflow-boundary" title="Permalink to this image">¶</a></p>
</div>
<div class="important admonition">
<p class="admonition-title">Constraints of inflow and outflow boundaries</p>
<p>The inflow and outflow boundary lines must have the same number of nodes (here 7 plus 1) and no liquid boundary line may have more than 40 nodes.</p>
</div>
<p>Finally, save the liquid boundary lines (edits of <strong>liquid-boundaries.shp</strong>) by clicking on the <strong>Save Layer Edits</strong> <img alt="../_images/sym-save-edits.png" src="../_images/sym-save-edits.png" /> symbol. <strong>Stop (Toggle) Editing</strong> by clicking again on the yellow pen <img alt="../_images/yellow-pen.png" src="../_images/yellow-pen.png" /> symbol.</p>
<div class="tip admonition">
<p class="admonition-title">Troubles with drawing the liquid boundary lines?</p>
<p>Download the <a class="reference external" href="https://github.com/hydro-informatics/materials-bm/raw/main/shapefiles/liquid-boundaries.zip">zipped liquid-boundaries shapefile</a> and unpack it into the project folder, for instance, <code class="docutils literal notranslate"><span class="pre">/Project</span> <span class="pre">Home/shapefiles/liquid-boundaries.[SHP]</span></code>.</p>
</div>
<div class="note admonition">
<p class="admonition-title">stringdefs</p>
<p>The <em>stringdefs</em> field values can be directly used with <a class="reference internal" href="basement.html#chpt-basement"><span class="std std-ref">BASEMENT</span></a>, where hydraulic data (e.g., discharge, water depth, or stage-discharge relations) can be assigned to the here defined georeferenced inflow and outflow boundary lines.</p>
</div>
</div>
<div class="section" id="region-markers">
<span id="regions"></span><h3>Region Markers<a class="headerlink" href="#region-markers" title="Permalink to this headline">¶</a></h3>
<p>Region markers are placed inside regions defined by boundary lines and breaklines. Every region marker (i.e., a point somewhere in the region area) assigns, for instance, a material identifier (MATIDs) and a maximum mesh cell area. The latter option enables to define small mesh cells (mesh areas) in the active channel bed and can larger cell areas in the floodplain regions. <a class="reference internal" href="../geopy/use-qgis.html#create-point-shp"><span class="std std-ref">Create a Point Shapefile</span></a> named <strong>raster-points.shp</strong> with the following definitions (see also <a class="reference internal" href="#qgis-reg-lyr"><span class="std std-numref">Fig. 33</span></a>):</p>
<ul class="simple">
<li><p>Define the <strong>File name</strong> as <strong>region-points.shp</strong> (or similar)</p></li>
<li><p>Ensure the <strong>Geometry type</strong> is <strong>Point</strong></p></li>
<li><p>The <strong>CRS</strong> corresponds to Germany Zone 4 (<a class="reference internal" href="#start-qgis"><span class="std std-ref">see project CRS</span></a>)</p></li>
<li><p>Add three <strong>New Field</strong>s (in addition to the default <strong>Integer</strong> type <strong>ID</strong> field):</p>
<ul>
<li><p><strong>max_area</strong> = <strong>Decimal number</strong> (<strong>length</strong> = 10, <strong>precision</strong> = 3)</p></li>
<li><p><strong>MATID</strong> = <strong>Whole number</strong> (<strong>length</strong> = 3)</p></li>
<li><p><strong>type</strong> = <strong>Text data</strong> (<strong>length</strong> = 20)</p></li>
</ul>
</li>
<li><p>Click <strong>OK</strong> to create the new point shapefile.</p></li>
</ul>
<div class="figure align-default" id="qgis-reg-lyr">
<img alt="basement mesh qgis region layer points" src="../_images/bm-region-pts-create.png" />
<p class="caption"><span class="caption-number">Fig. 33 </span><span class="caption-text">Definitions and fields to be added to the region-points shapefile.</span><a class="headerlink" href="#qgis-reg-lyr" title="Permalink to this image">¶</a></p>
</div>
<p>Consider to <strong>deactivate snapping</strong> for drawing the region markers. Then, <strong>Toggle (Start) Editing</strong> <img alt="../_images/yellow-pen.png" src="../_images/yellow-pen.png" /> the new <strong>region-points.shp</strong> file and activate <strong>Add Point Feature</strong> <img alt="../_images/sym-add-point.png" src="../_images/sym-add-point.png" />. Draw one point in every area section that is enclosed by breaklines and (liquid) boundary lines. Depending on the apparent area type from the satellite imagery basemap, assign one of the five regions listed in <a class="reference internal" href="#region-defs"><span class="std std-numref">Tab. 1</span></a> to every point.</p>
<table class="table" id="region-defs">
<caption><span class="caption-number">Table 1 </span><span class="caption-text">Region names and their <strong>max_area</strong>, <strong>MATID</strong>, and <strong>type</strong> field values.</span><a class="headerlink" href="#region-defs" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 17%" />
<col style="width: 17%" />
<col style="width: 17%" />
<col style="width: 17%" />
<col style="width: 17%" />
<col style="width: 17%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Region</p></th>
<th class="head"><p>Riverbed</p></th>
<th class="head"><p>Block ramps</p></th>
<th class="head"><p>Gravel banks</p></th>
<th class="head"><p>Floodplains</p></th>
<th class="head"><p>Sand</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><strong>max_area</strong></p></td>
<td><p>25.0</p></td>
<td><p>20.0</p></td>
<td><p>25.0</p></td>
<td><p>80.0</p></td>
<td><p>20.0</p></td>
</tr>
<tr class="row-odd"><td><p><strong>MATID</strong></p></td>
<td><p>1</p></td>
<td><p>2</p></td>
<td><p>3</p></td>
<td><p>4</p></td>
<td><p>5</p></td>
</tr>
<tr class="row-even"><td><p><strong>type</strong></p></td>
<td><p>riverbed</p></td>
<td><p>block_ramp</p></td>
<td><p>gravel_bank</p></td>
<td><p>floodplain</p></td>
<td><p>sand_deposit</p></td>
</tr>
</tbody>
</table>
<p>After drawing a point in every closed area, save the region point markers (edits of <strong>region-points.shp</strong>) by clicking on the <strong>Save Layer Edits</strong> <img alt="../_images/sym-save-edits.png" src="../_images/sym-save-edits.png" /> symbol. <strong>Stop (Toggle) Editing</strong> by clicking again on the yellow pen <img alt="../_images/yellow-pen.png" src="../_images/yellow-pen.png" /> symbol. <a class="reference internal" href="#qgis-reg-pts"><span class="std std-numref">Figure 34</span></a> shows an example for region marker points within the areas delineated by the breaklines.</p>
<div class="figure align-default" id="qgis-reg-pts">
<img alt="basemesh region points" src="../_images/bm-region-pts-map.png" />
<p class="caption"><span class="caption-number">Fig. 34 </span><span class="caption-text">Example for region point markers in the project boundaries.</span><a class="headerlink" href="#qgis-reg-pts" title="Permalink to this image">¶</a></p>
</div>
<div class="tip admonition">
<p class="admonition-title">Troubles with drawing the region marker points?</p>
<p>Download the <a class="reference external" href="https://github.com/hydro-informatics/materials-bm/raw/main/shapefiles/region-points.zip">zipped region-points shapefile</a> and unpack it into the project folder, for instance, <code class="docutils literal notranslate"><span class="pre">/Project</span> <span class="pre">Home/shapefiles/region-points.[SHP]</span></code>.</p>
</div>
</div>
<div class="section" id="create-a-quality-mesh">
<span id="qualm"></span><h3>Create a Quality Mesh<a class="headerlink" href="#create-a-quality-mesh" title="Permalink to this headline">¶</a></h3>
<p><em>BASEmesh</em>’s quality mesh tool creates a computationally efficient triangular mesh based on <span id="id1">Shewchuk [<a class="reference internal" href="../documentation/bibliography.html#id1338">She96</a>]</span> and within the above-defined model boundaries.  The tools associates mesh properties with the regions shapefile ([see above section on <a class="reference internal" href="#regions"><span class="std std-ref">Region Markers</span></a>), but it does not include elevation data. Thus, after generating a quality mesh, elevation information needs to be added. This section explains the quality mesh generation and the next section features the interpolation of bottom elevations.</p>
<p>In <em>QGIS</em>’ <strong>Plugins</strong> menu, click on <strong>BASEmesh 2</strong> &gt; <strong>QUALITY MESHING</strong> to open the quality mesh tool. Make the following settings in the popup window (see also <a class="reference internal" href="#qgis-qualm"><span class="std std-numref">Fig. 35</span></a>):</p>
<ul class="simple">
<li><p>Triangulation constraints frame:</p>
<ul>
<li><p><strong>Breaklines</strong> = <strong>breaklines</strong> (see <a class="reference internal" href="#boundary"><span class="std std-ref">Model Boundary and Breaklines</span></a>).</p></li>
<li><p>Keep all other defaults.</p></li>
</ul>
</li>
<li><p>Regions frame:</p>
<ul>
<li><p><strong>Activate the Regions</strong> checkbox.</p></li>
<li><p><strong>Region marker layer</strong> = <strong>regions-points</strong> (see <a class="reference internal" href="#regions"><span class="std std-ref">Region Markers</span></a>).</p></li>
<li><p><strong>Activate the MATID field</strong> checkbox and select the <em>regions-points</em> shapefile’s <strong>MATID field</strong>.</p></li>
<li><p><strong>Activate the Maximum area field</strong> checkbox and select the <em>regions-points</em> shapefile’s <strong>max_area field</strong>.</p></li>
</ul>
</li>
<li><p>Mesh domain frame: keep defaults.</p></li>
<li><p>String definitions frame:</p>
<ul>
<li><p><strong>Activate the String definitions</strong> checkbox.</p></li>
<li><p><strong>String definitions layer</strong> = <strong>liquid boundaries</strong>.</p></li>
<li><p><strong>String definitions ID field</strong> =  <strong>stringdef</strong>.</p></li>
<li><p><strong>Activate the Include in 2DM node strings (BASEMENT 3)</strong> checkbox.</p></li>
<li><p>Ignore all BASEMENT 2.8 options.</p></li>
</ul>
</li>
<li><p>Settings frame: keep defaults.</p></li>
<li><p>Output frame:</p>
<ul>
<li><p>Click on the <strong>Browse…</strong> button and define a <strong>2dm</strong> file name in the <code class="docutils literal notranslate"><span class="pre">/Project</span> <span class="pre">Home/</span></code> directory, such as <strong>prepro-tutorial_quality-mesh-interp.2dm</strong>.</p></li>
</ul>
</li>
<li><p>Click on the <strong>Run</strong> button to create the quality mesh.</p></li>
</ul>
<div class="figure align-default" id="qgis-qualm">
<img alt="basement qgis quality mesh tin" src="../_images/bm-quality-meshing-success.png" />
<p class="caption"><span class="caption-number">Fig. 35 </span><span class="caption-text">Definitions to be made in BASEmesh’s Quality meshing tool.</span><a class="headerlink" href="#qgis-qualm" title="Permalink to this image">¶</a></p>
</div>
<p>Quality meshing may take time. After a successful mesh generation the file <strong>prepro-tutorial_quality-mesh-interp.2dm</strong> will have been generated.</p>
</div>
<div class="section" id="interpolate-bottom-elevation-to-quality-mesh">
<span id="qualm-interp"></span><h3>Interpolate Bottom Elevation to Quality Mesh<a class="headerlink" href="#interpolate-bottom-elevation-to-quality-mesh" title="Permalink to this headline">¶</a></h3>
<p>The <em>BASEmesh</em> plugin’s <strong>Interpolation</strong> tool projects bottom elevation data onto the quality mesh by interpolation from another mesh or a <a class="reference internal" href="../documentation/glossary.html#term-DEM"><span class="xref std std-term">DEM</span></a> <a class="reference internal" href="../geopy/geospatial-data.html#raster"><span class="std std-ref">Gridded Cell (Raster) Data</span></a>. Here, we use the <a class="reference internal" href="#get-dem"><span class="std std-ref">above-introduced DEM GeoTIFF</span></a>. To run the interpolation, open <em>BASEmesh</em>’s <strong>Interpolation</strong> tool (<em>QGIS</em> <strong>Plugins</strong> menu &gt; <strong>BASEmesh 2</strong> &gt; <strong>Interpolation</strong>) and make the following settings (see also <a class="reference internal" href="#qgis-qualm-interp"><span class="std std-numref">Fig. 36</span></a>):</p>
<ul class="simple">
<li><p>In the <strong>Mesh layer to interpolate</strong> frame, select <strong>prepro-tutorial_quality-mesh</strong>.</p></li>
<li><p>In the <strong>Basic</strong> tab find the <strong>Elevation source</strong> frame and activate the <strong>Activation via DEM (Raster)</strong> radio button.</p></li>
<li><p>Select <strong>dem.tif</strong> GeoTIFF (see <a class="reference internal" href="#get-dem"><span class="std std-ref">Load DEM</span></a> section) as <strong>Raster layer</strong>.</p></li>
<li><p>In the <strong>Output</strong> frame click on the <strong>Browse</strong> button to define an output mesh name in the <code class="docutils literal notranslate"><span class="pre">/Project</span> <span class="pre">Home/</span></code> directory, for example, <strong>prepro-tutorial_quality-mesh-interp.2dm</strong></p></li>
<li><p>Click <strong>Run</strong> to create the height-interpolated mesh.</p></li>
</ul>
<div class="figure align-default" id="qgis-qualm-interp">
<img alt="qgis quality mesh interpolation basement" src="../_images/bm-mesh-interpolation.png" />
<p class="caption"><span class="caption-number">Fig. 36 </span><span class="caption-text">BASEmesh’s Z-value (height) interpolation tool and setup to assign bottom elevation values to the quality mesh.</span><a class="headerlink" href="#qgis-qualm-interp" title="Permalink to this image">¶</a></p>
</div>
<p>After the elevation interpolation, verify that the elevations are correctly assigned (i.e., the <strong>Bed Elevation</strong> should have taken values between <strong>367</strong> and <strong>387</strong> m a.s.l.). To modify the layer visualization (symbology) double-click on the new <strong>prepro-tutorial_quality-mesh-interp</strong> and go to the <strong>Symbology</strong> ribbon. Select <strong>Graduated</strong> at the very top of the window, set the <strong>Value</strong> to Z, <strong>Method</strong> to COLOR, choose a color ramp, and click on the <strong>classify</strong> bottom (lower part of the window). Click on <strong>Apply</strong> and <strong>OK</strong> to close the symbology settings. <a class="reference internal" href="#qgis-verify-qualm"><span class="std std-numref">Figure 37</span></a> shows an example visualization of the height-interpolated mesh.</p>
<div class="figure align-default" id="qgis-verify-qualm">
<img alt="basemesh verify interpolated quality mesh" src="../_images/bm-mesh-interp-success.png" />
<p class="caption"><span class="caption-number">Fig. 37 </span><span class="caption-text">Verify elevation interpolation using graduated color ramps.</span><a class="headerlink" href="#qgis-verify-qualm" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="usage-with-basement">
<span id="qgis4bm"></span><h3>Usage with BASEMENT<a class="headerlink" href="#usage-with-basement" title="Permalink to this headline">¶</a></h3>
<p>The 2dm mesh file produced in this tutorial can be directly used with <a class="reference internal" href="basement.html#chpt-basement"><span class="std std-ref">BASEMENT</span></a>, where only the definition of properties of the geometric (e.g., roughness coefficients) and liquid (e.g., discharges) are required as explained later.</p>
</div>
<div class="section" id="usage-with-telemac">
<span id="qgis4tm"></span><h3>Usage with TELEMAC<a class="headerlink" href="#usage-with-telemac" title="Permalink to this headline">¶</a></h3>
<p>For the usage with <a class="reference internal" href="telemac2d.html#chpt-telemac2d"><span class="std std-ref">Telemac2d</span></a> (or <a class="reference internal" href="telemac3d.html#chpt-telemac3d"><span class="std std-ref">Telemac3d</span></a>), the 2dm file requires a conversion to the serafin/selafin (<code class="docutils literal notranslate"><span class="pre">*.slf</span></code>) file format that can be done with the <strong>Crayfish</strong> plugin.</p>
<div class="admonition-install-the-crayfish-plugin admonition">
<p class="admonition-title">Install the Crayfish plugin</p>
<p>Install the <em>Crayfish</em> plugin from QGIS’ <strong>Plugins</strong> menu &gt; <strong>Manage and Install Plugins…</strong> enter <code class="docutils literal notranslate"><span class="pre">crayfish</span></code> and install the latest version. After the installation, the <em>Crayfish</em> plugin is available at the bottom of QGIS’ <strong>Processing Toolbox</strong> panel.</p>
</div>
<p>In QGIS’ <strong>Mesh</strong> menu click on <strong>Mesh calculator</strong> to open the <strong>Mesh calculator</strong> window (<a class="reference internal" href="#qgis-mesh-calc"><span class="std std-numref">Fig. 38</span></a> - do not use the Crayfish plugin’s Mesh Calculator from the Processing Toolbox) and make the following settings:</p>
<ul class="simple">
<li><p>Define an <strong>Exported dataset group file</strong> (e.g., in the tutorial project folder) and type a file name such as <strong>qgis-mesh4telemac.slf</strong> (the file ending is important to specify the <strong>MDAL</strong> file type).</p></li>
</ul>
<div class="figure align-default" id="qgis-mesh-calc">
<img alt="basement export stl demto3d printing dem raster" src="../_images/mesh-calculator.png" />
<p class="caption"><span class="caption-number">Fig. 38 </span><span class="caption-text">Setup the Mesh Calculator to export the file in SLF format.</span><a class="headerlink" href="#qgis-mesh-calc" title="Permalink to this image">¶</a></p>
</div>
</div>
</div>
<div class="section" id="openfoam-export-dem-to-stl">
<span id="dem2stl"></span><h2>OpenFOAM: Export DEM to STL<a class="headerlink" href="#openfoam-export-dem-to-stl" title="Permalink to this headline">¶</a></h2>
<div class="admonition-temporary-solution admonition">
<p class="admonition-title">Temporary solution</p>
<p>The export to <a class="reference internal" href="../documentation/glossary.html#term-STL"><span class="xref std std-term">STL</span></a> for modeling with OpenFOAM is a weak solution that will be substituted in future versions of this eBook by exporting a mesh with the <a class="reference external" href="http://geuz.org/gmsh">GMSH</a> plugin.</p>
</div>
<p>The <a class="reference internal" href="../documentation/glossary.html#term-STL"><span class="xref std std-term">STL</span></a> (standard tessellation language) file format is native to CAD software and particularly used for the representation of three-dimensional (3d) structures in the form of unstructured triangulated surfaces. <a class="reference internal" href="../documentation/glossary.html#term-STL"><span class="xref std std-term">STL</span></a> files can be read by pre-processing software for OpenFOAM and this section explains how to convert a GeoTIFF DEM into an <a class="reference internal" href="../documentation/glossary.html#term-STL"><span class="xref std std-term">STL</span></a> file.</p>
<p>The export requires the <strong>DEMto3D</strong> plugin, which can be installed in <em>QGIS</em> as follows:</p>
<ul class="simple">
<li><p>Load the <em>QGIS</em> plugin manager: <strong>Plugins</strong> menu &gt; <strong>Manage and Install Plugins</strong>.</p></li>
<li><p>Make sure the <strong>All</strong> tab is active and enter <code class="docutils literal notranslate"><span class="pre">DEMto3D</span></code>.</p></li>
<li><p>Click on <strong>Install Plugin</strong>.</p></li>
<li><p>Close the Plugin Manager after the successful installation.</p></li>
</ul>
<p>Following the instructions in the above section on importing <a class="reference internal" href="#get-dem"><span class="std std-ref">Load DEM</span></a>, add the <a class="reference external" href="https://github.com/hydro-informatics/materials-bm/raw/main/rasters/dem-tif">example DEM GeoTIFF</a> as project layer in <em>QGIS</em>. Then export the DEM to <a class="reference internal" href="../documentation/glossary.html#term-STL"><span class="xref std std-term">STL</span></a> by opening the DEM 3D printing window from <strong>Rasters</strong> &gt; <strong>DEMto3D</strong> &gt; <strong>DEM 3D printing</strong>. In the popup window (see also <a class="reference internal" href="#qgis-dem3d"><span class="std std-numref">Fig. 39</span></a>):</p>
<ul class="simple">
<li><p>Select the <code class="docutils literal notranslate"><span class="pre">inn...</span></code> DEM as <strong>Layer to print</strong></p></li>
<li><p>For <strong>Print extent</strong> find the <strong>Select layer extent</strong> symbol and select the <code class="docutils literal notranslate"><span class="pre">inn...</span></code> DEM layer.</p></li>
<li><p>In the <strong>Model size</strong> frame set (approximately - must not be exactly the same):</p>
<ul>
<li><p><strong>Spacing</strong> to 2.83 (mm)</p></li>
<li><p><strong>Width</strong> to 2621.78 (mm)</p></li>
<li><p><strong>Length</strong> to 2000 (mm)</p></li>
</ul>
</li>
<li><p>In the <strong>Model height</strong> frame set the <strong>Height</strong> to 367 (m).</p></li>
<li><p>Click on <strong>Export to STL</strong> &gt; <strong>Yes</strong> &gt; define directory and name.</p></li>
</ul>
<div class="warning admonition">
<p class="admonition-title">Troubleshoot <em>No visible raster loaded</em></p>
<p>This error message indicates that the DEM GeoTIFF is not correctly loaded or not activated in the Layers Panel. Re-read or watch the tutorial on <a class="reference internal" href="../geopy/use-qgis.html#qgis-tbx-install"><span class="std std-ref">Panels, Toolbars, and Plugins</span></a>.</p>
</div>
<div class="figure align-default" id="qgis-dem3d">
<img alt="basement export stl demto3d printing dem raster" src="../_images/dem3d-printing.png" />
<p class="caption"><span class="caption-number">Fig. 39 </span><span class="caption-text">Setup the DEM 3D printing properties.</span><a class="headerlink" href="#qgis-dem3d" title="Permalink to this image">¶</a></p>
</div>
<p>The export starts and will take approximately 1-2 minutes. The resulting <strong>STL</strong> file can be opened with CAD software such as <a class="reference internal" href="../get-started/install-openfoam.html#salome-install"><span class="std std-ref">SALOME</span></a> modules or <a class="reference internal" href="../get-started/install-openfoam.html#freecad-install"><span class="std std-ref">FreeCAD</span></a>. The result looks similar to <a class="reference internal" href="#qgis-stl-exported"><span class="std std-numref">Fig. 40</span></a> (depending on the <strong>Height (m)</strong> value used).</p>
<div class="figure align-default" id="qgis-stl-exported">
<img alt="basement export stl" src="../_images/stl-exported.png" />
<p class="caption"><span class="caption-number">Fig. 40 </span><span class="caption-text">The resulting stl file of the DEM.</span><a class="headerlink" href="#qgis-stl-exported" title="Permalink to this image">¶</a></p>
</div>
</div>
<div class="section" id="other-mesh-generator-plugins">
<h2>Other Mesh Generator Plugins<a class="headerlink" href="#other-mesh-generator-plugins" title="Permalink to this headline">¶</a></h2>
<p>BASEmesh is only one (very well working) mesh generator for QGIS and <a class="reference internal" href="#tab-mesh-plugins"><span class="std std-numref">Tab. 2</span></a> lists of other plugins for generating computational meshes for numerical models along with target file formats and models</p>
<table class="table" id="tab-mesh-plugins">
<caption><span class="caption-number">Table 2 </span><span class="caption-text">A list of QGIS mesh generator plugins.</span><a class="headerlink" href="#tab-mesh-plugins" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
<col style="width: 25%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p>Mesh Plugin Name and Link</p></th>
<th class="head"><p>Model Compatibility</p></th>
<th class="head"><p>Output Mesh File Format</p></th>
<th class="head"><p>Mesh Characteristics</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p><a class="reference external" href="http://geuz.org/gmsh">GMSH</a> (<a class="reference external" href="https://github.com/ccorail/qgis-gmsh/wiki">Wiki</a>)</p></td>
<td><p><a class="reference external" href="https://www.opencascade.com/open-cascade-technology/">Open CASCADE Technology</a> / <a class="reference internal" href="../get-started/install-openfoam.html#openfoam-install"><span class="std std-ref">OpenFOAM</span></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">*.geo</span></code>, <code class="docutils literal notranslate"><span class="pre">*.stl</span></code>, <code class="docutils literal notranslate"><span class="pre">*.msh</span></code></p></td>
<td><p>3d finite elements (<a class="reference external" href="http://ngsolve.org/">Netgen</a> and <a class="reference external" href="https://www.mmgtools.org/">Mmg3d</a>), compatibility with <a class="reference internal" href="../get-started/install-openfoam.html#salome-install"><span class="std std-ref">SALOME</span></a></p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://plugins.qgis.org/plugins/gribdownloader/">QGribDownloader</a></p></td>
<td><p><a class="reference external" href="https://opengribs.org/">OpenGribs / XyGrib</a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">*.GRIB</span></code></p></td>
<td><p>Purpose: Meteorological/atmospheric modelling</p></td>
</tr>
<tr class="row-even"><td><p><a class="reference external" href="https://plugins.qgis.org/plugins/tuflow/">TUFLOW</a></p></td>
<td><p><a class="reference external" href="https://tuflow.com/">TUFLOW</a> (proprietary)</p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">*.2dm</span></code> (among others), conversion to <code class="docutils literal notranslate"><span class="pre">.slf</span></code> possible with Crayfish</p></td>
<td><p>TUFLOW automatically generates meshes (finite volumes / finite differences)</p></td>
</tr>
<tr class="row-odd"><td><p><a class="reference external" href="https://github.com/jdugge/MeshTools">MeshTools</a></p></td>
<td><p><a class="reference internal" href="basement.html#chpt-basement"><span class="std std-ref">BASEMENT</span></a>, Hydro FT/AS (proprietary), indirectly: <a class="reference internal" href="telemac.html#chpt-telemac"><span class="std std-ref">TELEMAC</span></a></p></td>
<td><p><code class="docutils literal notranslate"><span class="pre">*.2dm</span></code> (conversion to <code class="docutils literal notranslate"><span class="pre">.slf</span></code> possible with Crayfish)</p></td>
<td><p>Tweaks into multiple mesh algorithms (among others: <span id="id2">Shewchuk [<a class="reference internal" href="../documentation/bibliography.html#id1338">She96</a>]</span>)</p></td>
</tr>
</tbody>
</table>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "hydro-informatics/hydro-informatics.github.io",
            ref: "gh-pages",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./numerics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
        <div class='prev-next-bottom'>
            
    <a class='left-prev' id="prev-link" href="numerical-modeling.html" title="previous page">Principles</a>
    <a class='right-next' id="next-link" href="basement.html" title="next page">BASEMENT</a>

        </div>
        
        </div>
    </div>
    <footer class="footer mt-5 mt-md-0">
    <div class="container">
      <p>
        
          By Sebastian Schwindt<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>
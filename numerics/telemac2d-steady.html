
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Steady 2d &#8212; Hydro-Informatics</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet">
  <link href="../_static/css/index.ff1ffe594081f20da1ef19478df9384b.css" rel="stylesheet">

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/tabs.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.be7d3bbb2ef33a8344ce.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script src="../_static/tabs.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script defer="defer" src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-mml-chtml.js"></script>
    <script>window.MathJax = {"TeX": {"Macros": {"N": "\\mathbb{N}", "floor": ["\\lfloor#1\\rfloor", 1], "bmat": ["\\left[\\begin{array}"], "emat": ["\\end{array}\\right]"]}}, "options": {"processHtmlClass": "tex2jax_process|mathjax_process|math|output_area"}}</script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe,.cell"
        const thebe_selector_input = "pre,.cell_input div.highlight"
        const thebe_selector_output = ".output,.cell_output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="canonical" href="https://hydro-informatics.com/numerics/telemac2d-steady.html" />
    <link rel="shortcut icon" href="../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Unsteady 2d" href="telemac2d-unsteady.html" />
    <link rel="prev" title="Telemac2d" href="telemac2d.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="None">
    

    <!-- Google Analytics -->
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
        <!-- `logo` is deprecated in Sphinx 4.0, so remove this when we stop supporting 3 -->
        
      
      
      <img src="../_static/icon.jpg" class="logo" alt="logo">
      
      
      <h1 class="site-logo" id="site-title">Hydro-Informatics</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Get Started
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../lectures/classroom.html">
   The Virtual Classroom
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/principles.html">
     Principles
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/lectures.html">
     Lectures and Exercises
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../lectures/take_seat.html">
     Take a Seat
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../get-started/software.html">
   Software Resources
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/vm.html">
     Virtual Machines and Linux
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/ide.html">
     Integrated Development Environments (IDEs)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../python-basics/pyinstall.html">
     Python (Installation)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/git.html">
     Version Control : git
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/geo.html">
     Geospatial Software
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/install-openfoam.html">
     OpenFOAM (Installation)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/install-telemac.html">
     TELEMAC (Installation)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../get-started/others.html">
     Other Software Resources
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Python Basics
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../python-basics/python.html">
   First Steps
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pybase.html">
     Hello Data Types
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pyerror.html">
     Errors, Logging, and Debugging
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pyloop.html">
     Loops and Conditional Statements
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../python-basics/modularize.html">
   Object Orientation
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pyfun.html">
     Functions
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pypckg.html">
     Packages, Modules and Libraries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/classes.html">
     Object Orientation and Classes
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../python-basics/data-handling.html">
   Data and File Handling
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-5" name="toctree-checkbox-5" type="checkbox"/>
  <label for="toctree-checkbox-5">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pynum.html">
     Data Files, NumPy &amp; Pandas
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/xml.html">
     Structured Data (XML, xlsx &amp; JSON)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/pyplot.html">
     Plotting
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../jupyter/pystyle.html">
   Code Style and Conventions
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../jupyter/gui.html">
   Graphical User Interfaces (GUIs)
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../exercises/python-exercises.html">
   Python Exercises
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-6" name="toctree-checkbox-6" type="checkbox"/>
  <label for="toctree-checkbox-6">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-ms.html">
     1d Hydraulics (Manning-Strickler Formula)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-sp.html">
     Reservoir Volume (Sequent Peak Algorithm)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-floods.html">
     Flood Return Periods
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-sediment.html">
     1d Sediment Transport
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-gui.html">
     Create a GUI
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Geospatial Analysis
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../geopy/geospatial-data.html">
   Geospatial Data
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../geopy/use-qgis.html">
   QGIS Tutorial
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../geopy/geo-python.html">
   Geospatial Python
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-7" name="toctree-checkbox-7" type="checkbox"/>
  <label for="toctree-checkbox-7">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../geopy/geo-pckg.html">
     Geospatial Open Source Python Libraries
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/geo-shp.html">
     Shapefile (Vector) Handling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/geo-raster.html">
     Raster (Grid) Handling
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/geo-convert.html">
     Vectorize and Rasterize
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../jupyter/geo-arcpy.html">
     The Commercial arcpy Library
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../exercises/geo-exercises.html">
   Exercises
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-8" name="toctree-checkbox-8" type="checkbox"/>
  <label for="toctree-checkbox-8">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-geco.html">
     Script a Habitat Suitability Map
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Data Science
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../datascience/data-science.html">
   Fundamentals (Coming soon)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-9" name="toctree-checkbox-9" type="checkbox"/>
  <label for="toctree-checkbox-9">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../datascience/py-requirements.html">
     Python Requirements
    </a>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="../datascience/data-prepro.html">
     Data Pre-Processing
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-10" name="toctree-checkbox-10" type="checkbox"/>
    <label for="toctree-checkbox-10">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="../datascience/data-types.html">
       The Nature of Data
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../datascience/data-cleaning.html">
       Dataset Cleaning
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="../datascience/dimensional-analysis.html">
       Dimensional Analysis
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../datascience/theory.html">
   Techniques (Coming soon)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-11" name="toctree-checkbox-11" type="checkbox"/>
  <label for="toctree-checkbox-11">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../datascience/techniques.html">
     Overview of Fundamental Techniques
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../datascience/calibrate-validate.html">
     Model Calibration and Validation
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../datascience/morphology-predictor-svm.html">
     Support Vector Machine (SVM)
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Numerical Modeling
 </span>
</p>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="numerical-modeling.html">
   Principles
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="basement.html">
   BASEMENT
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-12" name="toctree-checkbox-12" type="checkbox"/>
  <label for="toctree-checkbox-12">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="pre-qgis-bm.html">
     Pre-processing with QGIS
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="basement2d.html">
     Steady 2d Simulation and Post-processing
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active has-children">
  <a class="reference internal" href="telemac.html">
   TELEMAC
  </a>
  <input checked="" class="toctree-checkbox" id="toctree-checkbox-13" name="toctree-checkbox-13" type="checkbox"/>
  <label for="toctree-checkbox-13">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul class="current">
   <li class="toctree-l2">
    <a class="reference internal" href="pre-slf-tm.html">
     Pre-processing
    </a>
   </li>
   <li class="toctree-l2 current active has-children">
    <a class="reference internal" href="telemac2d.html">
     Telemac2d
    </a>
    <input checked="" class="toctree-checkbox" id="toctree-checkbox-14" name="toctree-checkbox-14" type="checkbox"/>
    <label for="toctree-checkbox-14">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul class="current">
     <li class="toctree-l3 current active">
      <a class="current reference internal" href="#">
       Steady 2d
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="telemac2d-unsteady.html">
       Unsteady 2d
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="telemac3d.html">
     Telemac3d
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-15" name="toctree-checkbox-15" type="checkbox"/>
    <label for="toctree-checkbox-15">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="telemac3d-slf.html">
       Steady 3d (SLF - Selafin)
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="telemac3d-med.html">
       Steady 3d (MED and Salome)
      </a>
     </li>
    </ul>
   </li>
   <li class="toctree-l2 has-children">
    <a class="reference internal" href="telemac-gaia.html">
     Gaia (Morphodynamics)
    </a>
    <input class="toctree-checkbox" id="toctree-checkbox-16" name="toctree-checkbox-16" type="checkbox"/>
    <label for="toctree-checkbox-16">
     <i class="fas fa-chevron-down">
     </i>
    </label>
    <ul>
     <li class="toctree-l3">
      <a class="reference internal" href="gaia-coupling.html">
       Introduction and Coupling
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="gaia-basics.html">
       Basic Setup of Gaia
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="gaia-bedload.html">
       Bedload
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="gaia-suspended.html">
       Suspended Load
      </a>
     </li>
     <li class="toctree-l3">
      <a class="reference internal" href="gaia-run.html">
       Run and Analyze
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Documentation
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../documentation/documentation.html">
   How to Markdown and Document
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../documentation/glossary.html">
   Glossary
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../documentation/notation.html">
   Notation
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../documentation/bibliography.html">
   References
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../exercises/docs-exercises.html">
   Exercises
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-17" name="toctree-checkbox-17" type="checkbox"/>
  <label for="toctree-checkbox-17">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../exercises/ex-git.html">
     Git and Markdown
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Troubleshoot
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../troubleshoot/dbg-programming.html">
   Programming Tools and IDEs
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-18" name="toctree-checkbox-18" type="checkbox"/>
  <label for="toctree-checkbox-18">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-anaconda.html">
     Debugging Anaconda
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-python.html">
     Debugging Python Code
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-jupyter.html">
     Debugging Jupyter
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../troubleshoot/dbg-numerical-models.html">
   Numerical Models
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-19" name="toctree-checkbox-19" type="checkbox"/>
  <label for="toctree-checkbox-19">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-basement.html">
     Debugging BASEMENT
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-telemac.html">
     Debugging TELEMAC
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../troubleshoot/dbg-os.html">
   Operating Systems (Linux and VMs)
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-20" name="toctree-checkbox-20" type="checkbox"/>
  <label for="toctree-checkbox-20">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-linux.html">
     Debugging Debian Linux
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../troubleshoot/dbg-vm.html">
     Debugging Virtual Machines
    </a>
   </li>
  </ul>
 </li>
</ul>
<p aria-level="2" class="caption" role="heading">
 <span class="caption-text">
  Disclaimer and License
 </span>
</p>
<ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../terms/license.html">
   License
  </a>
 </li>
 <li class="toctree-l1">
  <a class="reference internal" href="../terms/disclaimer.html">
   Disclaimer
  </a>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Written by <a href="https://sebastian-schwindt.org">Sebastian Schwindt</a> and Ricardo Barros
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/numerics/telemac2d-steady.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/hydro-informatics/jupyter-python-course"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#">
   Steady 2d
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#get-started">
     Get Started
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#steering-file-cas">
     Steering File (CAS)
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#overview-of-the-cas-file">
       Overview of the CAS File
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#general-parameters">
       General Parameters
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#general-numerical-parameters">
       General Numerical Parameters
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#numerical-parameters-for-finite-elements">
       Numerical Parameters for Finite Elements
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#numerical-parameters-for-finite-volumes">
       Numerical Parameters for Finite Volumes
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#numerical-solver-parameters">
       Numerical Solver Parameters
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#numerical-accuracy">
       Numerical Accuracy
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#tidal-flats">
       Tidal Flats
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#matrix-handling">
       Matrix Handling
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#friction-boundary-conditions">
       Friction Boundary Conditions
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#liquid-boundary-conditions">
       Liquid Boundary Conditions
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#initial-conditions">
       Initial Conditions
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#turbulence">
       Turbulence
      </a>
     </li>
    </ul>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#run-telemac2d">
     Run Telemac2d
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#load-environment-and-files">
       Load environment and files
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#post-processing">
   Post-processing
  </a>
  <ul class="visible nav section-nav flex-column">
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#load-results">
     Load Results
    </a>
   </li>
   <li class="toc-h2 nav-item toc-entry">
    <a class="reference internal nav-link" href="#analyze-results">
     Analyze Results
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#export-geotiff">
       Export GeoTIFF
      </a>
     </li>
     <li class="toc-h3 nav-item toc-entry">
      <a class="reference internal nav-link" href="#verify-discharge-convergence">
       Verify Discharge Convergence
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#re-initialize-dry">
   Re-Initialize Dry
  </a>
 </li>
 <li class="toc-h1 nav-item toc-entry">
  <a class="reference internal nav-link" href="#d-calibration-parameters">
   2d Calibration Parameters
  </a>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="steady-2d">
<span id="telemac2d-steady"></span><h1>Steady 2d<a class="headerlink" href="#steady-2d" title="Permalink to this headline">¶</a></h1>
<div class="admonition-requirements admonition">
<p class="admonition-title">Requirements</p>
<p>This tutorial is designed for <strong>advanced beginners</strong> and before diving into this tutorial make sure to complete the <a class="reference internal" href="pre-slf-tm.html#slf-prepro-tm"><span class="std std-ref">TELEMAC pre-processing tutorial</span></a>.</p>
<p>The case featured in this tutorial was established with the following software:</p>
<ul class="simple">
<li><p><a class="reference internal" href="../get-started/others.html#npp"><span class="std std-ref">Notepad++</span></a> text editor (any other text editor will do just as well.)</p></li>
<li><p>TELEMAC v8p2r0 (<a class="reference internal" href="../get-started/install-telemac.html#modular-install"><span class="std std-ref">stand-alone installation</span></a>).</p></li>
<li><p><a class="reference internal" href="../get-started/geo.html#qgis-install"><span class="std std-ref">QGIS</span></a> and the <a class="reference internal" href="pre-slf-tm.html#tm-qgis-plugins"><span class="std std-ref">PostTelemac plugin</span></a>.</p></li>
<li><p>Debian Linux 10 (Buster) installed on a Virtual Machine (read more in the <a class="reference internal" href="../get-started/vm.html#chpt-vm-linux"><span class="std std-ref">software chapter</span></a>).</p></li>
</ul>
</div>
<div class="section" id="get-started">
<h2>Get Started<a class="headerlink" href="#get-started" title="Permalink to this headline">¶</a></h2>
<p>This section builds on the SELAFIN (<code class="docutils literal notranslate"><span class="pre">*.slf</span></code>) geometry and the Conlim (<code class="docutils literal notranslate"><span class="pre">*.cli</span></code>) boundary condition files that result from the <a class="reference internal" href="pre-slf-tm.html#slf-prepro-tm"><span class="std std-ref">TELEMAC pre-processing tutorial</span></a>. Both files can also be downloaded from the supplemental materials repository of this eBook:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/hydro-informatics/telemac/raw/main/bk-slf/qgismesh.slf">Download qgismesh.slf</a> (uses <strong>EPSG:6173</strong> - ETRS 89 / UTM zone 33N).</p></li>
<li><p><a class="reference external" href="https://github.com/hydro-informatics/telemac/raw/main/bk-slf/boundaries.cli">Download boundaries.cli</a>.</p></li>
</ul>
<p>Consider saving both files in a new folder, such as <code class="docutils literal notranslate"><span class="pre">/steady2d-tutorial/</span></code> that will contain all model files.</p>
<div class="admonition-download-simulation-files admonition">
<p class="admonition-title">Download simulation files</p>
<p>All simulation files used in this tutorial are available at <a class="reference external" href="https://github.com/hydro-informatics/telemac/tree/main/steady2d-tutorial/">https://github.com/hydro-informatics/telemac/tree/main/steady2d-tutorial/</a>.</p>
</div>
</div>
<div class="section" id="steering-file-cas">
<h2>Steering File (CAS)<a class="headerlink" href="#steering-file-cas" title="Permalink to this headline">¶</a></h2>
<p>The steering file has the file ending <code class="docutils literal notranslate"><span class="pre">*.cas</span></code> (presumably derived from the French word <em>cas</em>, which means <em>case</em> in English). The <code class="docutils literal notranslate"><span class="pre">*.cas</span></code> file is the main simulation file with information about references to the two always mandatory files (i.e., the <a class="reference external" href="https://gdal.org/drivers/vector/selafin.html">SELAFIN</a> <code class="docutils literal notranslate"><span class="pre">*.slf</span></code> geometry and the <code class="docutils literal notranslate"><span class="pre">*.cli</span></code> boundary files) and optional files, as well as definitions of simulation parameters. The steering file can be created or edited with a basic text editor or advanced GUI software such as <a class="reference internal" href="../get-started/install-telemac.html#fudaa"><span class="std std-ref">Fudaa PrePro</span></a> or <a class="reference internal" href="../get-started/install-telemac.html#bluekenue"><span class="std std-ref">BlueKenue</span></a>. This tutorial uses a basic text editor (e.g., <a class="reference internal" href="../get-started/others.html#npp"><span class="std std-ref">Notepad++</span></a> on Windows).</p>
<div class="admonition-fudaa-prepro admonition">
<p class="admonition-title">Fudaa PrePro</p>
<p><em>Fudaa PrePro</em> comes with variable descriptions that facilitate the definition of boundaries, initial conditions, and numerical parameters in the steering file. However, Fudaa PrePro makes file directions according to the platform on which it is running (i.e., <code class="docutils literal notranslate"><span class="pre">\</span></code> on Windows and <code class="docutils literal notranslate"><span class="pre">/</span></code> on Linux) and writes absolute file paths to the <code class="docutils literal notranslate"><span class="pre">*.cas</span></code> file, which often requires manual correction (e.g., if Fudaa PrePro is used for setting up a <code class="docutils literal notranslate"><span class="pre">*.cas</span></code> file on Windows for running a TELEMAC simulation on Linux). For working with Fudaa PrePro, follow the download instructions in the <a class="reference internal" href="../get-started/install-telemac.html#fudaa"><span class="std std-ref">software chapter</span></a>. To launch Fudaa Prepro, open <em>Terminal</em> (Linux) or <em>Command Prompt</em> (Windows) and tap:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">cd</span></code> to the installation (download) directory of Fudaa PrePro</p></li>
<li><p>Start the GUI (requires java):</p>
<ul>
<li><p><em>Linux</em>: <code class="docutils literal notranslate"><span class="pre">sh</span> <span class="pre">supervisor.sh</span></code></p></li>
<li><p><em>Windows</em>: <code class="docutils literal notranslate"><span class="pre">supervisor.bat</span></code></p></li>
</ul>
</li>
</ul>
</div>
<p>For this tutorial, <strong>create a new text file</strong> in the same folder where <code class="docutils literal notranslate"><span class="pre">qgismesh.slf</span></code> and <code class="docutils literal notranslate"><span class="pre">boundaries.cli</span></code> live, and name it, for instance, <code class="docutils literal notranslate"><span class="pre">steady2d.cas</span></code> (e.g., <code class="docutils literal notranslate"><span class="pre">/steady2d-tutorial/steady2d.cas</span></code>). The next sections guide through parameter definitions that stem from the <a class="reference external" href="https://gitlab.pam-retd.fr/otm/telemac-mascaret/-/blob/v8p3r1/documentation/telemac2d/user/telemac2d_user_v8p3.pdf">Telemac2d manual</a>. The final steering file can be downloaded from the supplemental materials repository (<a class="reference external" href="https://github.com/hydro-informatics/telemac/raw/main/steady2d-tutorial/steady2d.cas">download steady2d.cas</a>).</p>
<div class="section" id="overview-of-the-cas-file">
<h3>Overview of the CAS File<a class="headerlink" href="#overview-of-the-cas-file" title="Permalink to this headline">¶</a></h3>
<p>The below box shows the provided <a class="reference external" href="https://github.com/hydro-informatics/telemac/raw/main/steady2d-tutorial/steady2d.cas">steady2d.cas</a> file that can be used for running this tutorial.</p>
<div class="note dropdown admonition">
<p class="admonition-title">Expand to view the complete .CAS file</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="o">/---------------------------------------------------------------------</span>
<span class="o">/</span> <span class="n">TELEMAC2D</span> <span class="n">Version</span> <span class="n">v8p2</span>
<span class="o">/</span> <span class="n">STEADY</span> <span class="n">HYDRODYNAMICS</span> <span class="n">TRAINING</span>
<span class="o">/---------------------------------------------------------------------</span>

<span class="o">/</span> <span class="n">steady2d</span><span class="p">.</span><span class="n">cas</span>
<span class="o">/------------------------------------------------------------------/</span>
<span class="o">/</span>			<span class="n">COMPUTATION</span> <span class="n">ENVIRONMENT</span>
<span class="o">/------------------------------------------------------------------/</span>
<span class="n">TITLE</span> <span class="p">:</span> <span class="s1">&#39;2d steady&#39;</span>
<span class="o">/</span>
<span class="n">BOUNDARY</span> <span class="n">CONDITIONS</span> <span class="k">FILE</span> <span class="p">:</span> <span class="n">boundaries</span><span class="p">.</span><span class="n">cli</span>
<span class="n">GEOMETRY</span> <span class="k">FILE</span>            <span class="p">:</span> <span class="n">qgismesh</span><span class="p">.</span><span class="n">slf</span>
<span class="n">RESULTS</span> <span class="k">FILE</span>           <span class="p">:</span> <span class="n">r2dsteady</span><span class="p">.</span><span class="n">slf</span>
<span class="o">/</span>
<span class="n">MASS</span><span class="o">-</span><span class="n">BALANCE</span> <span class="p">:</span> <span class="n">YES</span> <span class="o">/</span> <span class="n">activates</span> <span class="n">mass</span> <span class="n">balance</span> <span class="n">printouts</span> <span class="o">-</span> <span class="n">does</span> <span class="nb">not </span><span class="n">enforce</span> <span class="n">mass</span> <span class="n">balance</span>
<span class="n">VARIABLES</span> <span class="n">FOR</span> <span class="n">GRAPHIC</span> <span class="n">PRINTOUTS</span> <span class="p">:</span> <span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">H</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">F</span> <span class="o">/</span> <span class="n">Q</span> <span class="n">enables</span> <span class="n">boundary</span> <span class="n">flux</span> <span class="n">equilibrium</span> <span class="n">controls</span>
<span class="o">/</span>
<span class="o">/------------------------------------------------------------------/</span>
<span class="o">/</span>			<span class="n">GENERAL</span> <span class="n">PARAMETERS</span>
<span class="o">/------------------------------------------------------------------/</span>
<span class="nb">TIME </span><span class="n">STEP</span> <span class="p">:</span> <span class="mf">1.</span>
<span class="n">NUMBER</span> <span class="n">OF</span> <span class="nb">TIME </span><span class="n">STEPS</span> <span class="p">:</span> <span class="mi">8000</span>
<span class="n">GRAPHIC</span> <span class="n">PRINTOUT</span> <span class="n">PERIOD</span> <span class="p">:</span> <span class="mi">200</span>
<span class="n">LISTING</span> <span class="n">PRINTOUT</span> <span class="n">PERIOD</span> <span class="p">:</span> <span class="mi">100</span>
<span class="o">/</span>
<span class="o">/------------------------------------------------------------------/</span>
<span class="o">/</span>			<span class="n">NUMERICAL</span> <span class="n">PARAMETERS</span>
<span class="o">/------------------------------------------------------------------/</span>
<span class="o">/</span> <span class="n">General</span> <span class="n">solver</span> <span class="n">parameters</span>
<span class="n">DISCRETIZATIONS</span> <span class="n">IN</span> <span class="n">SPACE</span> <span class="p">:</span> <span class="mi">11</span><span class="p">;</span><span class="mi">11</span>
<span class="n">FREE</span> <span class="n">SURFACE</span> <span class="n">GRADIENT</span> <span class="n">COMPATIBILITY</span> <span class="p">:</span> <span class="mf">0.1</span>  <span class="o">/</span> <span class="n">default</span> <span class="mf">1.</span>
<span class="n">ADVECTION</span> <span class="p">:</span> <span class="n">YES</span>
<span class="o">/</span>
<span class="o">/</span> <span class="n">STABILITY</span> <span class="n">CONTROLS</span>
<span class="n">PRINTING</span> <span class="n">CUMULATED</span> <span class="n">FLOWRATES</span> <span class="p">:</span> <span class="n">YES</span>
<span class="o">/</span>
<span class="o">/</span> <span class="n">FINITE</span> <span class="n">ELEMENT</span> <span class="n">SCHEME</span> <span class="n">PARAMETERS</span>
<span class="o">/------------------------------------------------------------------</span>
<span class="n">TREATMENT</span> <span class="n">OF</span> <span class="n">THE</span> <span class="n">LINEAR</span> <span class="nb">SYSTEM</span> <span class="p">:</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">default</span> <span class="k">is </span><span class="mi">2</span> <span class="o">-</span> <span class="k">use </span><span class="mi">1</span> <span class="n">to</span> <span class="n">avoid</span> <span class="n">smoothened</span> <span class="n">results</span>
<span class="n">SCHEME</span> <span class="n">FOR</span> <span class="n">ADVECTION</span> <span class="n">OF</span> <span class="n">VELOCITIES</span> <span class="p">:</span> <span class="mi">14</span> <span class="o">/</span> <span class="n">alternatively</span> <span class="n">keep</span> <span class="mi">1</span>
<span class="n">SCHEME</span> <span class="n">FOR</span> <span class="n">ADVECTION</span> <span class="n">OF</span> <span class="n">TRACERS</span> <span class="p">:</span> <span class="mi">5</span>
<span class="n">SCHEME</span> <span class="n">FOR</span> <span class="n">ADVECTION</span> <span class="n">OF</span> <span class="n">K</span><span class="o">-</span><span class="nb">EPSILON</span> <span class="p">:</span> <span class="mi">14</span>
<span class="n">IMPLICITATION</span> <span class="n">FOR</span> <span class="n">DEPTH</span> <span class="p">:</span> <span class="mf">0.55</span> <span class="o">/</span> <span class="n">should</span> <span class="n">be</span> <span class="n">between</span> <span class="mf">0.55</span> <span class="nb">and </span><span class="mf">0.6</span>
<span class="n">IMPLICITATION</span> <span class="n">FOR</span> <span class="n">VELOCITY</span> <span class="p">:</span> <span class="mf">0.55</span> <span class="o">/</span> <span class="n">should</span> <span class="n">be</span> <span class="n">between</span> <span class="mf">0.55</span> <span class="nb">and </span><span class="mf">0.6</span>
<span class="n">IMPLICITATION</span> <span class="n">FOR</span> <span class="n">DIFFUSION</span> <span class="n">OF</span> <span class="n">VELOCITY</span> <span class="p">:</span> <span class="mf">1.</span> <span class="o">/</span> <span class="n">v8p2</span> <span class="n">default</span>
<span class="n">IMPLICITATION</span> <span class="n">COEFFICIENT</span> <span class="n">OF</span> <span class="n">TRACERS</span> <span class="p">:</span> <span class="mf">0.6</span> <span class="o">/</span> <span class="n">v8p2</span> <span class="n">default</span>
<span class="n">MASS</span><span class="o">-</span><span class="n">LUMPING</span> <span class="n">ON</span> <span class="n">H</span> <span class="p">:</span> <span class="mf">1.</span>
<span class="n">MASS</span><span class="o">-</span><span class="n">LUMPING</span> <span class="n">ON</span> <span class="n">VELOCITY</span> <span class="p">:</span> <span class="mf">1.</span>
<span class="n">MASS</span><span class="o">-</span><span class="n">LUMPING</span> <span class="n">ON</span> <span class="n">TRACERS</span> <span class="p">:</span> <span class="mf">1.</span>
<span class="n">SUPG</span> <span class="n">OPTION</span> <span class="p">:</span> <span class="mi">0</span><span class="p">;</span><span class="mi">0</span><span class="p">;</span><span class="mi">2</span><span class="p">;</span><span class="mi">2</span> <span class="o">/</span> <span class="n">classic</span> <span class="n">supg</span> <span class="n">for</span> <span class="n">U</span> <span class="nb">and </span><span class="n">V</span>
<span class="o">/</span>
<span class="o">/</span> <span class="n">SOLVER</span>
<span class="o">/------------------------------------------------------------------</span>
<span class="n">INFORMATION</span> <span class="n">ABOUT</span> <span class="n">SOLVER</span> <span class="p">:</span> <span class="n">YES</span>
<span class="n">SOLVER</span> <span class="p">:</span> <span class="mi">1</span>
<span class="n">MAXIMUM</span> <span class="n">NUMBER</span> <span class="n">OF</span> <span class="n">ITERATIONS</span> <span class="n">FOR</span> <span class="n">SOLVER</span> <span class="p">:</span> <span class="mi">200</span> <span class="o">/</span> <span class="n">maximum</span> <span class="n">number</span> <span class="n">of</span> <span class="n">iterations</span> <span class="n">when</span> <span class="n">solving</span> <span class="n">the</span> <span class="n">propagation</span> <span class="n">step</span>
<span class="n">MAXIMUM</span> <span class="n">NUMBER</span> <span class="n">OF</span> <span class="n">ITERATIONS</span> <span class="n">FOR</span> <span class="n">DIFFUSION</span> <span class="n">OF</span> <span class="n">TRACERS</span> <span class="p">:</span> <span class="mi">60</span> <span class="o">/</span> <span class="n">tracer</span> <span class="n">diffusion</span>
<span class="n">MAXIMUM</span> <span class="n">NUMBER</span> <span class="n">OF</span> <span class="n">ITERATIONS</span> <span class="n">FOR</span> <span class="n">K</span> <span class="nb">AND EPSILON</span> <span class="p">:</span> <span class="mi">50</span> <span class="o">/</span> <span class="n">diffusion</span> <span class="nb">and </span><span class="n">source</span> <span class="n">terms</span> <span class="n">of</span> <span class="n">k</span><span class="o">-</span><span class="n">e</span>
<span class="o">/</span>
<span class="o">/</span> <span class="n">TIDAL</span> <span class="n">FLATS</span>
<span class="n">TIDAL</span> <span class="n">FLATS</span> <span class="p">:</span> <span class="n">YES</span>
<span class="n">CONTINUITY</span> <span class="n">CORRECTION</span> <span class="p">:</span> <span class="n">YES</span> <span class="o">/</span> <span class="n">default</span> <span class="k">is </span><span class="n">NO</span>
<span class="n">OPTION</span> <span class="n">FOR</span> <span class="n">THE</span> <span class="n">TREATMENT</span> <span class="n">OF</span> <span class="n">TIDAL</span> <span class="n">FLATS</span> <span class="p">:</span> <span class="mi">1</span>
<span class="n">TREATMENT</span> <span class="n">OF</span> <span class="n">NEGATIVE</span> <span class="n">DEPTHS</span> <span class="p">:</span> <span class="mi">2</span> <span class="o">/</span> <span class="k">value </span><span class="mi">2</span> <span class="nb">or </span><span class="mi">3</span> <span class="k">is </span><span class="n">required</span> <span class="n">with</span> <span class="n">tidal</span> <span class="n">flats</span> <span class="o">-</span> <span class="n">default</span> <span class="k">is </span><span class="mi">1</span>
<span class="o">/</span>
<span class="o">/</span> <span class="n">MATRIX</span> <span class="n">HANDLING</span>
<span class="n">MATRIX</span> <span class="n">STORAGE</span> <span class="p">:</span> <span class="mi">3</span> <span class="o">/</span> <span class="n">default</span> <span class="k">is </span><span class="mi">3</span>
<span class="o">/</span>
<span class="o">/</span> <span class="n">BOUNDARY</span> <span class="n">CONDITIONS</span>
<span class="o">/------------------------------------------------------------------</span>
<span class="o">/</span> <span class="n">Friction</span>
<span class="n">LAW</span> <span class="n">OF</span> <span class="n">BOTTOM</span> <span class="n">FRICTION</span> <span class="p">:</span> <span class="mi">4</span> <span class="o">/</span> <span class="mi">4</span><span class="o">-</span><span class="n">Manning</span>
<span class="n">FRICTION</span> <span class="n">COEFFICIENT</span> <span class="p">:</span> <span class="mf">0.03</span> <span class="o">/</span> <span class="n">Roughness</span> <span class="n">coefficient</span>
<span class="o">/</span>
<span class="o">/</span> <span class="n">Liquid</span> <span class="n">boundaries</span>
<span class="n">PRESCRIBED</span> <span class="n">FLOWRATES</span>  <span class="p">:</span> <span class="mi">3</span><span class="mf">5.</span><span class="p">;</span><span class="mi">3</span><span class="mf">5.</span>
<span class="n">PRESCRIBED</span> <span class="n">ELEVATIONS</span> <span class="p">:</span> <span class="mf">0.</span><span class="p">;</span><span class="mi">37</span><span class="mf">1.33</span>
<span class="o">/</span>
<span class="o">/</span> <span class="k">Type </span><span class="n">of</span> <span class="n">velocity</span> <span class="n">profile</span> <span class="n">can</span> <span class="n">be</span> <span class="mi">1</span><span class="o">-</span><span class="n">constant</span> <span class="n">normal</span> <span class="n">profile</span> <span class="p">(</span><span class="n">default</span><span class="p">)</span> <span class="mi">2</span><span class="o">-</span><span class="n">UBOR</span> <span class="nb">and </span><span class="n">VBOR</span> <span class="n">in</span> <span class="n">the</span> <span class="n">boundary</span> <span class="n">conditions</span> <span class="k">file</span> <span class="p">(</span><span class="n">cli</span><span class="p">)</span> <span class="mi">3</span><span class="o">-</span><span class="n">vector</span> <span class="n">in</span> <span class="n">UBOR</span> <span class="n">in</span> <span class="n">the</span> <span class="n">boundary</span> <span class="n">conditions</span> <span class="k">file</span> <span class="p">(</span><span class="n">cli</span><span class="p">)</span> <span class="mi">4</span><span class="o">-</span><span class="n">vector</span> <span class="k">is </span><span class="n">proportional</span> <span class="n">to</span> <span class="n">the</span> <span class="n">root</span> <span class="p">(</span><span class="n">water</span> <span class="n">depth</span><span class="p">,</span> <span class="k">only </span><span class="n">for</span> <span class="n">Q</span><span class="p">)</span> <span class="mi">5</span><span class="o">-</span><span class="n">vector</span> <span class="k">is </span><span class="n">proportional</span> <span class="n">to</span> <span class="n">the</span> <span class="n">root</span> <span class="p">(</span><span class="n">virtual</span> <span class="n">water</span> <span class="n">depth</span><span class="p">),</span> <span class="n">the</span> <span class="n">virtual</span> <span class="n">water</span> <span class="n">depth</span> <span class="k">is </span><span class="n">obtained</span> <span class="n">from</span> <span class="n">a</span> <span class="n">lower</span> <span class="n">point</span> <span class="n">at</span> <span class="n">the</span> <span class="n">boundary</span> <span class="n">condition</span> <span class="p">(</span><span class="k">only </span><span class="n">for</span> <span class="n">Q</span><span class="p">)</span>
<span class="n">VELOCITY</span> <span class="n">PROFILES</span> <span class="p">:</span> <span class="mi">4</span><span class="p">;</span><span class="mi">1</span>
<span class="o">/</span>
<span class="o">/</span> <span class="n">INITIAL</span> <span class="n">CONDITIONS</span>
<span class="o">/</span> <span class="o">------------------------------------------------------------------</span>
<span class="n">INITIAL</span> <span class="n">CONDITIONS</span> <span class="p">:</span> <span class="s1">&#39;CONSTANT DEPTH&#39;</span> <span class="o">/</span> <span class="k">use </span><span class="n">ZERO</span> <span class="n">DEPTH</span> <span class="n">to</span> <span class="n">start</span> <span class="n">with</span> <span class="n">dry</span> <span class="n">model</span> <span class="n">conditions</span>
<span class="n">INITIAL</span> <span class="n">DEPTH</span> <span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="kt">INTEGER </span><span class="n">for</span> <span class="n">speeding</span> <span class="n">up</span> <span class="n">calculations</span>
<span class="o">/</span>
<span class="o">/------------------------------------------------------------------/</span>
<span class="o">/</span>			<span class="n">TURBULENCE</span>
<span class="o">/------------------------------------------------------------------/</span>
<span class="o">/</span>
<span class="n">DIFFUSION</span> <span class="n">OF</span> <span class="n">VELOCITY</span> <span class="p">:</span> <span class="n">YES</span> <span class="o">/</span> <span class="n">default</span> <span class="k">is </span><span class="n">YES</span>
<span class="n">TURBULENCE</span> <span class="n">MODEL</span> <span class="p">:</span> <span class="mi">3</span>
<span class="o">/</span>
<span class="p">&amp;</span><span class="n">ETA</span>
</pre></div>
</div>
<div class="note admonition">
<p class="admonition-title">What means &amp;ETA?</p>
<p>The <code class="docutils literal notranslate"><span class="pre">&amp;ETA</span></code> keyword at the bottom of the <code class="docutils literal notranslate"><span class="pre">*.cas</span></code> template file makes TELEMAC printing out keywords and the values assigned to them when it runs its <em>Damocles</em> algorithm.</p>
</div>
</div>
</div>
<div class="section" id="general-parameters">
<span id="tm2d-gen"></span><h3>General Parameters<a class="headerlink" href="#general-parameters" title="Permalink to this headline">¶</a></h3>
<p>The general parameters define the computation environment starting with a simulation title and the most important links to the two mandatory input files:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">BOUNDARY</span> <span class="pre">CONDITIONS</span> <span class="pre">FILE</span> <span class="pre">:</span> <span class="pre">boundaries.cli</span></code> - with a <em>MED</em> file, use a <em>BND</em> boundary file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">GEOMETRY</span> <span class="pre">FILE</span> <span class="pre">:</span> <span class="pre">qgismesh.slf</span></code></p></li>
</ul>
<p>The model <strong>output</strong> can be defined with the following keywords:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">RESULTS</span> <span class="pre">FILE</span> <span class="pre">:</span> <span class="pre">r2dsteady.slf</span></code> - can be either a <em>MED</em> file or a <em>SLF</em> file</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">VARIABLES</span> <span class="pre">FOR</span> <span class="pre">GRAPHIC</span> <span class="pre">PRINTOUTS</span></code>:  <code class="docutils literal notranslate"><span class="pre">U,V,H,S,Q,F</span></code> - many more options can be found in section 1.317 (page 85) of the <a class="reference external" href="https://gitlab.pam-retd.fr/otm/telemac-mascaret/-/blob/v8p3r1/documentation/telemac2d/reference/telemac2d_reference_v8p3.pdf">Telemac2d reference manual</a>.</p></li>
</ul>
<p>The velocities (<code class="docutils literal notranslate"><span class="pre">U</span></code> and <code class="docutils literal notranslate"><span class="pre">V</span></code>), the water depth (<code class="docutils literal notranslate"><span class="pre">H</span></code>), and the discharge (<code class="docutils literal notranslate"><span class="pre">Q</span></code>) are standard variables that should be used in every simulation. In particular, the discharge (<code class="docutils literal notranslate"><span class="pre">Q</span></code>) is required to check when (steady) s converge at the inflow and outflow boundaries. Moreover, the discharge (<code class="docutils literal notranslate"><span class="pre">Q</span></code>) enables to trace integrated fluxes along any user-defined line in the model. The procedure for verifying and identify discharges is described in the <a class="reference internal" href="#verify-steady-tm2d"><span class="std std-ref">discharge verification</span></a> section in the post-processing.</p>
<p>The time variables (<code class="docutils literal notranslate"><span class="pre">TIME</span> <span class="pre">STEP</span></code> and <code class="docutils literal notranslate"><span class="pre">NUMBER</span> <span class="pre">OF</span> <span class="pre">TIME</span> <span class="pre">STEPS</span></code>) define the simulation length and the printout periods (<code class="docutils literal notranslate"><span class="pre">GRAPHIC</span> <span class="pre">PRINTOUT</span> <span class="pre">PERIOD</span></code> and <code class="docutils literal notranslate"><span class="pre">LISTING</span> <span class="pre">PRINTOUT</span> <span class="pre">PERIOD</span></code>) define the result output frequency. The <strong>smaller the printout period</strong>, <strong>the longer will take the simulation</strong> because writing results is one of the most time-consuming processes in numerical modeling. The printout periods (frequencies) refer to a multiple of the <code class="docutils literal notranslate"><span class="pre">TIME</span> <span class="pre">STEPS</span></code> parameter and need to be a smaller number than the <code class="docutils literal notranslate"><span class="pre">NUMBER</span> <span class="pre">OF</span> <span class="pre">TIME</span> <span class="pre">STEPS</span></code>. Read more about timestep parameters in the <a class="reference external" href="https://gitlab.pam-retd.fr/otm/telemac-mascaret/-/blob/v8p3r1/documentation/telemac2d/user/telemac2d_user_v8p3.pdf">Telemac2d manual</a> in sections 5 and 12.4.2.</p>
<p>In addition, the <code class="docutils literal notranslate"><span class="pre">MASS-BALANCE</span> <span class="pre">:</span> <span class="pre">YES</span></code> setting will print out mass fluxes and errors in the computation region, which is an important parameter for verifying the plausibility of the model. Note that this keyword only enables mass balance printouts and does not enforce mass balance of the model, which must be achieved through a consistent model setup following this tutorial and the <a class="reference external" href="https://gitlab.pam-retd.fr/otm/telemac-mascaret/-/blob/v8p3r1/documentation/telemac2d/user/telemac2d_user_v8p3.pdf">Telemac2d manual</a>.</p>
<div class="note dropdown admonition">
<p class="admonition-title">Expand to review the GENERAL PARAMETERS used in this tutorial</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">TITLE</span> <span class="p">:</span> <span class="s1">&#39;2d steady flow&#39;</span>
<span class="o">/</span>
<span class="n">BOUNDARY</span> <span class="n">CONDITIONS</span> <span class="k">FILE</span> <span class="p">:</span> <span class="n">boundaries</span><span class="p">.</span><span class="n">cli</span>
<span class="n">GEOMETRY</span> <span class="k">FILE</span> <span class="p">:</span> <span class="n">qgismesh</span><span class="p">.</span><span class="n">slf</span>
<span class="n">RESULTS</span> <span class="k">FILE</span> <span class="p">:</span> <span class="n">r2dsteady</span><span class="p">.</span><span class="n">slf</span>
<span class="o">/</span>
<span class="n">MASS</span><span class="o">-</span><span class="n">BALANCE</span> <span class="p">:</span> <span class="n">YES</span> <span class="o">/</span> <span class="n">activates</span> <span class="n">mass</span> <span class="n">balance</span> <span class="n">printouts</span> <span class="o">-</span> <span class="n">does</span> <span class="nb">not </span><span class="n">enforce</span> <span class="n">mass</span> <span class="n">balance</span>
<span class="n">VARIABLES</span> <span class="n">FOR</span> <span class="n">GRAPHIC</span> <span class="n">PRINTOUTS</span> <span class="p">:</span> <span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">H</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">F</span> <span class="o">/</span> <span class="n">Q</span> <span class="n">enables</span> <span class="n">boundary</span> <span class="n">flux</span> <span class="n">equilibrium</span> <span class="n">controls</span>
<span class="o">/</span>
<span class="nb">TIME </span><span class="n">STEP</span> <span class="p">:</span> <span class="mf">1.</span>
<span class="n">NUMBER</span> <span class="n">OF</span> <span class="nb">TIME </span><span class="n">STEPS</span> <span class="p">:</span> <span class="mi">8000</span>
<span class="n">GRAPHIC</span> <span class="n">PRINTOUT</span> <span class="n">PERIOD</span> <span class="p">:</span> <span class="mi">200</span>
<span class="n">LISTING</span> <span class="n">PRINTOUT</span> <span class="n">PERIOD</span> <span class="p">:</span> <span class="mi">100</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="general-numerical-parameters">
<span id="tm2d-numerical"></span><h3>General Numerical Parameters<a class="headerlink" href="#general-numerical-parameters" title="Permalink to this headline">¶</a></h3>
<p><strong>The following descriptions refer to section 7.1 in the <a class="reference external" href="https://gitlab.pam-retd.fr/otm/telemac-mascaret/-/blob/v8p3r1/documentation/telemac2d/user/telemac2d_user_v8p3.pdf">Telemac2d manual</a>.</strong></p>
<p>Telemac2d comes with three solvers for approximating the depth-averaged <a class="reference internal" href="../documentation/glossary.html#term-Navier-Stokes-equations"><span class="xref std std-term">Navier-Stokes equations</span></a> (i.e., the <a class="reference internal" href="../documentation/glossary.html#term-Shallow-water-equations"><span class="xref std std-term">Shallow water equations</span></a>) <span id="id1">[<a class="reference internal" href="../documentation/bibliography.html#id332">KC08</a>]</span> that can be chosen by adding the <strong>EQUATIONS</strong> keyword to the <code class="docutils literal notranslate"><span class="pre">*.cas</span></code> file:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">EQUATIONS</span> <span class="pre">:</span> <span class="pre">SAINT-VENANT</span> <span class="pre">FE</span></code> is the <strong>default</strong> that makes Telemac2d use a Saint-Venant finite element method,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EQUATIONS</span> <span class="pre">:</span> <span class="pre">SAINT-VENANT</span> <span class="pre">FV</span></code> makes Telemac2d use a Saint-Venant finite volume method, and</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">EQUATIONS</span> <span class="pre">:</span> <span class="pre">BOUSSINESQ</span></code> makes Telemac2d use the <a class="reference internal" href="../documentation/glossary.html#term-Boussinesq"><span class="xref std std-term">Boussinesq</span></a> approximations (constant density except in the vertical momentum equation).</p></li>
</ul>
<p>In addition, a type of discretization has to be specified with the <strong>DISCRETIZATIONS IN SPACE</strong> keyword, which is a list of five integer values. The five list elements define spatial discretization schemes for (1) velocity, (2) depth, (3) tracers, (4) <span class="math notranslate nohighlight">\(k-\epsilon\)</span> turbulence, and (5) <span class="math notranslate nohighlight">\(\tilde{\nu}\)</span> advection (Spalart-Allmaras), respectively. The minimum length of the keyword list is 2 (for velocity and depth) and all other elements are optional. The list elements may take the following values defining spatial discretization:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">11</span></code> (<strong>default</strong>) activates (linear) triangular discretization in space (i.e., 3-node triangles),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">12</span></code> activates quasi-bubble discretization with 4-nodes, and</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">13</span></code> activates quadratic discretization with 6-nodes.</p></li>
</ul>
<p>The <a class="reference external" href="https://gitlab.pam-retd.fr/otm/telemac-mascaret/-/blob/v8p3r1/documentation/telemac2d/user/telemac2d_user_v8p3.pdf">Telemac2d manual</a> recommend using <strong>the default value of <code class="docutils literal notranslate"><span class="pre">DISCRETIZATIONS</span> <span class="pre">IN</span> <span class="pre">SPACE</span> <span class="pre">:</span> <span class="pre">11;11</span></code></strong> that assigns a linear discretization for velocity and water depth, which <strong>is computationally fast but potentially unstable</strong>. The option <code class="docutils literal notranslate"><span class="pre">12;11</span></code> may be used to reduce free surface instabilities or oscillations (e.g., along with steep bathymetry gradients). The option <code class="docutils literal notranslate"><span class="pre">13;11</span></code> increases the accuracy of results, the computation time, memory usage, and it is currently not available in Telemac2d.</p>
<p>In addition, the <strong>FREE SURFACE GRADIENT</strong> keyword can be defined for increasing the stability of a model. Its default value is <code class="docutils literal notranslate"><span class="pre">1.0</span></code>, but it can be reduced close to zero to achieve stability. The developers propose a minimum value of <code class="docutils literal notranslate"><span class="pre">0.</span></code>, but more realistic results can be yielded by setting this keyword to slightly more than zero (e.g., <code class="docutils literal notranslate"><span class="pre">0.1</span></code>). For instance, the following keyword combination may reduce surface instabilities (also referred to as <em>wiggles</em> or <em>oscillations</em>):</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">DISCRETIZATIONS</span> <span class="n">IN</span> <span class="n">SPACE</span> <span class="p">:</span> <span class="mi">12</span><span class="p">;</span><span class="mi">11</span>
<span class="n">FREE</span> <span class="n">SURFACE</span> <span class="n">GRADIENT</span> <span class="p">:</span> <span class="mf">0.1</span>
</pre></div>
</div>
<p>By default <a class="reference internal" href="../documentation/glossary.html#term-Advection"><span class="xref std std-term">Advection</span></a> is activated through the keyword <code class="docutils literal notranslate"><span class="pre">ADVECTION</span> <span class="pre">:</span> <span class="pre">YES</span></code> and it can be deactivated for particular terms only:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">ADVECTION</span> <span class="n">OF</span> <span class="n">H</span> <span class="p">:</span> <span class="n">NO</span> <span class="o">/</span> <span class="n">deactivates</span> <span class="n">depth</span> <span class="n">advection</span>
<span class="n">ADVECTION</span> <span class="n">OF</span> <span class="n">U</span> <span class="nb">AND </span><span class="n">V</span> <span class="p">:</span> <span class="n">NO</span> <span class="o">/</span> <span class="n">deactivates</span> <span class="n">velocity</span> <span class="n">advection</span>
<span class="n">ADVECTION</span> <span class="n">OF</span> <span class="n">K</span> <span class="nb">AND EPSILON</span> <span class="p">:</span> <span class="n">NO</span> <span class="o">/</span> <span class="n">deactivates</span> <span class="n">turbulent</span> <span class="n">energy</span> <span class="nb">and </span><span class="n">dissipation</span> <span class="p">(</span><span class="n">k</span><span class="o">-</span><span class="n">e</span> <span class="n">model</span><span class="p">)</span> <span class="nb">or </span><span class="n">the</span> <span class="n">Spalart</span><span class="o">-</span><span class="n">Allmaras</span> <span class="n">advection</span>
<span class="n">ADVECTION</span> <span class="n">OF</span> <span class="n">TRACERS</span> <span class="p">:</span> <span class="n">NO</span> <span class="o">/</span> <span class="n">deactivates</span> <span class="n">tracer</span> <span class="n">advection</span>
</pre></div>
</div>
<p>The <strong>PROPAGATION</strong> keyword (default: <code class="docutils literal notranslate"><span class="pre">YES</span></code>) steers the simulation of propagation and related phenomena. For instance, disabling propagation (<code class="docutils literal notranslate"><span class="pre">PROPAGATION</span> <span class="pre">:</span> <span class="pre">NO</span></code>) will also disable <a class="reference internal" href="../documentation/glossary.html#term-Diffusion"><span class="xref std std-term">Diffusion</span></a>. The other way round, when propagation is enabled, <a class="reference internal" href="../documentation/glossary.html#term-Diffusion"><span class="xref std std-term">Diffusion</span></a> can be disabled separately. Read more about <a class="reference internal" href="../documentation/glossary.html#term-Diffusion"><span class="xref std std-term">Diffusion</span></a> in Telemac2d in the <a class="reference internal" href="#tm2d-turbulence"><span class="std std-ref">turbulence</span></a> section.</p>
</div>
<div class="section" id="numerical-parameters-for-finite-elements">
<span id="tm2d-fe"></span><h3>Numerical Parameters for Finite Elements<a class="headerlink" href="#numerical-parameters-for-finite-elements" title="Permalink to this headline">¶</a></h3>
<p><strong>The following descriptions refer to section 7.2.1 in the <a class="reference external" href="https://gitlab.pam-retd.fr/otm/telemac-mascaret/-/blob/v8p3r1/documentation/telemac2d/user/telemac2d_user_v8p3.pdf">Telemac2d manual</a>.</strong></p>
<p>Telemac2d uses finite elements for iterative solutions to the <a class="reference internal" href="../documentation/glossary.html#term-Shallow-water-equations"><span class="xref std std-term">Shallow water equations</span></a>. The <strong>TREATMENT OF THE LINEAR SYSTEM</strong> keyword enables replacing the original set of equations (option <code class="docutils literal notranslate"><span class="pre">1</span></code>) involved in TELEMAC’s finite element solver with a generalized wave equation (<strong>option <code class="docutils literal notranslate"><span class="pre">2</span></code></strong>). The replacement (i.e., the use of the <strong>generalized wave equation</strong>) is set to <strong>default since v8p2</strong> and decreases computation time, but smoothens the results. This default (<code class="docutils literal notranslate"><span class="pre">TREATMENT</span> <span class="pre">OF</span> <span class="pre">THE</span> <span class="pre">LINEAR</span> <span class="pre">SYSTEM</span> <span class="pre">:</span> <span class="pre">2</span></code>) automatically activates mass lumping for depth and velocity, and implies explicit velocity diffusion.</p>
<div class="note dropdown admonition">
<p class="admonition-title">Use SCHEME FOR ADVECTION in lieu of TYPE OF ADVECTION</p>
<p>The <strong>TYPE OF ADVECTION</strong> keyword is a list of four integers that define the advection schemes for (1) velocities (both <span class="math notranslate nohighlight">\(u\)</span> and <span class="math notranslate nohighlight">\(v\)</span>), (2) water depth <span class="math notranslate nohighlight">\(h\)</span>, (3) tracers, and (4) turbulence (<span class="math notranslate nohighlight">\(k-\epsilon\)</span> or <span class="math notranslate nohighlight">\(\tilde{\nu}\)</span>). The value provided for (2) depth is ignored since v6p0 and a list of two values is sufficient in the absence of (3) tracers and a specific (4) turbulence model. Thus, in lieu of <code class="docutils literal notranslate"><span class="pre">TYPE</span> <span class="pre">OF</span> <span class="pre">ADVECTION</span></code>, the <code class="docutils literal notranslate"><span class="pre">SCHEME</span> <span class="pre">FOR</span> <span class="pre">ADVECTION</span> <span class="pre">OF</span> <span class="pre">VELOCITIES</span></code> keyword should be used. The default is <code class="docutils literal notranslate"><span class="pre">TYPE</span> <span class="pre">OF</span> <span class="pre">ADVECTION</span> <span class="pre">:</span> <span class="pre">1;5;1;1</span></code> (where the <code class="docutils literal notranslate"><span class="pre">5</span></code> for water depth stems from an older Telemac2d version and does not trigger the PSI scheme). However, <strong>the <a class="reference external" href="https://gitlab.pam-retd.fr/otm/telemac-mascaret/-/blob/v8p3r1/documentation/telemac2d/user/telemac2d_user_v8p3.pdf">Telemac2d manual</a> indicate that the TYPE OF ADVECTION keyword will be deprecated in future releases.</strong></p>
</div>
<p>The <a class="reference external" href="https://gitlab.pam-retd.fr/otm/telemac-mascaret/-/blob/v8p3r1/documentation/telemac2d/user/telemac2d_user_v8p3.pdf">Telemac2d manual</a> state that the following scalar <strong>SCHEME FOR ADVECTION</strong> keywords apply instead of the soon deprecated TYPE OF ADVECTION list:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">SCHEME</span> <span class="n">FOR</span> <span class="n">ADVECTION</span> <span class="n">OF</span> <span class="n">VELOCITIES</span> <span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">default</span>
<span class="n">SCHEME</span> <span class="n">FOR</span> <span class="n">ADVECTION</span> <span class="n">OF</span> <span class="n">TRACERS</span> <span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">default</span>
<span class="n">SCHEME</span> <span class="n">FOR</span> <span class="n">ADVECTION</span> <span class="n">OF</span> <span class="n">K</span><span class="o">-</span><span class="nb">EPSILON</span> <span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">default</span>
</pre></div>
</div>
<p>The three <code class="docutils literal notranslate"><span class="pre">SCHEME</span> <span class="pre">FOR</span> <span class="pre">ADVECTION</span></code> scalar keywords may take the following values:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> sets a not mass-conservative method of characteristics (default for all),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> sets a semi-implicit scheme and activates the Streamline Upwind Petrov Galerkin (SUPG) scheme (read more below),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">3</span></code>, <code class="docutils literal notranslate"><span class="pre">4</span></code>, <code class="docutils literal notranslate"><span class="pre">13</span></code>, and <code class="docutils literal notranslate"><span class="pre">14</span></code> activate the so-called NERD scheme (these numbers activate different schemes in 3d only),</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">5</span></code> sets a mass-conservative PSI distributive scheme (do not use with tidal flats), and</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">15</span></code> sets the mass-conservative ERIA scheme that works with tidal flats.</p></li>
</ul>
<p>Options <code class="docutils literal notranslate"><span class="pre">4</span></code> and <code class="docutils literal notranslate"><span class="pre">5</span></code> require that the <a class="reference internal" href="../documentation/glossary.html#term-CFL"><span class="xref std std-term">CFL</span></a> condition is smaller than 1.</p>
<div class="tip admonition">
<p class="admonition-title">Recommended SCHEME OF ADVECTION … keywords</p>
<p>The <a class="reference external" href="https://gitlab.pam-retd.fr/otm/telemac-mascaret/-/blob/v8p3r1/documentation/telemac2d/user/telemac2d_user_v8p3.pdf">Telemac2d manual</a> recommend specific combinations depending on the simulation scenario.</p>
<p>For models <strong>without any dry zones</strong> use:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">SCHEME</span> <span class="n">FOR</span> <span class="n">ADVECTION</span> <span class="n">OF</span> <span class="n">VELOCITIES</span> <span class="p">:</span> <span class="mi">4</span> <span class="o">/</span> <span class="n">alternatively</span> <span class="n">keep</span> <span class="mi">1</span>
<span class="n">SCHEME</span> <span class="n">FOR</span> <span class="n">ADVECTION</span> <span class="n">OF</span> <span class="n">TRACERS</span> <span class="p">:</span> <span class="mi">5</span>
<span class="n">SCHEME</span> <span class="n">FOR</span> <span class="n">ADVECTION</span> <span class="n">OF</span> <span class="n">K</span><span class="o">-</span><span class="nb">EPSILON</span> <span class="p">:</span> <span class="mi">4</span>
</pre></div>
</div>
<p>For models with <strong>tidal flats</strong> use (like in this tutorial):</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">SCHEME</span> <span class="n">FOR</span> <span class="n">ADVECTION</span> <span class="n">OF</span> <span class="n">VELOCITIES</span> <span class="p">:</span> <span class="mi">14</span> <span class="o">/</span> <span class="n">alternatively</span> <span class="n">keep</span> <span class="mi">1</span>
<span class="n">SCHEME</span> <span class="n">FOR</span> <span class="n">ADVECTION</span> <span class="n">OF</span> <span class="n">TRACERS</span> <span class="p">:</span> <span class="mi">5</span>
<span class="n">SCHEME</span> <span class="n">FOR</span> <span class="n">ADVECTION</span> <span class="n">OF</span> <span class="n">K</span><span class="o">-</span><span class="nb">EPSILON</span> <span class="p">:</span> <span class="mi">14</span>
</pre></div>
</div>
</div>
<p><strong>Without any SCHEME FOR ADVECTION …</strong> keyword, the <strong>SUPG OPTION</strong> (Streamline Upwind Petrov Galerkin) keyword defines if upwinding applies and what type of upwinding applies. The <strong>SUPG OPTION</strong> is a list of four integers, where every element may take one of the following values:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code> disables upwinding,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> enables upwinding with a classical SUPG scheme (recommended when the <a class="reference internal" href="../documentation/glossary.html#term-CFL"><span class="xref std std-term">CFL</span></a> condition is unknown), and</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> enables upwinding with a modified SUPG scheme, where upwinding equals the <a class="reference internal" href="../documentation/glossary.html#term-CFL"><span class="xref std std-term">CFL</span></a> condition (recommended when the <a class="reference internal" href="../documentation/glossary.html#term-CFL"><span class="xref std std-term">CFL</span></a> condition is small).</p></li>
</ul>
<p>The default is <code class="docutils literal notranslate"><span class="pre">SUPG</span> <span class="pre">OPTION</span> <span class="pre">:</span> <span class="pre">2;2;2;2</span></code>, where</p>
<ul class="simple">
<li><p>the first list element refers to flow velocity (default <code class="docutils literal notranslate"><span class="pre">2</span></code>),</p></li>
<li><p>the second to water depth (default <code class="docutils literal notranslate"><span class="pre">2</span></code> - set to <code class="docutils literal notranslate"><span class="pre">0</span></code> when <code class="docutils literal notranslate"><span class="pre">MATRIX</span> <span class="pre">STORAGE</span> <span class="pre">:</span> <span class="pre">3</span></code>),</p></li>
<li><p>the third to tracers (default <code class="docutils literal notranslate"><span class="pre">2</span></code>), and</p></li>
<li><p>the last (fourth) to the k-epsilon model (default <code class="docutils literal notranslate"><span class="pre">2</span></code>).</p></li>
</ul>
<p>Note that the <code class="docutils literal notranslate"><span class="pre">SUPG</span> <span class="pre">OPTION</span></code> keyword <strong>is not optional</strong> for many keyword combinations and this tutorial uses <code class="docutils literal notranslate"><span class="pre">SUPG</span> <span class="pre">OPTION</span> <span class="pre">:</span> <span class="pre">0;0;2;2</span></code>.</p>
<p><strong>Implicitation parameters</strong> (<strong>IMPLICITATION FOR DEPTH</strong>, <strong>IMPLICITATION FOR VELOCITIES</strong>, and <strong>IMPLICITATION FOR DIFFUSION OF VELOCITY</strong>) apply to the semi-implicit time discretization used in Telemac2d. To enable cross-version compatibility, implicitation parameters should be defined in the <code class="docutils literal notranslate"><span class="pre">*.cas</span></code> file. For <strong>DEPTH</strong> and <strong>VELOCITIES</strong> use values between <code class="docutils literal notranslate"><span class="pre">0.55</span></code> and <code class="docutils literal notranslate"><span class="pre">0.60</span></code> (<strong>default is <code class="docutils literal notranslate"><span class="pre">0.55</span></code> since v8p1</strong>); for <strong>IMPLICITATION FOR DIFFUSION OF VELOCITY</strong> set the v8p2 default of <code class="docutils literal notranslate"><span class="pre">1.0</span></code>.</p>
<p>The default <code class="docutils literal notranslate"><span class="pre">TREATMENT</span> <span class="pre">OF</span> <span class="pre">THE</span> <span class="pre">LINEAR</span> <span class="pre">SYSTEM</span> <span class="pre">:</span> <span class="pre">2</span></code> involves so-called <strong>mass lumping</strong>, which leads to a smoothening of results. Specific mass lumping keywords and values are required for the flux control option of the <strong>TREATMENT OF NEGATIVE DEPTHS</strong> keyword and the default value for the treatment of tidal flats. To this end, the mass lumping keywords should be defined as:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">MASS</span><span class="o">-</span><span class="n">LUMPING</span> <span class="n">ON</span> <span class="n">H</span> <span class="p">:</span> <span class="mf">1.</span>
<span class="n">MASS</span><span class="o">-</span><span class="n">LUMPING</span> <span class="n">ON</span> <span class="n">VELOCITY</span> <span class="p">:</span> <span class="mf">1.</span>
<span class="n">MASS</span><span class="o">-</span><span class="n">LUMPING</span> <span class="n">ON</span> <span class="n">TRACERS</span> <span class="p">:</span> <span class="mf">1.</span>
</pre></div>
</div>
<p>In addition, <code class="docutils literal notranslate"><span class="pre">MASS-LUMPING</span> <span class="pre">FOR</span> <span class="pre">WEAK</span> <span class="pre">CHARACTERISTICS</span> <span class="pre">:</span> <span class="pre">1.</span></code> may be defined, which will make Telemac2d using weak characteristics (see below). The default value of any <code class="docutils literal notranslate"><span class="pre">MASS-LUMPING</span> <span class="pre">...</span></code> keyword is <code class="docutils literal notranslate"><span class="pre">0.</span></code> and the maximum value is <code class="docutils literal notranslate"><span class="pre">1.</span></code>, which makes mass matrices diagonal.</p>
<p>The <strong>OPTION OF CHARACTERISTICS</strong> keyword defines the method of characteristics that can take a <strong>strong (default of <code class="docutils literal notranslate"><span class="pre">1</span></code>)</strong> or a <strong>weak (<code class="docutils literal notranslate"><span class="pre">2</span></code>)</strong> form. A weak form decreases <a class="reference internal" href="../documentation/glossary.html#term-Diffusion"><span class="xref std std-term">Diffusion</span></a>, is more conservative, and increases computation time. Telemac2d automatically switches from the default strong (<code class="docutils literal notranslate"><span class="pre">1</span></code>) to the weak (<code class="docutils literal notranslate"><span class="pre">2</span></code>) form when</p>
<ul class="simple">
<li><p>the <code class="docutils literal notranslate"><span class="pre">TYPE</span> <span class="pre">OF</span> <span class="pre">ADVECTION</span></code> is set to <code class="docutils literal notranslate"><span class="pre">1</span></code>,</p></li>
<li><p>any <code class="docutils literal notranslate"><span class="pre">SCHEME</span> <span class="pre">FOR</span> <span class="pre">ADVECTION</span> <span class="pre">...</span></code> is set to <code class="docutils literal notranslate"><span class="pre">1</span></code>, or</p></li>
<li><p>any <code class="docutils literal notranslate"><span class="pre">SCHEME</span> <span class="pre">OPTION</span> <span class="pre">FOR</span> <span class="pre">ADVECTION</span> <span class="pre">OF</span> <span class="pre">...</span></code> is set to <code class="docutils literal notranslate"><span class="pre">2</span></code>.</p></li>
</ul>
<p>None of these options should be used with tracers because they are not mass-conservative.</p>
</div>
<div class="section" id="numerical-parameters-for-finite-volumes">
<h3>Numerical Parameters for Finite Volumes<a class="headerlink" href="#numerical-parameters-for-finite-volumes" title="Permalink to this headline">¶</a></h3>
<p>The finite volume method is mentioned here for completeness and detailed descriptions are available in section 7.2.2 of the <a class="reference external" href="https://gitlab.pam-retd.fr/otm/telemac-mascaret/-/blob/v8p3r1/documentation/telemac2d/user/telemac2d_user_v8p3.pdf">Telemac2d manual</a>.</p>
<div class="admonition-use-finite-volumes-only-with-v8p2-or-later admonition">
<p class="admonition-title">Use finite volumes only with v8p2 or later</p>
<p>Earlier versions of Telemac2d’s finite volume solver are buggy, but since major improvements were implemented wit v8p2, the newest versions run stable.</p>
</div>
<p>The finite volume method involves the definition of a scheme through the <strong>FINITE VOLUME SCHEME</strong> keyword that can take one of the following integer values:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code> enables the <span id="id2">Roe [<a class="reference internal" href="../documentation/bibliography.html#id1351">Roe81</a>]</span> scheme,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> is the <strong>default</strong> and enables the kinetic scheme <span id="id3">[<a class="reference internal" href="../documentation/bibliography.html#id1350">ABP00</a>]</span>,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">3</span></code> enables the <span id="id4">Zokagoa and Soulaïmani [<a class="reference internal" href="../documentation/bibliography.html#id1353">ZS10</a>]</span> scheme that is incompatible with tidal flats,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">4</span></code> enables the <span id="id5">Tchamen and Kahawita [<a class="reference internal" href="../documentation/bibliography.html#id1354">TK98</a>]</span> scheme for modeling wetting and drying of a complex bathymetry,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">5</span></code> enables the Harten Lax Leer-Contact (HLLC) scheme <span id="id6">[<a class="reference internal" href="../documentation/bibliography.html#id1352">Tor09</a>]</span>, and</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">6</span></code> enables the Weighted Average Flux (WAF) <span id="id7">[<a class="reference internal" href="../documentation/bibliography.html#id1349">Ata12</a>]</span> scheme for which parallelism is currently not implemented.</p></li>
</ul>
<p>All finite volume schemes are explicit and potentially subjected to instability. For this reason, a desired <a class="reference internal" href="../documentation/glossary.html#term-CFL"><span class="xref std std-term">CFL</span></a> condition and a variable timestep are recommended to be defined:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">DESIRED</span> <span class="n">COURANT</span> <span class="n">NUMBER</span> <span class="p">:</span> <span class="mf">0.9</span>
<span class="n">VARIABLE</span> <span class="nb">TIME</span><span class="o">-</span><span class="n">STEP</span> <span class="p">:</span> <span class="n">YES</span> <span class="o">/</span> <span class="n">default</span> <span class="k">is </span><span class="n">NO</span>
<span class="n">DURATION</span> <span class="p">:</span> <span class="mi">10000</span>
</pre></div>
</div>
<p>The <strong>DURATION</strong> keyword is required to terminate the simulation.</p>
<p>The variable timestep will cause irregular listing outputs, while the graphic output frequency is written as a function of the above-defined <strong>TIME STEP</strong>. Note that <strong>this tutorial uses <code class="docutils literal notranslate"><span class="pre">VARIABLE</span> <span class="pre">TIME-STEP</span> <span class="pre">:</span> <span class="pre">NO</span></code></strong>, though <strong>variable timesteps do also work with FINITE ELEMENTS</strong>.</p>
<p>The <strong>FINITE VOLUME SCHEME TIME ORDER</strong> keyword defines the second-order time scheme, which is by default set to <em>Euler explicit</em> (<code class="docutils literal notranslate"><span class="pre">1</span></code>). Setting the time scheme order to <code class="docutils literal notranslate"><span class="pre">2</span></code> makes Telemac2d using the Newmark scheme where an integration coefficient may be used to change the integration parameter. Note that <code class="docutils literal notranslate"><span class="pre">NEWMARK</span> <span class="pre">TIME</span> <span class="pre">INTEGRATION</span> <span class="pre">COEFFICIENT</span> <span class="pre">:</span> <span class="pre">1</span></code> corresponds to <em>Euler explicit</em>. To implement these options in the steering file, use the following settings:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">FINITE</span> <span class="n">VOLUME</span> <span class="n">SCHEME</span> <span class="nb">TIME </span><span class="n">ORDER</span> <span class="p">:</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">default</span> <span class="k">is </span><span class="mi">1</span> <span class="o">-</span> <span class="n">Euler</span> <span class="n">explicit</span>
<span class="n">NEWMARK</span> <span class="nb">TIME </span><span class="n">INTEGRATION</span> <span class="n">COEFFICIENT</span> <span class="p">:</span> <span class="mf">0.5</span> <span class="o">/</span> <span class="n">default</span> <span class="k">is </span><span class="mf">0.5</span>
</pre></div>
</div>
<p>Depending on the type of analysis, the solver-related parameters of <strong>SOLVER</strong>, <strong>SOLVER OPTIONS</strong>, <strong>MAXIMUM NUMBER OF ITERATION FOR SOLVER</strong>, and <strong>TIDAL FLATS</strong> may also be modified.</p>
</div>
<div class="section" id="numerical-solver-parameters">
<span id="tm2d-solver-pars"></span><h3>Numerical Solver Parameters<a class="headerlink" href="#numerical-solver-parameters" title="Permalink to this headline">¶</a></h3>
<p><strong>The following descriptions refer to section 7.3.1 in the <a class="reference external" href="https://gitlab.pam-retd.fr/otm/telemac-mascaret/-/blob/v8p3r1/documentation/telemac2d/user/telemac2d_user_v8p3.pdf">Telemac2d manual</a>.</strong></p>
<p>The solver can be selected and specified with the <strong>SOLVER</strong>, <strong>SOLVER FOR DIFFUSION OF TRACERS</strong>, and <strong>SOLVER FOR K-EPSILON MODEL</strong> keywords where the following settings are recommended:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">SOLVER</span> <span class="p">:</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">default</span> <span class="k">is </span><span class="mi">3</span>
<span class="n">SOLVER</span> <span class="n">FOR</span> <span class="n">DIFFUSION</span> <span class="n">OF</span> <span class="n">TRACERS</span> <span class="p">:</span> <span class="mi">1</span>
<span class="n">SOLVER</span> <span class="n">FOR</span> <span class="n">K</span><span class="o">-</span><span class="nb">EPSILON </span><span class="n">MODEL</span> <span class="p">:</span> <span class="mi">1</span>
</pre></div>
</div>
<p>Setting the <strong>SOLVER</strong> to <code class="docutils literal notranslate"><span class="pre">1</span></code> instead of the default value of <code class="docutils literal notranslate"><span class="pre">3</span></code> is recommended with <code class="docutils literal notranslate"><span class="pre">TREATMENT</span> <span class="pre">OF</span> <span class="pre">THE</span> <span class="pre">LINEAR</span> <span class="pre">SYSTEM</span> <span class="pre">:</span> <span class="pre">2</span></code> (i.e., the default since v8p2) for consistent and backward-compatible steering files.</p>
<p>Every solver keyword can take an integer value between <code class="docutils literal notranslate"><span class="pre">1</span></code> and <code class="docutils literal notranslate"><span class="pre">8</span></code>, where <code class="docutils literal notranslate"><span class="pre">1</span></code>-<code class="docutils literal notranslate"><span class="pre">6</span></code> use conjugate gradient methods:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> sets the conjugate gradient method for symmetric matrices,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> sets the conjugate residual method,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">3</span></code> sets the conjugate gradient on normal equation method,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">4</span></code> sets the minimum error method,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">5</span></code> sets the squared conjugate gradient method,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">6</span></code> sets the stabilized biconjugate gradient (BICGSTAB) method,</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">7</span></code> sets the <em>Generalised Minimum RESidual</em> (<strong>GMRES</strong>) method, and</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">8</span></code> sets the Yale University direct solver (YSMP) that is not compatible with parallelism.</p></li>
</ul>
<p>The <strong>GMRES method may be enabled with the finite element scheme</strong> with the following solver options for the <a class="reference internal" href="../documentation/glossary.html#term-Krylov-space"><span class="xref std std-term">Krylov space</span></a>:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">SOLVER</span> <span class="n">OPTION</span> <span class="p">:</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">hydrodynamic</span> <span class="n">propagation</span>
<span class="n">SOLVER</span> <span class="n">OPTION</span> <span class="n">FOR</span> <span class="n">TRACERS</span> <span class="n">DIFFUSION</span> <span class="p">:</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">tracer</span> <span class="n">diffusion</span>
<span class="n">OPTION</span> <span class="n">FOR</span> <span class="n">THE</span> <span class="n">SOLVER</span> <span class="n">FOR</span> <span class="n">K</span><span class="o">-</span><span class="nb">EPSILON </span><span class="n">MODEL</span> <span class="p">:</span> <span class="mi">2</span> <span class="o">/</span>  <span class="n">k</span><span class="o">-</span><span class="n">e</span> <span class="nb">or </span><span class="n">Spalart</span><span class="o">-</span><span class="n">Allmaras</span>
</pre></div>
</div>
<p>The solver options vary between values of <strong><code class="docutils literal notranslate"><span class="pre">2</span></code> for a small mesh</strong> and <strong><code class="docutils literal notranslate"><span class="pre">5</span></code> for a large mesh</strong>. Integers of <code class="docutils literal notranslate"><span class="pre">3</span></code> or <code class="docutils literal notranslate"><span class="pre">4</span></code> can be used for medium-sized meshes. The <a class="reference external" href="https://gitlab.pam-retd.fr/otm/telemac-mascaret/-/blob/v8p3r1/documentation/telemac2d/user/telemac2d_user_v8p3.pdf">Telemac2d manual</a> recommends running simulations multiple times for finding an optimum value, where higher values (close to <code class="docutils literal notranslate"><span class="pre">5</span></code>) increase the time required for an iteration but lead to faster convergence.</p>
</div>
<div class="section" id="numerical-accuracy">
<span id="tm2d-accuracy"></span><h3>Numerical Accuracy<a class="headerlink" href="#numerical-accuracy" title="Permalink to this headline">¶</a></h3>
<p><strong>The following descriptions refer to section 7.3.2 in the <a class="reference external" href="https://gitlab.pam-retd.fr/otm/telemac-mascaret/-/blob/v8p3r1/documentation/telemac2d/user/telemac2d_user_v8p3.pdf">Telemac2d manual</a>.</strong></p>
<p>The accuracy keywords make Telemac2d stop an iteration when two consecutive solutions for the same element vary by less than an <strong>ACCURACY</strong> threshold. To this end, the following default accuracy thresholds may be varied (Telemac2d ignores non-relevant parameters):</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">SOLVER</span> <span class="n">ACCURACY</span> <span class="p">:</span> <span class="mf">1.E-4</span> <span class="o">/</span> <span class="n">propagation</span> <span class="n">steps</span>
<span class="n">ACCURACY</span> <span class="n">FOR</span> <span class="n">DIFFUSION</span> <span class="n">OF</span> <span class="n">TRACERS</span> <span class="p">:</span> <span class="mf">1.E-6</span> <span class="o">/</span> <span class="n">tracer</span> <span class="n">diffusion</span>
<span class="n">ACCURACY</span> <span class="n">OF</span> <span class="n">K</span> <span class="p">:</span> <span class="mf">1.E-9</span> <span class="o">/</span> <span class="n">diffusion</span> <span class="nb">and </span><span class="n">source</span> <span class="n">terms</span> <span class="n">of</span> <span class="n">turbulent</span> <span class="n">energy</span> <span class="n">transport</span>
<span class="n">ACCURACY</span> <span class="n">OF</span> <span class="nb">EPSILON</span> <span class="p">:</span> <span class="mf">1.E-9</span> <span class="o">/</span> <span class="n">diffusion</span> <span class="nb">and </span><span class="n">source</span> <span class="n">terms</span> <span class="n">of</span> <span class="n">turbulent</span> <span class="n">dissipation</span> <span class="n">transport</span>
<span class="n">ACCURACY</span> <span class="n">OF</span> <span class="n">SPALART</span><span class="o">-</span><span class="n">ALLMARAS</span> <span class="p">:</span> <span class="mf">1.E-9</span> <span class="o">/</span> <span class="n">diffusion</span> <span class="nb">and </span><span class="n">source</span> <span class="n">terms</span> <span class="n">of</span> <span class="n">the</span> <span class="n">Spalart</span><span class="o">-</span><span class="n">Allmaras</span> <span class="n">equation</span>
</pre></div>
</div>
<p>In experience, the solver accuracy should not be larger than <code class="docutils literal notranslate"><span class="pre">1.E-3</span></code> (10<span class="math notranslate nohighlight">\(^{-3}\)</span>). In contrast, very small accuracies will lead to longer computation times. In addition or alternatively to the accuracy keywords, the following default numbers of maximum iterations can be modified to speed up calculations:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">MAXIMUM</span> <span class="n">NUMBER</span> <span class="n">OF</span> <span class="n">ITERATIONS</span> <span class="n">FOR</span> <span class="n">SOLVER</span> <span class="p">:</span> <span class="mi">100</span> <span class="o">/</span> <span class="n">maximum</span> <span class="n">number</span> <span class="n">of</span> <span class="n">iterations</span> <span class="n">when</span> <span class="n">solving</span> <span class="n">the</span> <span class="n">propagation</span> <span class="n">step</span>
<span class="n">MAXIMUM</span> <span class="n">NUMBER</span> <span class="n">OF</span> <span class="n">ITERATIONS</span> <span class="n">FOR</span> <span class="n">DIFFUSION</span> <span class="n">OF</span> <span class="n">TRACERS</span> <span class="p">:</span> <span class="mi">60</span> <span class="o">/</span> <span class="n">tracer</span> <span class="n">diffusion</span>
<span class="n">MAXIMUM</span> <span class="n">NUMBER</span> <span class="n">OF</span> <span class="n">ITERATIONS</span> <span class="n">FOR</span> <span class="n">K</span> <span class="nb">AND EPSILON</span> <span class="p">:</span> <span class="mi">50</span> <span class="o">/</span> <span class="n">diffusion</span> <span class="nb">and </span><span class="n">source</span> <span class="n">terms</span> <span class="n">of</span> <span class="n">k</span><span class="o">-</span><span class="n">e</span> <span class="nb">or </span><span class="n">Spalart</span><span class="o">-</span><span class="n">Allmaras</span>
</pre></div>
</div>
<p>Telemac2d will print out warning messages when convergence could not be reached with the defined combination of accuracy and maximum iteration number keywords. The warning message printouts can be deactivated with the <strong>INFORMATION ABOUT SOLVER</strong> keyword, though deactivating convergence warnings is not recommended.</p>
</div>
<div class="section" id="tidal-flats">
<span id="tm2d-tidal"></span><h3>Tidal Flats<a class="headerlink" href="#tidal-flats" title="Permalink to this headline">¶</a></h3>
<p><strong>The following descriptions refer to section 7.5 in the <a class="reference external" href="https://gitlab.pam-retd.fr/otm/telemac-mascaret/-/blob/v8p3r1/documentation/telemac2d/user/telemac2d_user_v8p3.pdf">Telemac2d manual</a>.</strong></p>
<p>The <strong>TIDAL FLATS (default: <code class="docutils literal notranslate"><span class="pre">YES</span></code>)</strong> keyword applies to the <strong>finite elements scheme only (<a class="reference internal" href="#tm2d-numerical"><span class="std std-ref">EQUATIONS keyword</span></a>)</strong> and can be ignored with finite volumes. The term <em>tidal</em> may be slightly confusing because tidal flats can occur beyond coastal regions: Tidal flats can occur wherever wetting and drying of grid cells may occur or at flow transitions (e.g., when fast-flowing water enters a backwater zone). Wetting and drying, and flow transitions occur in almost all environments more complex than a square-like flume, and therefore, the activation of tidal flats in Telemac2d models is highly recommended. Though activating tidal flats leads to longer computation times, in most cases a calculation with tidal flats provides physically reasonable results.</p>
<p>The <strong>TIDAL FLATS</strong> keyword is linked with a couple of other Telemac2d keywords driving model stability and physical meaningfulness. The following keyword setups may be generally applied to (quasi) steady, real-world rivers and channels (as opposed to lab flumes with simplified geometries):</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">TIDAL</span> <span class="n">FLATS</span> <span class="p">:</span> <span class="n">YES</span>
<span class="n">CONTINUITY</span> <span class="n">CORRECTION</span> <span class="p">:</span> <span class="n">YES</span> <span class="o">/</span> <span class="n">default</span> <span class="k">is </span><span class="n">NO</span>
<span class="n">OPTION</span> <span class="n">FOR</span> <span class="n">THE</span> <span class="n">TREATMENT</span> <span class="n">OF</span> <span class="n">TIDAL</span> <span class="n">FLATS</span> <span class="p">:</span> <span class="mi">1</span>
<span class="n">TREATMENT</span> <span class="n">OF</span> <span class="n">NEGATIVE</span> <span class="n">DEPTHS</span> <span class="p">:</span> <span class="mi">2</span> <span class="o">/</span> <span class="k">value </span><span class="mi">2</span> <span class="nb">or </span><span class="mi">3</span> <span class="k">is </span><span class="n">required</span> <span class="n">with</span> <span class="n">tidal</span> <span class="n">flats</span>
</pre></div>
</div>
<p>The <strong>OPTION FOR THE TREATMENT OF TIDAL FLATS</strong> accepts integer values between <code class="docutils literal notranslate"><span class="pre">1</span></code> and <code class="docutils literal notranslate"><span class="pre">3</span></code> to select one of the following options:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> detects tidal flats and corrects the free surface gradient.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> removes tidal flat elements by using a masking table that eliminates any contribution of concerned mesh elements. This option may affect the mass conservation of the model.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">3</span></code> resembles <code class="docutils literal notranslate"><span class="pre">1</span></code>, but adds a porosity term to half-dry mesh elements. This affects the amount of water in the model, which equals here the depth integral multiplied by the porosity. A user Fortran file may be used to modify the porosity term in the <code class="docutils literal notranslate"><span class="pre">USER_CORPOR</span></code> subroutine.</p></li>
</ul>
<p>The <strong>TREATMENT OF NEGATIVE DEPTHS (default: <code class="docutils literal notranslate"><span class="pre">1</span></code>)</strong> keyword defines an approach for eliminating negative water depth values where the following integer numbers can be used:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code> disables any treatment of negative water depths.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> conservatively smoothens negative water depths (<strong>default</strong>).</p>
<ul>
<li><p>A float number keyword <code class="docutils literal notranslate"><span class="pre">THRESHOLD</span> <span class="pre">FOR</span> <span class="pre">NEGATIVE</span> <span class="pre">DEPTHS</span></code> (default: <code class="docutils literal notranslate"><span class="pre">0.</span></code>) is available only for this option.</p></li>
<li><p>Setting the threshold to, for instance, <code class="docutils literal notranslate"><span class="pre">-0.1</span></code> makes that negative water depths larger (e.g., -0.05 m) than -0.1 meters remain unchanged.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> imposes a flux limitation that strictly ensures positive water depths.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">3</span></code> acts similarly as <code class="docutils literal notranslate"><span class="pre">2</span></code> but for the ERIA <a class="reference internal" href="../documentation/glossary.html#term-Advection"><span class="xref std std-term">Advection</span></a> scheme (set <code class="docutils literal notranslate"><span class="pre">SCHEME</span> <span class="pre">FOR</span> <span class="pre">ADVECTION</span> <span class="pre">OF</span> <span class="pre">TRACERS</span></code> to <code class="docutils literal notranslate"><span class="pre">4</span></code> or <code class="docutils literal notranslate"><span class="pre">5</span></code>). This option is appropriate for modeling conservative tracers.</p></li>
</ul>
<div class="tip admonition">
<p class="admonition-title">TIDAL FLATS options require particular keyword combinations</p>
<p>The <strong>SCHEME FOR ADVECTION …</strong> keywords (see the <a class="reference internal" href="#tm2d-fe"><span class="std std-ref">finite element parameters</span></a> section) must be set for <strong>TRACERS</strong> to LIPS (either <code class="docutils literal notranslate"><span class="pre">4</span></code> or <code class="docutils literal notranslate"><span class="pre">5</span></code>), and for all others to either a NERD (<code class="docutils literal notranslate"><span class="pre">13</span></code> or <code class="docutils literal notranslate"><span class="pre">14</span></code>) or the ERIA (<code class="docutils literal notranslate"><span class="pre">15</span></code>) scheme.</p>
<p>When using LIPS (<code class="docutils literal notranslate"><span class="pre">4</span></code> or <code class="docutils literal notranslate"><span class="pre">5</span></code>) with NERD (<code class="docutils literal notranslate"><span class="pre">13</span></code> or <code class="docutils literal notranslate"><span class="pre">14</span></code>) use the following combination (<strong>used in this tutorial</strong>):</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">TIDAL</span> <span class="n">FLATS</span> <span class="p">:</span> <span class="n">YES</span>
<span class="n">OPTION</span> <span class="n">FOR</span> <span class="n">THE</span> <span class="n">TREATMENT</span> <span class="n">OF</span> <span class="n">TIDAL</span> <span class="n">FLATS</span> <span class="p">:</span> <span class="mi">1</span>
<span class="n">TREATMENT</span> <span class="n">OF</span> <span class="n">NEGATIVE</span> <span class="n">DEPTHS</span> <span class="p">:</span> <span class="mi">2</span>
</pre></div>
</div>
<p>When using LIPS (<code class="docutils literal notranslate"><span class="pre">4</span></code> or <code class="docutils literal notranslate"><span class="pre">5</span></code>) with ERIA (<code class="docutils literal notranslate"><span class="pre">15</span></code>) use the following combination:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">TIDAL</span> <span class="n">FLATS</span> <span class="p">:</span> <span class="n">YES</span>
<span class="n">OPTION</span> <span class="n">FOR</span> <span class="n">THE</span> <span class="n">TREATMENT</span> <span class="n">OF</span> <span class="n">TIDAL</span> <span class="n">FLATS</span> <span class="p">:</span> <span class="mi">1</span>
<span class="n">TREATMENT</span> <span class="n">OF</span> <span class="n">NEGATIVE</span> <span class="n">DEPTHS</span> <span class="p">:</span> <span class="mi">3</span>
</pre></div>
</div>
<p>Read more about viable or trouble-making parameter combinations for tidal flats in section 16.5 in the <a class="reference external" href="https://gitlab.pam-retd.fr/otm/telemac-mascaret/-/blob/v8p3r1/documentation/telemac2d/user/telemac2d_user_v8p3.pdf">Telemac2d manual</a>.</p>
</div>
</div>
<div class="section" id="matrix-handling">
<h3>Matrix Handling<a class="headerlink" href="#matrix-handling" title="Permalink to this headline">¶</a></h3>
<p><strong>The following descriptions refer to section 7.6 in the <a class="reference external" href="https://gitlab.pam-retd.fr/otm/telemac-mascaret/-/blob/v8p3r1/documentation/telemac2d/user/telemac2d_user_v8p3.pdf">Telemac2d manual</a>.</strong></p>
<p>Telemac2d provides multiple options for matrix handling that need to be set up for particular solver schemes.</p>
<p>The <strong>MATRIX STORAGE</strong> keyword may be set to:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> for using classic element-by-element matrix storage.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">3</span></code> for using edge-based matrix storage (default). This default is required when any <strong>SCHEME FOR ADVECTION …</strong> keyword is set to <code class="docutils literal notranslate"><span class="pre">3</span></code>, <code class="docutils literal notranslate"><span class="pre">4</span></code>, <code class="docutils literal notranslate"><span class="pre">5</span></code>, <code class="docutils literal notranslate"><span class="pre">13</span></code>, <code class="docutils literal notranslate"><span class="pre">14</span></code>, or <code class="docutils literal notranslate"><span class="pre">15</span></code>, and when any direct <strong>SOLVER</strong> is set to <code class="docutils literal notranslate"><span class="pre">8</span></code>.</p></li>
</ul>
<p>The additional <strong>MATRIX-VECTOR PRODUCT</strong> keyword may be used to switch between multiplication methods for the finite element scheme. However, the default value of <code class="docutils literal notranslate"><span class="pre">1</span></code> (vector multiplication by a non-assembled matrix) should currently <strong>not be changed</strong> because the only alternative (<code class="docutils literal notranslate"><span class="pre">2</span></code> for frontal assembled matrix multiplication) is not implemented for parallelism and quasi-bubble discretization.</p>
</div>
<div class="section" id="friction-boundary-conditions">
<span id="tm2d-friction"></span><h3>Friction Boundary Conditions<a class="headerlink" href="#friction-boundary-conditions" title="Permalink to this headline">¶</a></h3>
<p><strong>The following descriptions of friction parameters refer to section 6.1 in the <a class="reference external" href="https://gitlab.pam-retd.fr/otm/telemac-mascaret/-/blob/v8p3r1/documentation/telemac2d/user/telemac2d_user_v8p3.pdf">Telemac2d manual</a>.</strong></p>
<p>Parameters for <strong>Boundary Conditions</strong> enable the definition of roughness laws and properties of liquid boundaries.</p>
<p>The <strong>LAW OF BOTTOM FRICTION</strong> keyword defines a friction law for topographic boundaries, which can be set to:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">0</span></code> for no friction.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> for the <span id="id8">Haaland [<a class="reference internal" href="../documentation/bibliography.html#id1361">Haa83</a>]</span> equation, which is an implicit form of the <span id="id9">Colebrook and White [<a class="reference internal" href="../documentation/bibliography.html#id1357">CW37</a>]</span> equation that builds on the Darcy-Weisbach friction factor <span class="math notranslate nohighlight">\(f_D\)</span>. This law involves a high degree of uncertainty that stems from the experimental dataset of the original author.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> for the <span id="id10">Chézy [<a class="reference internal" href="../documentation/bibliography.html#id118">Che76</a>]</span> roughness that can be similarly used as <code class="docutils literal notranslate"><span class="pre">3</span></code> and <code class="docutils literal notranslate"><span class="pre">4</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">3</span></code> for <span id="id11">Strickler [<a class="reference internal" href="../documentation/bibliography.html#id560">Str23</a>]</span> roughness <span class="math notranslate nohighlight">\(k_{st}\)</span> (read more, for example, in the <a class="reference internal" href="../exercises/ex-ms.html#ex-1d-hydraulics"><span class="std std-ref"> 1d hydraulics exercise</span></a>), which is the inverse of <span class="math notranslate nohighlight">\(n_m\)</span> (<code class="docutils literal notranslate"><span class="pre">4</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">4</span></code> for <span id="id12">Manning [<a class="reference internal" href="../documentation/bibliography.html#id378">Man91</a>]</span> roughness <span class="math notranslate nohighlight">\(n_m\)</span> (read more, for example, in the <a class="reference internal" href="../exercises/ex-ms.html#ex-1d-hydraulics"><span class="std std-ref"> 1d hydraulics exercise</span></a>), which is the inverse of <span class="math notranslate nohighlight">\(k_{st}\)</span> (<code class="docutils literal notranslate"><span class="pre">3</span></code>).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">5</span></code> for the <span id="id13">Nikuradse [<a class="reference internal" href="../documentation/bibliography.html#id419">Nik33</a>]</span> roughness law, which should correspond to 3 <span class="math notranslate nohighlight">\(\cdot D_{90}\)</span> according to <span id="id14">van Rijn [<a class="reference internal" href="../documentation/bibliography.html#id1356">vR19</a>]</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">6</span></code> for the logarithmic law of the wall for turbulent flows. This option assumes that the average flow velocity is a logarithmic function of the distance from the wall beyond the viscous and buffer layers. The thickness of these layers is a function of the wall roughness length <span id="id15">[<a class="reference internal" href="../documentation/bibliography.html#id595">VK30</a>]</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">7</span></code> for the <span id="id16">Colebrook and White [<a class="reference internal" href="../documentation/bibliography.html#id1357">CW37</a>]</span> equation that calculates the Darcy-Weisbach friction factor <span class="math notranslate nohighlight">\(f_D\)</span> for turbulent flows in smooth pipes.</p></li>
</ul>
<p>With respect to the 2d applications in this eBook, the most relevant bottom friction laws are <code class="docutils literal notranslate"><span class="pre">3</span></code> <span id="id17">[<a class="reference internal" href="../documentation/bibliography.html#id560">Str23</a>]</span>, <code class="docutils literal notranslate"><span class="pre">4</span></code> <span id="id18">[<a class="reference internal" href="../documentation/bibliography.html#id378">Man91</a>]</span>, and <code class="docutils literal notranslate"><span class="pre">6</span></code> (log law). The <span id="id19">Nikuradse [<a class="reference internal" href="../documentation/bibliography.html#id419">Nik33</a>]</span> roughness law (<code class="docutils literal notranslate"><span class="pre">5</span></code>) is recommended for 3d simulations (see the <a class="reference internal" href="telemac3d-med.html#tm3d-hydrodynamics"><span class="std std-ref">Telemac3d tutorial</span></a>). Moreover, friction is more generally referred to with the general coefficient <span class="math notranslate nohighlight">\(c_{f}\)</span>, which has a particular relevance for <a class="reference internal" href="../documentation/glossary.html#term-Bedload"><span class="xref std std-term">Bedload</span></a> transport (cf. <a class="reference internal" href="gaia-bedload.html#c-friction"><span class="std std-ref">morphodynamic calculations with Gaia</span></a>).</p>
<p>The <strong>FRICTION COEFFICIENT FOR THE BOTTOM</strong> keyword sets the value for a characteristic roughness coefficient. For instance, when the friction law keyword is set to <code class="docutils literal notranslate"><span class="pre">3</span></code> <span id="id20">[<a class="reference internal" href="../documentation/bibliography.html#id560">Str23</a>]</span>, the friction corresponds to the Strickler roughness coefficient <span class="math notranslate nohighlight">\(k_{st}\)</span> (in fictive units of m<span class="math notranslate nohighlight">\(^{1/3}\)</span> s<span class="math notranslate nohighlight">\(^{-1}\)</span>). For rough channels (e.g., mountain rivers) <span class="math notranslate nohighlight">\(k_{st} \approx 20\)</span> m<span class="math notranslate nohighlight">\(^{1/3}\)</span> s<span class="math notranslate nohighlight">\(^{-1}\)</span> and for smooth concrete-lined channels <span class="math notranslate nohighlight">\(k_{st} \approx 75\)</span> m<span class="math notranslate nohighlight">\(^{1/3}\)</span> s<span class="math notranslate nohighlight">\(^{-1}\)</span>. In fully turbulent flows, the Strickler roughness can be approximated with <span class="math notranslate nohighlight">\(k_{st} \approx \frac{26}{D_{90}^{1/6}}\)</span> <span id="id21">[<a class="reference internal" href="../documentation/bibliography.html#id389">MPM48</a>]</span> where <span class="math notranslate nohighlight">\(D_{90}\)</span> is the grain diameter of which 90% of the surface grain mixture are finer.
This tutorial features the application of a <em>Manning</em> roughness coefficient of <span class="math notranslate nohighlight">\(n_m\)</span>= 0.03, which is the inverse of <span class="math notranslate nohighlight">\(k_{st}\)</span> and implemented with:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">LAW</span> <span class="n">OF</span> <span class="n">BOTTOM</span> <span class="n">FRICTION</span> <span class="p">:</span> <span class="mi">4</span> <span class="o">/</span> <span class="mi">4</span><span class="o">-</span><span class="n">Manning</span>
<span class="n">FRICTION</span> <span class="n">COEFFICIENT</span> <span class="p">:</span> <span class="mf">0.03</span> <span class="o">/</span> <span class="n">Roughness</span> <span class="n">coefficient</span>
</pre></div>
</div>
<details class="sphinx-bs dropdown card mb-3">
<summary class="summary-title card-header">
Expand to see exemplary values for Manning roughness<div class="summary-down docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="summary-up docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="summary-content card-body docutils">
<p class="card-text"><a class="reference internal" href="#tab-mannings-n"><span class="std std-numref">Table 7</span></a> lists exemplary values for the Manning roughness coefficient <span class="math notranslate nohighlight">\(n_m\)</span> based on <span id="id22">Aldridge and Garrett [<a class="reference internal" href="../documentation/bibliography.html#id1359">AG73</a>]</span> and <span id="id23">Arcement and Schneider [<a class="reference internal" href="../documentation/bibliography.html#id1358">AS89</a>]</span>.</p>
<table class="table" id="tab-mannings-n">
<caption><span class="caption-number">Table 7 </span><span class="caption-text">Exemplary values for Manning roughness for straight uniform channels.</span><a class="headerlink" href="#tab-mannings-n" title="Permalink to this table">¶</a></caption>
<colgroup>
<col style="width: 33%" />
<col style="width: 33%" />
<col style="width: 33%" />
</colgroup>
<thead>
<tr class="row-odd"><th class="head"><p class="card-text">Surface type</p></th>
<th class="head"><p class="card-text">Material diameter (10<span class="math notranslate nohighlight">\(^{-3}\)</span>m)</p></th>
<th class="head"><p class="card-text"><span class="math notranslate nohighlight">\(n_m\)</span> (m<span class="math notranslate nohighlight">\(^{-1/3}\)</span>s)</p></th>
</tr>
</thead>
<tbody>
<tr class="row-even"><td><p class="card-text">Concrete</p></td>
<td><p class="card-text"><span class="math notranslate nohighlight">\(-\)</span></p></td>
<td><p class="card-text">0.012-0.018</p></td>
</tr>
<tr class="row-odd"><td><p class="card-text">Firm soil</p></td>
<td><p class="card-text"><span class="math notranslate nohighlight">\(-\)</span></p></td>
<td><p class="card-text">0.025-0.032</p></td>
</tr>
<tr class="row-even"><td><p class="card-text">Coarse sand</p></td>
<td><p class="card-text">1-2</p></td>
<td><p class="card-text">0.026-0.035</p></td>
</tr>
<tr class="row-odd"><td><p class="card-text">Gravel</p></td>
<td><p class="card-text">2-64</p></td>
<td><p class="card-text">0.028-0.035</p></td>
</tr>
<tr class="row-even"><td><p class="card-text">Cobble</p></td>
<td><p class="card-text">64-256</p></td>
<td><p class="card-text">0.030-0.050</p></td>
</tr>
<tr class="row-odd"><td><p class="card-text">Boulder</p></td>
<td><p class="card-text"><span class="math notranslate nohighlight">\(&gt;\)</span> 256</p></td>
<td><p class="card-text">0.040-0.070</p></td>
</tr>
</tbody>
</table>
</div>
</details><div class="tip dropdown admonition">
<p class="admonition-title">Friction zones (regional friction values)</p>
<p>Similar to the assignment of multiple friction coefficient values to multiple model regions featured in the <a class="reference internal" href="basement2d.html#bm-geometry"><span class="std std-ref">BASEMENT tutorial</span></a>, Telemac2d provides routines for domain-wise (i.e., zonal) friction area definitions in the geometry (e.g., <code class="docutils literal notranslate"><span class="pre">*.slf</span></code>) file. To create a zonal roughness Selafin geometry with QGIS and BlueKenue use the <em><a class="reference external" href="https://github.com/hydro-informatics/telemac/raw/main/friction/create-friction-zone-slf.pdf">Create Roughness Selafin File PDF workflow</a></em>. Some additional hints for using the workflow:</p>
<ul class="simple">
<li><p>Delineate zones with different roughness coefficients by drawing polygons (e.g., following landscapes characteristics on a basemap) in separate shapefiles with QGIS (see also the <a class="reference internal" href="pre-slf-tm.html#tm-qgis-prepro"><span class="std std-ref">pre-processing tutorial on QGIS</span></a>).</p></li>
<li><p>Import the separate polygons as XYZ file or closed lines in BlueKenue (see also the <a class="reference internal" href="pre-slf-tm.html#bk-tutorial"><span class="std std-ref">pre-processing tutorial on BlueKenue</span></a>).</p></li>
<li><p>Assign elevations to the polygons (closed lines) in BlueKenue (requires <a class="reference internal" href="pre-slf-tm.html#bk-xyz"><span class="std std-ref">elevation information</span></a>).</p></li>
<li><p>Add a new variable to the <a class="reference internal" href="pre-slf-tm.html#bk-create-slf"><span class="std std-ref">Selafin</span></a> geometry and call it BOTTOM FRICTION.</p></li>
<li><p>Use the <a class="reference internal" href="pre-slf-tm.html#bk-2dinterp"><span class="std std-ref">Map Object</span></a> function (<em>Tools</em> &gt; <em>Map Object…</em>) to add the polygons (closed lines) to the BOTTOM FRICTION mesh variable.</p></li>
<li><p>In the <code class="docutils literal notranslate"><span class="pre">*.cas</span></code> file, make sure to set a value for the <strong>FRICTION</strong> parameter according to the above descriptions and to set the <code class="docutils literal notranslate"><span class="pre">*.slf</span></code> file with the BOTTOM FRICTION variable for the <strong>ZONES FILE</strong> keyword.</p></li>
</ul>
<p>Useful examples for creating roughness zones are:</p>
<ul class="simple">
<li><p>The BAW’s Donau case study that lives in <code class="docutils literal notranslate"><span class="pre">/telemac/v8p2/examples/telemac2d/donau/</span></code> and features the usage of a <code class="docutils literal notranslate"><span class="pre">*.bfr</span></code> <strong>ZONES FILE</strong>, and a <code class="docutils literal notranslate"><span class="pre">roughness.tbl</span></code> <strong>FRICTION DATA FILE</strong>. Zonal friction values are enabled through the <code class="docutils literal notranslate"><span class="pre">FRICTION</span> <span class="pre">DATA</span> <span class="pre">:</span> <span class="pre">YES</span></code> keyword in the <code class="docutils literal notranslate"><span class="pre">t2d_donau.cas</span></code> file. The Donau example was also presented at the XXth Telemac-Mascaret user conference and the conference proceedings are available at the BAW’s <a class="reference external" href="https://hdl.handle.net/20.500.11970/100418">HENRY portal</a> (look for the contribution <em>Reverse engineering of initial &amp; boundary conditions with TELEMAC and algorithmic differentiation</em>).</p></li>
<li><p>The <a class="reference external" href="http://www.opentelemac.org/index.php/component/jdownloads/summary/4-training-and-tutorials/185-telemac-2d-tutorial?Itemid=55">Baxter tutorial</a>.</p></li>
</ul>
<p>In addition, Appendix E of the <a class="reference external" href="https://gitlab.pam-retd.fr/otm/telemac-mascaret/-/blob/v8p3r1/documentation/telemac2d/user/telemac2d_user_v8p3.pdf">Telemac2d manual</a> provides explanations for the implementation of zonal friction values. Note that the proposed modification of the <strong>FRICTION_USER</strong> Fortran function (subroutine) is not mandatory. Here are some hints if the FRICTION_USER subroutines must be enabled anyway (e.g., to implement a new roughness law such as the <span id="id24">Ferguson [<a class="reference internal" href="../documentation/bibliography.html#id187">Fer07</a>]</span> equation):</p>
<ul class="simple">
<li><p>The FICTION_USER subroutine can be found in <code class="docutils literal notranslate"><span class="pre">/telemac/v8p2/sources/telemac2d/friction_user.f</span></code>.</p></li>
<li><p>To use a modified version, copy <code class="docutils literal notranslate"><span class="pre">friction_user.f</span></code> to a new subfolder called <code class="docutils literal notranslate"><span class="pre">/user_fortran/</span></code> in your simulation case folder.</p></li>
<li><p>Modify and save edits in <code class="docutils literal notranslate"><span class="pre">/your/simulation/case/user_fortran/friction_user.f</span></code>.</p></li>
<li><p>Tell the steering (<code class="docutils literal notranslate"><span class="pre">*.cas</span></code>) file to use the modified FRICTION_USER Fortran file by adding the keyword <code class="docutils literal notranslate"><span class="pre">FORTRAN</span> <span class="pre">FILE</span> <span class="pre">:</span> <span class="pre">'user_fortran'</span></code> (makes Telemac2d looking up Fortran files in the <code class="docutils literal notranslate"><span class="pre">/user_fortran/</span></code> subfolder).</p></li>
</ul>
</div>
</div>
<div class="section" id="liquid-boundary-conditions">
<span id="tm2d-bounds"></span><h3>Liquid Boundary Conditions<a class="headerlink" href="#liquid-boundary-conditions" title="Permalink to this headline">¶</a></h3>
<p><strong>The following descriptions of friction parameters refer to section 4.2 in the <a class="reference external" href="https://gitlab.pam-retd.fr/otm/telemac-mascaret/-/blob/v8p3r1/documentation/telemac2d/user/telemac2d_user_v8p3.pdf">Telemac2d manual</a>.</strong></p>
<p>Liquid boundary keywords assign hydraulic properties to the spatially defined upstream and downstream liquid boundary lines in the Conlim (<code class="docutils literal notranslate"><span class="pre">*.cli</span></code>) file <a class="reference internal" href="pre-slf-tm.html#bk-liquid-bc"><span class="std std-ref">created with BlueKenue</span></a>. This section features the assignment of steady liquid boundaries for one discharge of 35 m<span class="math notranslate nohighlight">\(^3\)</span>/s. To this end, the upstream boundary condition is set to a steady target inflow rate (<em>Open boundary with prescribed Q</em>) and the downstream boundary condition gets a <a class="reference internal" href="../documentation/glossary.html#term-Stage-discharge-relation"><span class="xref std std-term">Stage-discharge relation</span></a> (<em>Open boundary with prescribed Q and H</em>) assigned (recall <a class="reference internal" href="pre-slf-tm.html#bk-bc-types"><span class="std std-numref">Fig. 75</span></a>). Thus, for running this tutorial add the following keywords to the steering (<code class="docutils literal notranslate"><span class="pre">*.cas</span></code>) file:</p>
<ul class="simple">
<li><p>The keyword <code class="docutils literal notranslate"><span class="pre">PRESCRIBED</span> <span class="pre">FLOWRATES</span> <span class="pre">:</span> <span class="pre">35.;35.</span></code> assigns a flowrate of 35 m<span class="math notranslate nohighlight">\(^3\)</span>/s to the <strong>upstream</strong> and the <strong>downstream</strong> boundary edges, respectively.</p></li>
<li><p>The keyword <code class="docutils literal notranslate"><span class="pre">PRESCRIBED</span> <span class="pre">ELEVATIONS</span> <span class="pre">:</span> <span class="pre">0.;371.33</span></code> assigns a water surface elevation <span class="math notranslate nohighlight">\(wse\)</span> (or H in Telemac) of 371.33 m a.s.l. (above sea level) to the <strong>downstream</strong> boundary. The upstream <span class="math notranslate nohighlight">\(wse\)</span> prescription of 0.0 makes Telemac2d ignore this value corresponding to the assigned upstream boundary type (prescribed flowrate only).</p></li>
</ul>
<p>The order of prescribed flowrates (Q) and <span class="math notranslate nohighlight">\(wse\)</span> (H) values depends on the order of the definition of the boundaries. Thus, the first list element defines values for the upstream and the second list element for the downstream open boundary.</p>
<div class="tip admonition">
<p class="admonition-title">How to find out the order of boundary conditions?</p>
<p>The order of open boundaries can be read from the <code class="docutils literal notranslate"><span class="pre">*.cli</span></code> file. The first open boundary that is listed in the <code class="docutils literal notranslate"><span class="pre">*.cli</span></code> file corresponds to the first list element in any <strong>PRESCRIBED …</strong> keyword. An open boundary node in the <code class="docutils literal notranslate"><span class="pre">*.cli</span></code> file is characterized by a line beginning with something like <code class="docutils literal notranslate"><span class="pre">4</span> <span class="pre">5</span> <span class="pre">5</span></code> or <code class="docutils literal notranslate"><span class="pre">5</span> <span class="pre">5</span> <span class="pre">5</span></code> (i.e., anything but <code class="docutils literal notranslate"><span class="pre">2</span> <span class="pre">2</span> <span class="pre">2</span></code>, which corresponds to a closed wall boundary node) and BlueKenue also marks the names of open boundaries at the line ends (after the hashtag). <a class="reference internal" href="#boundary-cli"><span class="std std-numref">Figure 79</span></a> illustrates the <a class="reference external" href="https://github.com/hydro-informatics/telemac/raw/main/bk-slf/boundaries.cli">boundaries.cli</a> file used in this chapter where the <code class="docutils literal notranslate"><span class="pre">upstream</span></code> open boundary is defined at line 7, before the definition of the downstream open boundary starting at line 313.</p>
<div class="figure align-default" id="boundary-cli">
<img alt="telemac 2d cli boundary conditions order cas steering file prescribed prescription" src="../_images/boundary-cli.png" />
<p class="caption"><span class="caption-number">Fig. 79 </span><span class="caption-text">The <a class="reference external" href="https://github.com/hydro-informatics/telemac/raw/main/bk-slf/boundaries.cli">boundaries.cli</a> file used in this tutorial starts with the upstream boundary defined in line 7. To find the downstream boundary scroll down to line 313.</span><a class="headerlink" href="#boundary-cli" title="Permalink to this image">¶</a></p>
</div>
</div>
<p>Liquid boundary conditions may be assigned to any open boundary in the <code class="docutils literal notranslate"><span class="pre">*.cli</span></code> file.</p>
<div class="note dropdown admonition">
<p class="admonition-title">External files instead of PRESCRIBED-keywords</p>
<p>Instead of a list of semi-colon separated numbers in the steering file, liquid boundary conditions can also be defined with a liquid boundary condition file in <em>ASCII</em> text format. For this purpose, the <code class="docutils literal notranslate"><span class="pre">LIQUID</span> <span class="pre">BOUNDARIES</span> <span class="pre">FILE</span></code> and/or <code class="docutils literal notranslate"><span class="pre">STAGE-DISCHARGE</span> <span class="pre">CURVES</span> <span class="pre">FILE</span></code> keywords need to be defined in the steering file. External files are required for the simulation of quasi-unsteady flows (e.g., a flood hydrograph or low flow sequences for habitat conditions) and more details can be found in sections 4.2.5 and 4.2.6 in the <a class="reference external" href="https://gitlab.pam-retd.fr/otm/telemac-mascaret/-/blob/v8p3r1/documentation/telemac2d/user/telemac2d_user_v8p3.pdf">Telemac2d manual</a> or the <a class="reference internal" href="telemac2d-unsteady.html#chpt-unsteady"><span class="std std-ref">unsteady section in this eBook</span></a>.</p>
</div>
<p>A velocity profile type can be assigned to any prescribed Q (flowrate) or prescribed U (velocity) open boundary in the form of a list that has the same element order as the above-defined <strong>PRESCRIBED …</strong> keywords. For this purpose, upstream and downstream velocity profiles can be defined with the <strong>VELOCITY PROFILES</strong> keyword that accepts the following values:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> is the <strong>default</strong> option that defines the flow velocity direction at the boundary nodes normal to their edges. This option assigns a length of 1 to the vector and multiplies it with a numeric factor to yield a target flowrate.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> reads U and V velocity profiles from the boundary conditions (<code class="docutils literal notranslate"><span class="pre">*.cli</span></code>) file, which are multiplied with a constant to yield a target flowrate.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">3</span></code> imposes the velocity vector direction normal to the boundary and reads the value (UBOR) from the <code class="docutils literal notranslate"><span class="pre">*.cli</span></code> file, which is then multiplied by a constant to yield a target flowrate.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">4</span></code> imposes the velocity vector direction normal to the boundary and calculates the value’s norm proportional to the square root of the water depth. This option can only be used with a <em>prescribed Q</em> open boundary.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">5</span></code> imposes the velocity vector direction normal to the boundary and calculates the value’s norm proportional to the square root of a virtual water depth.</p></li>
</ul>
<p>With the upstream boundary being a <em>prescribed Q</em> boundary, this tutorial uses <code class="docutils literal notranslate"><span class="pre">VELOCITY</span> <span class="pre">PROFILES</span> <span class="pre">:</span> <span class="pre">4;1</span></code> in the steering file. Read more about options for defining velocity profiles in section 4.2.8 of the <a class="reference external" href="https://gitlab.pam-retd.fr/otm/telemac-mascaret/-/blob/v8p3r1/documentation/telemac2d/user/telemac2d_user_v8p3.pdf">Telemac2d manual</a>.</p>
</div>
<div class="section" id="initial-conditions">
<span id="tm2d-init"></span><h3>Initial Conditions<a class="headerlink" href="#initial-conditions" title="Permalink to this headline">¶</a></h3>
<p><strong>The following descriptions refer to section 4.1 in the <a class="reference external" href="https://gitlab.pam-retd.fr/otm/telemac-mascaret/-/blob/v8p3r1/documentation/telemac2d/user/telemac2d_user_v8p3.pdf">Telemac2d manual</a>.</strong></p>
<p>The initial conditions describe the state of the model at the beginning of a simulation. Telemac2d recognizes the following types of initial conditions, which can be defined in the steering file with the keyword <code class="docutils literal notranslate"><span class="pre">INITIAL</span> <span class="pre">CONDITIONS</span> <span class="pre">:</span> <span class="pre">'TYPE'</span></code> where <code class="docutils literal notranslate"><span class="pre">TYPE</span></code> can be one of the following:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">ZERO</span> <span class="pre">ELEVATION</span></code> initializes the free surface elevation at 0 (<strong>default</strong>). Thus, the initial water depths correspond to the bottom elevation.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONSTANT</span> <span class="pre">ELEVATION</span></code> initializes the free surface elevation at a value defined with an <strong>INITIAL ELEVATION</strong> keyword that has a default value of <code class="docutils literal notranslate"><span class="pre">0.</span></code>. Thus, the initial water depths correspond to the subtraction of the bottom elevation from the water surface elevation <span class="math notranslate nohighlight">\(wse\)</span>. The initial water depth is set to zero at nodes where the bottom elevation is higher than defined by the <strong>INITIAL ELEVATION</strong> keyword.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">ZERO</span> <span class="pre">DEPTH</span></code> initializes the simulation with <code class="docutils literal notranslate"><span class="pre">0</span></code> (i.e., <span class="math notranslate nohighlight">\(wse\)</span> corresponds to bottom elevation). Thus, the model starts with dry conditions, similar as in the <a class="reference internal" href="basement2d.html#basement2d"><span class="std std-ref">BASEMENT</span></a> tutorial.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">CONSTANT</span> <span class="pre">DEPTH</span></code> initializes the water depths at a value defined by an <strong>INITIAL DEPTH</strong> keyword that has a default value of <code class="docutils literal notranslate"><span class="pre">0.</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TPXO</span> <span class="pre">SATELLITE</span> <span class="pre">ALTIMETRY</span></code> initializes the model using information provided by a user-defined database (e.g., the <a class="reference external" href="http://g.hyyb.org/archive/Tide/TPXO/TPXO_WEB/global.html">OSU TPXO model for ocean tides</a>). Read more in section 4.2.12 of the <a class="reference external" href="https://gitlab.pam-retd.fr/otm/telemac-mascaret/-/blob/v8p3r1/documentation/telemac2d/user/telemac2d_user_v8p3.pdf">Telemac2d manual</a> on modeling marine systems.</p></li>
</ul>
<p>This tutorial uses a <em>constant</em> water <em>depth</em> initial condition of <code class="docutils literal notranslate"><span class="pre">1</span></code> (integer to speed up calculations), which corresponds to a completely flooded initial model state (i.e., water volume surplus):</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="n">INITIAL</span> <span class="n">CONDITIONS</span> <span class="p">:</span> <span class="s1">&#39;CONSTANT DEPTH&#39;</span>
<span class="n">INITIAL</span> <span class="n">DEPTH</span> <span class="p">:</span> <span class="mi">1</span>
</pre></div>
</div>
<p>The simulation speed can be significantly increased when the model has already been running once at the same discharge. The result of an earlier simulation can be used for the initial condition with the <code class="docutils literal notranslate"><span class="pre">COMPUTATION</span> <span class="pre">CONTINUED</span> <span class="pre">:</span> <span class="pre">YES</span></code> (default is <code class="docutils literal notranslate"><span class="pre">NO</span></code>) and <code class="docutils literal notranslate"><span class="pre">PREVIOUS</span> <span class="pre">COMPUTATION</span> <span class="pre">FILE</span> <span class="pre">:</span> <span class="pre">*.slf</span></code> (provide the name of a <code class="docutils literal notranslate"><span class="pre">*.slf</span></code> file) keywords. This type of model initialization is also referred to as <em>hotstart</em>. Read more about hotstarts in the <a class="reference internal" href="telemac2d-unsteady.html#tm2d-hotstart"><span class="std std-ref">unsteady simulation</span></a> and <a class="reference internal" href="gaia-coupling.html#gaia-hotstart"><span class="std std-ref">Gaia</span></a> sections. Also section 4.1.3 in the <a class="reference external" href="https://gitlab.pam-retd.fr/otm/telemac-mascaret/-/blob/v8p3r1/documentation/telemac2d/user/telemac2d_user_v8p3.pdf">Telemac2d manual</a> provides descriptions for continuing (hotstart) calculations.</p>
</div>
<div class="section" id="turbulence">
<span id="tm2d-turbulence"></span><h3>Turbulence<a class="headerlink" href="#turbulence" title="Permalink to this headline">¶</a></h3>
<p><strong>The following descriptions refer to section 6.2 in the <a class="reference external" href="https://gitlab.pam-retd.fr/otm/telemac-mascaret/-/blob/v8p3r1/documentation/telemac2d/user/telemac2d_user_v8p3.pdf">Telemac2d manual</a>.</strong></p>
<p>Turbulence describes a seemingly random and chaotic state of fluid motion in the form of three-dimensional vortices (eddies). True turbulence is only present in 3d vorticity and when it occurs, it mostly dominates all other flow phenomena through increases in energy dissipation, drag, heat transfer, and mixing <span id="id25">[<a class="reference internal" href="../documentation/bibliography.html#id332">KC08</a>]</span>. The phenomenon of turbulence has been a mystery to science for a long time, since turbulent flows have been observed, but could not be explained by the linear equations systems. Today, turbulence is considered a random phenomenon that can be accounted for in linear equations, for instance, by introducing statistical parameters. For instance, when turbulence applies to the depth-averaged <a class="reference internal" href="../documentation/glossary.html#term-Navier-Stokes-equations"><span class="xref std std-term">Navier-Stokes equations</span></a> a numerical solution for a quantity (e.g., flow velocity) corresponds to <span class="math notranslate nohighlight">\(value = \overline{mean value} + value fluctuation'\)</span>. For this purpose, there are a variety of options for implementing turbulence in numerical models <span id="id26">[<a class="reference internal" href="../documentation/bibliography.html#id1362">NN93</a>]</span>.</p>
<p>The horizontal and vertical dimensions of turbulent eddies can vary greatly, especially in rivers and transitions to backwater zones (tidal flats) where the wide horizontal flow dimension (river width <span class="math notranslate nohighlight">\(w\)</span>) is significantly larger than the vertical flow dimension (water depth <span class="math notranslate nohighlight">\(h\)</span>): <span class="math notranslate nohighlight">\(w &gt;&gt; h\)</span>. Telemac2d provides multiple turbulence models that can be applied to the vertical and/or horizontal dimensions and defined with the <strong>TURBULENCE MODEL</strong> keyword being an integer number for one of the following options:</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">1</span></code> to use a constant viscosity coefficient (<strong>default</strong>) for turbulent viscosity, molecular viscosity, and <a class="reference internal" href="../documentation/glossary.html#term-Diffusion"><span class="xref std std-term">Diffusion</span></a>. This closure option should not be used with <a class="reference internal" href="../documentation/glossary.html#term-Stage-discharge-relation"><span class="xref std std-term">Stage-discharge relation</span></a> open boundaries (i.e., do not use with prescribed Q and H) <span id="id27">[<a class="reference internal" href="../documentation/bibliography.html#id1368">WBH02</a>]</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">2</span></code> to use the Elder formula for the <a class="reference internal" href="../documentation/glossary.html#term-Diffusion"><span class="xref std std-term">Diffusion</span></a> coefficient <span class="math notranslate nohighlight">\(D\)</span>. The Elder turbulence closure also yields small errors for <a class="reference internal" href="../documentation/glossary.html#term-Stage-discharge-relation"><span class="xref std std-term">Stage-discharge relation</span></a> open boundaries (i.e., do not use this option with prescribed Q and H) <span id="id28">[<a class="reference internal" href="../documentation/bibliography.html#id1368">WBH02</a>]</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">3</span></code> to use the <span class="math notranslate nohighlight">\(k-\epsilon\)</span> two-equation model solving the <a class="reference internal" href="../documentation/glossary.html#term-Navier-Stokes-equations"><span class="xref std std-term">Navier-Stokes equations</span></a>. The first equation represents a turbulence closure for the turbulent energy <span class="math notranslate nohighlight">\(k\)</span>; the second equation is a turbulence closure for the turbulent dissipation <span class="math notranslate nohighlight">\(\epsilon\)</span>. Both equations express that the sum of change of (I) <span class="math notranslate nohighlight">\(k\)</span> and <span class="math notranslate nohighlight">\(\epsilon\)</span> in time, and (II) <a class="reference internal" href="../documentation/glossary.html#term-Advection"><span class="xref std std-term">Advection</span></a> transport of <span class="math notranslate nohighlight">\(k\)</span> and <span class="math notranslate nohighlight">\(\epsilon\)</span> equal the sum of (1) <a class="reference internal" href="../documentation/glossary.html#term-Diffusion"><span class="xref std std-term">Diffusion</span></a> transport of <span class="math notranslate nohighlight">\(k\)</span> and <span class="math notranslate nohighlight">\(\epsilon\)</span>, (2) the production rate of <span class="math notranslate nohighlight">\(k\)</span>/<span class="math notranslate nohighlight">\(\epsilon\)</span>, and (3) the destruction rate of <span class="math notranslate nohighlight">\(k\)</span>/<span class="math notranslate nohighlight">\(\epsilon\)</span> <span id="id29">[<a class="reference internal" href="../documentation/bibliography.html#id1367">LS74</a>]</span>. The <span class="math notranslate nohighlight">\(k-\epsilon\)</span> model is a generalization of the mixing length model (see option <code class="docutils literal notranslate"><span class="pre">5</span></code>) and assumes that the turbulent viscosity is isotropic (valid for many river applications, but not for circular-rotating flows or groundwater) <span id="id30">[<a class="reference internal" href="../documentation/bibliography.html#id1366">Bra87</a>]</span>. Thus, the <span class="math notranslate nohighlight">\(k-\epsilon\)</span> model introduces two additional equations and requires a finer mesh than the constant viscosity option <code class="docutils literal notranslate"><span class="pre">1</span></code>, which leads to a longer computation time. Yet, the <span class="math notranslate nohighlight">\(k-\epsilon\)</span> model generally yields accurate results and small errors with <a class="reference internal" href="../documentation/glossary.html#term-Stage-discharge-relation"><span class="xref std std-term">Stage-discharge relation</span></a> open boundaries <span id="id31">[<a class="reference internal" href="../documentation/bibliography.html#id1368">WBH02</a>]</span>. The following default keywords are associated with the <span class="math notranslate nohighlight">\(k-\epsilon\)</span> model:</p>
<ul>
<li><p><code class="docutils literal notranslate"><span class="pre">VELOCITY</span> <span class="pre">DIFFUSIVITY</span> <span class="pre">:</span> <span class="pre">1.E-6</span></code> corresponding to the kinematic viscosity <span class="math notranslate nohighlight">\(\nu\)</span> of water (10<span class="math notranslate nohighlight">\(^{-6}\)</span> m<span class="math notranslate nohighlight">\(^2\)</span>/s).</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">TURBULENCE</span> <span class="pre">REGIME</span> <span class="pre">FOR</span> <span class="pre">SOLID</span> <span class="pre">BOUNDARIES</span> <span class="pre">:</span> <span class="pre">2</span></code> <strong>for rough walls</strong> of closed boundaries to apply the value chosen for the <strong>LAW OF BOTTOM FRICTION</strong> and <strong>ROUGHNESS COEFFICIENT OF BOUNDARIES</strong> keywords (recall section <a class="reference internal" href="#tm2d-friction"><span class="std std-ref">Friction Boundary Conditions</span></a>). For <strong>smooth closed boundary walls</strong> set <code class="docutils literal notranslate"><span class="pre">TURBULENCE</span> <span class="pre">REGIME</span> <span class="pre">FOR</span> <span class="pre">SOLID</span> <span class="pre">BOUNDARIES</span> <span class="pre">:</span> <span class="pre">1</span></code>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">INFORMATION</span> <span class="pre">ABOUT</span> <span class="pre">K-EPSILON</span> <span class="pre">MODEL</span> <span class="pre">:</span> <span class="pre">YES</span></code> enables console output of information on the <span class="math notranslate nohighlight">\(k-\epsilon\)</span> closure solution.</p></li>
</ul>
</li>
<li><p><code class="docutils literal notranslate"><span class="pre">4</span></code> to use the <span id="id32">Smagorinsky [<a class="reference internal" href="../documentation/bibliography.html#id1364">Sma63</a>]</span> (also known as <em>general circulation</em>) model, which stems from climate modeling and is appropriate for modeling maritime systems with large eddies. The <span id="id33">Smagorinsky [<a class="reference internal" href="../documentation/bibliography.html#id1364">Sma63</a>]</span> model does not account for <a class="reference internal" href="../documentation/glossary.html#term-Diffusion"><span class="xref std std-term">Diffusion</span></a>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">5</span></code> to use a mixing length model according to Prandtl’s theory that a fluid quantity conserves its properties for a characteristic length before it mixes with the bulk flow <span id="id34">[<a class="reference internal" href="../documentation/bibliography.html#id1365">Bra74</a>]</span>.</p></li>
<li><p><code class="docutils literal notranslate"><span class="pre">6</span></code> to use the <span id="id35">Spalart and Allmaras [<a class="reference internal" href="../documentation/bibliography.html#id1363">SA92</a>]</span> model that solves the <a class="reference internal" href="../documentation/glossary.html#term-Continuity-equation"><span class="xref std std-term">Continuity equation</span></a> for a viscosity-like, kinematic eddy turbulent viscosity. The <span id="id36">Spalart and Allmaras [<a class="reference internal" href="../documentation/bibliography.html#id1363">SA92</a>]</span> model was originally developed for aerodynamic flows with low <a class="reference internal" href="../documentation/glossary.html#term-Reynolds-number"><span class="xref std std-term">Reynolds number</span></a> and it has also shown good results for other applications.</p></li>
</ul>
<p>This tutorial uses the <span class="math notranslate nohighlight">\(k-\epsilon\)</span> model (<code class="docutils literal notranslate"><span class="pre">3</span></code>) because of its low error rate and wide applicability (compared to other turbulence closures).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">DIFFUSION</span> <span class="n">OF</span> <span class="n">VELOCITY</span> <span class="p">:</span> <span class="n">YES</span> <span class="o">/</span> <span class="n">enabled</span> <span class="n">by</span> <span class="n">default</span>
<span class="n">TURBULENCE</span> <span class="n">MODEL</span> <span class="p">:</span> <span class="mi">3</span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="run-telemac2d">
<span id="tm2d-run"></span><h2>Run Telemac2d<a class="headerlink" href="#run-telemac2d" title="Permalink to this headline">¶</a></h2>
<p>With the steering (<code class="docutils literal notranslate"><span class="pre">*.cas</span></code>) file, the last necessary ingredient for running a steady hydrodynamic 2d simulation with Telemac2d is available. Make sure to put all required files in one simulation folder (e.g., <code class="docutils literal notranslate"><span class="pre">~/telemac/v8p2/mysimulations/steady2d-tutorial/</span></code>). The required files can also be downloaded from this eBook’s <a class="reference external" href="https://github.com/hydro-informatics/telemac/tree/main/steady2d-tutorial/">steady2d tutorial repository</a> and include:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/hydro-informatics/telemac/raw/main/steady2d-tutorial/qgismesh.slf">qgismesh.slf</a></p></li>
<li><p><a class="reference external" href="https://github.com/hydro-informatics/telemac/raw/main/steady2d-tutorial/boundaries.cli">boundaries.cli</a></p></li>
<li><p><a class="reference external" href="https://github.com/hydro-informatics/telemac/raw/main/steady2d-tutorial/steady2d.cas">steady2d.cas</a></p></li>
</ul>
<p>With these files prepared, load the TELEMAC environment, and run Telemac2d following the explanations in the next sections.</p>
<div class="section" id="load-environment-and-files">
<h3>Load environment and files<a class="headerlink" href="#load-environment-and-files" title="Permalink to this headline">¶</a></h3>
<p>Go to the configuration folder of the TELEMAC installation (e.g., <code class="docutils literal notranslate"><span class="pre">~/telemac/v8p2/configs/</span></code>) and load the environment (e.g., <code class="docutils literal notranslate"><span class="pre">pysource.openmpi.sh</span></code> - use the same as for compiling TELEMAC).</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~/</span><span class="n">telemac</span><span class="o">/</span><span class="n">v8p2</span><span class="o">/</span><span class="n">configs</span>
<span class="n">source</span> <span class="n">pysource</span><span class="o">.</span><span class="n">openmpi</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
<div class="note dropdown admonition">
<p class="admonition-title">If you are using the Hydro-Informatics (Hyfo) Mint VM</p>
<p>If you are working with the <a class="reference internal" href="../get-started/vm.html#hyfo-vm"><span class="std std-ref">Mint Hyfo VM</span></a>, load the TELEMAC environment as follows:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~/</span><span class="n">telemac</span><span class="o">/</span><span class="n">v8p2</span><span class="o">/</span><span class="n">configs</span>
<span class="n">source</span> <span class="n">pysource</span><span class="o">.</span><span class="n">hyfo</span><span class="o">-</span><span class="n">dyn</span><span class="o">.</span><span class="n">sh</span>
</pre></div>
</div>
</div>
<p>To start a simulation, change to the directory (<code class="docutils literal notranslate"><span class="pre">cd</span></code>) where the simulation files live and run the steering file (<code class="docutils literal notranslate"><span class="pre">*.cas</span></code>) with the <strong><a class="reference external" href="http://telemac2d.py">telemac2d.py</a></strong> script:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">cd</span> <span class="o">~/</span><span class="n">telemac</span><span class="o">/</span><span class="n">v8p2</span><span class="o">/</span><span class="n">mysimulations</span><span class="o">/</span><span class="n">steady2d</span><span class="o">-</span><span class="n">tutorial</span><span class="o">/</span>
<span class="n">telemac2d</span><span class="o">.</span><span class="n">py</span> <span class="n">steady2d</span><span class="o">.</span><span class="n">cas</span>
</pre></div>
</div>
<p>As a result, a successful computation should end with the following lines (or similar) in <em>Terminal</em>:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="p">[...]</span>
                     <span class="o">*************************************</span>
                     <span class="o">*</span>    <span class="k">END </span><span class="n">OF</span> <span class="k">MEMORY </span><span class="n">ORGANIZATION</span><span class="p">:</span>    <span class="o">*</span>
                     <span class="o">*************************************</span>

 <span class="n">CORRECT</span> <span class="k">END </span><span class="n">OF</span> <span class="n">RUN</span>

 <span class="n">ELAPSE</span> <span class="nb">TIME</span> <span class="p">:</span>
                             <span class="mi">06</span>  <span class="n">MINUTES</span>
                             <span class="mi">44</span>  <span class="n">SECONDS</span>
<span class="p">...</span> <span class="n">merging</span> <span class="n">separated</span> <span class="k">result </span><span class="n">files</span>

<span class="p">...</span> <span class="n">handling</span> <span class="k">result </span><span class="n">files</span>
        <span class="n">moving</span><span class="p">:</span> <span class="n">r2dsteady</span><span class="p">.</span><span class="n">slf</span>
<span class="p">...</span> <span class="n">deleting</span> <span class="n">working</span> <span class="n">dir</span>

<span class="n">My</span> <span class="n">work</span> <span class="k">is </span><span class="n">done</span>
</pre></div>
</div>
<p>Thus, Telemac2d produced the file <em>r2dsteady.slf</em> that can now be analyzed in the <a class="reference internal" href="#tm-steady2d-postpro"><span class="std std-ref">post-processing with QGIS</span></a> or ParaView.</p>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="post-processing">
<span id="tm-steady2d-postpro"></span><h1>Post-processing<a class="headerlink" href="#post-processing" title="Permalink to this headline">¶</a></h1>
<p>The post-processing of the steady 2d scenario uses QGIS and the <a class="reference internal" href="pre-slf-tm.html#tm-qgis-plugins"><span class="std std-ref">PostTelemac plugin</span></a>. Alternatively, TELEMAC results can also be visualized with <a class="reference external" href="https://www.paraview.org">ParaView</a> or BlueKenue.</p>
<div class="section" id="load-results">
<h2>Load Results<a class="headerlink" href="#load-results" title="Permalink to this headline">¶</a></h2>
<p>Launch QGIS, <a class="reference internal" href="../geopy/use-qgis.html#qgis-project"><span class="std std-ref">create a new QGIS project</span></a>, set the project <a class="reference internal" href="../documentation/glossary.html#term-CRS"><span class="xref std std-term">CRS</span></a> to <code class="docutils literal notranslate"><span class="pre">UTM</span> <span class="pre">zone</span> <span class="pre">33N</span></code>, add a satellite imagery <a class="reference internal" href="../geopy/use-qgis.html#basemap"><span class="std std-ref">basemap</span></a>, and save the project (e.g., as <code class="docutils literal notranslate"><span class="pre">tm2d-postpro.qgis</span></code>) in the same folder where the Telemac2d simulation results file (<em>r2dsteady.slf</em> is located), similar to the descriptions in the <a class="reference internal" href="pre-slf-tm.html#tm-qgis-prepro"><span class="std std-ref">pre-processing tutorial</span></a>. Then, open the PostTelemac plugin as indicated in <a class="reference internal" href="#open-post-tm"><span class="std std-numref">Fig. 80</span></a>.</p>
<div class="figure align-default" id="open-post-tm">
<img alt="qgis load open PostTelemac plugin" src="../_images/load-tm-plugin.png" />
<p class="caption"><span class="caption-number">Fig. 80 </span><span class="caption-text">Open the PostTelemac plugin in QGIS.</span><a class="headerlink" href="#open-post-tm" title="Permalink to this image">¶</a></p>
</div>
<div class="error dropdown admonition">
<p class="admonition-title">r2dsteady.slf (results file) not correctly showing in QGIS</p>
<p>Is the results file <code class="docutils literal notranslate"><span class="pre">r2dsteady.slf</span></code> not showing up in QGIS? Make sure to import it with its correct georeference: <strong>EPSG:6173</strong> (ETRS 89 / UTM zone 33N).</p>
</div>
<p>The PostTelemac plugin typically opens as a frame at the bottom-right of the QGIS window (maybe hard to find the first time). Detach the PostTelemac plugin from the main QGIS window by clicking on the resize window button in the top-right corner of the PostTelemac plugin frame (next to the <em>close</em> cross). In the detached window load the model results as follows (also indicated in <a class="reference internal" href="#post-tm"><span class="std std-numref">Fig. 81</span></a>):</p>
<ul class="simple">
<li><p>Click on the <strong>File …</strong> button, navigate to the location where the simulation lives and select <code class="docutils literal notranslate"><span class="pre">r2dsteady.slf</span></code>.</p></li>
<li><p><strong>Move the Time slider</strong> to the last timestep (e.g., <code class="docutils literal notranslate"><span class="pre">8000</span></code>) and observe the main window, which will show by default the VELOCITY U parameter in this tutorial (depends on the variables defined with the <code class="docutils literal notranslate"><span class="pre">VARIABLES</span> <span class="pre">FOR</span> <span class="pre">GRAPHIC</span> <span class="pre">PRINTOUTS</span></code> keyword).</p></li>
<li><p>Familiarize with the PostTelemac plugin by modifying the display <strong>Parameter</strong> and the <strong>Color gradient</strong>.</p></li>
</ul>
<div class="figure align-default" id="post-tm">
<img alt="qgis load simulation results slf PostTelemac plugin" src="../_images/post-telemac.png" />
<p class="caption"><span class="caption-number">Fig. 81 </span><span class="caption-text">Load the Telemac2d simulation results file in the detached PostTelemac plugin window.</span><a class="headerlink" href="#post-tm" title="Permalink to this image">¶</a></p>
</div>
<div class="tip admonition">
<p class="admonition-title">Find the r2dsteady layer in the QGIS <em>Layers</em> panel</p>
<p>Once imported, the <em>r2dsteady</em> layer is listed in the <em>Layers</em> panel of QGIS (typically in the bottom-left of the window). Double-clicking on the <em>r2dsteady</em> layer will re-open the PostTelemac plugin when it was closed (e.g., after restarting QGIS). Structurally, the <em>r2dsteady</em> layer is a mesh with a particular format.</p>
</div>
<div class="tip admonition">
<p class="admonition-title">SLF Geometries can be loaded in QGIS without the PostTelemac plugin</p>
<p>The latest QGIS versions enable direct loading of SLF geometry files as mesh layer. Try it: Drag and drop <em>r2dsteady.slf</em> from the Browser panel to the Layers panel. Moreover, the <a class="reference internal" href="telemac2d-unsteady.html#tm-unsteady-qgis"><span class="std std-ref">unsteady post-processing section</span></a> features this direct mesh loading in QGIS.</p>
</div>
</div>
<div class="section" id="analyze-results">
<span id="tm2d-post-export"></span><h2>Analyze Results<a class="headerlink" href="#analyze-results" title="Permalink to this headline">¶</a></h2>
<p>The PostTelemac plugin enables to export simulation results in the form of multiple formats including <a class="reference internal" href="../documentation/glossary.html#term-GeoTIFF"><span class="xref std std-term">GeoTIFF</span></a> rasters of simulation output variables or data along nodes. In addition, the evolution of a parameter over the simulation time can be exported to a video. To export or animate results, go to the <strong>Tools</strong> tab (light blue box in <a class="reference internal" href="#post-tm"><span class="std std-numref">Fig. 81</span></a>) and follow the descriptions in the following paragraphs.</p>
<div class="section" id="export-geotiff">
<h3>Export GeoTIFF<a class="headerlink" href="#export-geotiff" title="Permalink to this headline">¶</a></h3>
<p>This example features the export of a flow velocity raster at the simulation end time (8000). For this purpose, click on the <strong>RasterCreation</strong> entry of the <strong>Export</strong> menu in the <strong>Tools</strong> tab. To export a flow velocity <a class="reference internal" href="../documentation/glossary.html#term-GeoTIFF"><span class="xref std std-term">GeoTIFF</span></a> raster:</p>
<ul class="simple">
<li><p>Set the <strong>time step</strong> to <code class="docutils literal notranslate"><span class="pre">8000</span></code> (use the field indicated in <a class="reference internal" href="#posttm-export-tif"><span class="std std-numref">Fig. 82</span></a>).</p></li>
<li><p>Select <code class="docutils literal notranslate"><span class="pre">6</span> <span class="pre">:</span> <span class="pre">VITESSE</span></code> for <strong>Parameter</strong>.</p>
<ul>
<li><p><em>Vitesse</em> is French for <em>velocity</em> and it is calculated as <span class="math notranslate nohighlight">\(VITESSE = \sqrt{(VELOCITY\ U)^2 + (VELOCITY\ V)^2}\)</span></p></li>
<li><p>Note that <code class="docutils literal notranslate"><span class="pre">VELOCITY</span> <span class="pre">U</span></code> and <code class="docutils literal notranslate"><span class="pre">VELOCITY</span> <span class="pre">V</span></code> are the flow velocities in <span class="math notranslate nohighlight">\(x\)</span> and <span class="math notranslate nohighlight">\(y\)</span> directions, respectively.</p></li>
</ul>
</li>
<li><p>In the <strong>Group</strong> frame set:</p>
<ul>
<li><p><strong>Cell size</strong> to <code class="docutils literal notranslate"><span class="pre">1</span></code>, and</p></li>
<li><p><strong>Extent</strong> to <code class="docutils literal notranslate"><span class="pre">Full</span> <span class="pre">Extent</span></code>.</p></li>
</ul>
</li>
<li><p>Start the export by clicking on <strong>Create raster</strong>.</p></li>
</ul>
<p>The processing frame can be found at the bottom of the window (scroll down by clicking on the dotted circle indicated in <a class="reference internal" href="#posttm-export-tif"><span class="std std-numref">Fig. 82</span></a>) and informs about the progress.</p>
<div class="figure align-default" id="posttm-export-tif">
<img alt="qgis export simulation results slf PostTelemac raster geotiff tif" src="../_images/posttm-export-tif.png" />
<p class="caption"><span class="caption-number">Fig. 82 </span><span class="caption-text">Export a flow velocity raster of simulation results with the PostTelemac plugin.</span><a class="headerlink" href="#posttm-export-tif" title="Permalink to this image">¶</a></p>
</div>
<p>The successful raster creation results in a new layer called <strong>r2dsteady_raster_VITESSE</strong>, which is automatically saved as a <a class="reference internal" href="../documentation/glossary.html#term-GeoTIFF"><span class="xref std std-term">GeoTIFF</span></a> raster in the same folder where the QGIS project (<code class="docutils literal notranslate"><span class="pre">*.qgz</span></code>) and the <code class="docutils literal notranslate"><span class="pre">r2dsteady.slf</span></code> files are located.</p>
<p><a class="reference internal" href="#exported-tif"><span class="std std-numref">Figure 83</span></a> shows the exported flow velocity raster in QGIS with a <em>Magma</em> color map (select in the layer symbology).</p>
<div class="figure align-default" id="exported-tif">
<img alt="qgis flow velocity vitesse results slf PostTelemac raster geotiff tif" src="../_images/qgis-exported-tif.png" />
<p class="caption"><span class="caption-number">Fig. 83 </span><span class="caption-text">The exported flow velocity (VITESSE) GeoTIFF raster in QGIS (background map: <span id="id37">Google [<a class="reference internal" href="../documentation/bibliography.html#id1370">Goond</a>]</span> satellite imagery).</span><a class="headerlink" href="#exported-tif" title="Permalink to this image">¶</a></p>
</div>
<div class="tip admonition">
<p class="admonition-title">Export to shapefile or mesh</p>
<p>The PostTelemac plugin also enables exporting to other geodata types such as vector shapefiles or meshes.</p>
</div>
<dl class="simple myst">
<dt>How reasonable are the results?</dt><dd><p>The flow velocity raster in <a class="reference internal" href="#exported-tif"><span class="std std-numref">Fig. 83</span></a> shows some non-zero pixels on the floodplains, beyond the riverbanks. However, because the simulated discharge of 35 m<span class="math notranslate nohighlight">\(^3\)</span>/s corresponds to low baseflow conditions, there should not be any water on the floodplains. These apparently wrongly modeled pixels are an artifact of the wet initial conditions that put a 1-m deep water layer all over the model. In local swales (i.e., hollows or small terrain depressions) beside the main channel, the water cannot run off and remains here until the end of the simulation. To avoid the unrealistic disconnected swales, use <code class="docutils literal notranslate"><span class="pre">INITIAL</span> <span class="pre">DEPTH</span> <span class="pre">:</span> <span class="pre">0</span></code> or <code class="docutils literal notranslate"><span class="pre">INITIAL</span> <span class="pre">CONDITIONS</span> <span class="pre">:</span> <span class="pre">ZERO</span> <span class="pre">DEPTH</span></code>, which corresponds to dry initial conditions (see the <a class="reference internal" href="#tm2d-init"><span class="std std-ref">initial conditions</span></a> section below). Note that initializing the model with zero depths (dry) will require open (liquid) boundary conditions of the type <em>PRESCRIBED Q AND H</em>. Thus, for starting this tutorial with dry conditions, go back to the pre-processing section on creating <a class="reference internal" href="pre-slf-tm.html#bk-bc"><span class="std std-ref">Conlim Boundary Conditions</span></a> and assign prescribed Q and H to both upstream and downstream open boundaries (i.e., not only at the downstream open boundary). Alternatively, set the initial depth to a very small value such as <code class="docutils literal notranslate"><span class="pre">INITIAL</span> <span class="pre">DEPTH</span> <span class="pre">:</span> <span class="pre">0.01</span></code>.</p>
</dd>
</dl>
</div>
<div class="section" id="verify-discharge-convergence">
<span id="verify-steady-tm2d"></span><h3>Verify Discharge Convergence<a class="headerlink" href="#verify-discharge-convergence" title="Permalink to this headline">¶</a></h3>
<p>The discharge convergence can be observed during the simulation in the Terminal running Telemac2d with the <code class="docutils literal notranslate"><span class="pre">PRINTING</span> <span class="pre">CUMULATED</span> <span class="pre">FLOWRATES</span> <span class="pre">:</span> <span class="pre">YES</span></code> keyword, and also later to make sure fluxes are correctly entering and leaving the model. Furthermore, it can be determined at which timestep inflows and outflows converge to each other, which enables the simulation to be shortened to this moment of convergence in steady simulations.</p>
<p>To export flowrates along any line or at any node of the mesh, make sure that <code class="docutils literal notranslate"><span class="pre">Q</span></code> is in the list of the <code class="docutils literal notranslate"><span class="pre">VARIABLES</span> <span class="pre">FOR</span> <span class="pre">GRAPHIC</span> <span class="pre">PRINTOUTS</span></code> keyword. Then, go to the <strong>Tools</strong> tab of the PostTelemac plugin in QGIS (<a class="reference internal" href="#draw-flow-controls"><span class="std std-numref">Fig. 84</span></a>) and:</p>
<ul class="simple">
<li><p>Click on the <strong>Flow</strong> ribbon.</p></li>
<li><p>In the <strong>Selection</strong> frame select <strong>Temporary polyline</strong> and move the mouse cursor on the map viewport where the cursor should turn into a black cross that enables drawing a (green) thick line anywhere in the mesh layer (<em>r2dsteady</em>). If the cursor does not enable drawing, go somewhere else in the PostTelemac plugin (e.g., to the <em>Samplingtool</em> ribbon), then go back to the <em>Flow</em> ribbon, click in the <em>Selection</em> frame, and re-try. To draw a line for exporting associated flows:</p>
<ul>
<li><p>left-click with the mouse cursor somewhere on the <em>r2dsteady</em> mesh on the map (e.g., the left bank at the inflow open boundary indicated in <a class="reference internal" href="#draw-flow-controls"><span class="std std-numref">Fig. 84</span></a>), and</p></li>
<li><p>double left-click on another point on the <em>r2dsteady</em> mesh (e.g., the right bank at the inflow open boundary indicated in <a class="reference internal" href="#draw-flow-controls"><span class="std std-numref">Fig. 84</span></a>).</p></li>
<li><p>The PostTelemac plugin then automatically draws the shortest path between the two points along the mesh nodes.</p></li>
</ul>
</li>
<li><p>The flowrate across the green line is now plotted in the graph of the PostTelemac plugin for the simulation time (e.g., timesteps <code class="docutils literal notranslate"><span class="pre">0</span></code> to <code class="docutils literal notranslate"><span class="pre">8000</span></code> in <a class="reference internal" href="#draw-flow-controls"><span class="std std-numref">Fig. 84</span></a>).</p></li>
<li><p>To save the values for comparison at another line, click on <strong>Copy to clipboard</strong> and paste the values into a spreadsheet (office software,  such as <a class="reference internal" href="../get-started/others.html#lo"><span class="std std-ref">Libre Office</span></a>).</p></li>
</ul>
<p><strong>Repeat</strong> the procedure <strong>at the downstream open boundary</strong> and paste the values in another column of the spreadsheet used for the upstream open boundary.</p>
<div class="figure align-default" id="draw-flow-controls">
<img alt="qgis flow rate discharge control section Post Telemac convergence" src="../_images/flow-control-us.png" />
<p class="caption"><span class="caption-number">Fig. 84 </span><span class="caption-text">Draw polylines along mesh nodes and export associated flows (Copy to clipboard; background map: <span id="id38">Google [<a class="reference internal" href="../documentation/bibliography.html#id1370">Goond</a>]</span> satellite imagery).</span><a class="headerlink" href="#draw-flow-controls" title="Permalink to this image">¶</a></p>
</div>
<p>The diagram in <a class="reference internal" href="#convergence-diagram-tm2d"><span class="std std-numref">Fig. 85</span></a> plots the two columns of flows at the upstream and downstream open boundaries over time for the simulation setup in this tutorial. The diagram suggests that the model reaches stability after the 55th output listing (simulation time <span class="math notranslate nohighlight">\(t \leq 5500\)</span>). Thus, the simulation time could be limited to <span class="math notranslate nohighlight">\(t = 6000\)</span>, but a simulation time of <span class="math notranslate nohighlight">\(t = 5000\)</span> would be too short.</p>
<div class="figure align-default" id="convergence-diagram-tm2d">
<img alt="telemac2d convergence steady model simulation discharge verification validation" src="../_images/convergence-diagram-tm.png" />
<p class="caption"><span class="caption-number">Fig. 85 </span><span class="caption-text">Convergence of inflow (upstream) and outflow (downstream) at the open model boundaries.</span><a class="headerlink" href="#convergence-diagram-tm2d" title="Permalink to this image">¶</a></p>
</div>
<div class="tip admonition">
<p class="admonition-title">Control Sections are more consistent for exporting fluxes along lines</p>
<p>In practice, the use of <a class="reference internal" href="telemac2d-unsteady.html#tm-control-sections"><span class="std std-ref">CONTROL SECTIONS (unsteady tutorial)</span></a> is more consistent to verify flows.</p>
</div>
<p>Note the difference between the convergence duration in this steady simulation with Telemac2d that starts with an initial condition of 1.0 m water depth (plot in <a class="reference internal" href="#convergence-diagram-tm2d"><span class="std std-numref">Fig. 85</span></a>) compared with the longer convergence duration in the BASEMENT tutorial (plot in <a class="reference internal" href="basement2d.html#convergence-diagram-bm"><span class="std std-numref">Fig. 60</span></a>) that starts with a dry model. This difference mainly stems from the type of initial conditions (initial depth versus dry channel) that also reflects in an outflow surplus of the Telemac2d simulation and a zero-outflow in the BASEMENT simulation at the beginning of the simulations. However, the faster convergence is at the cost of unrealistically wetted hollows in the Telemac2d simulation. Read more in the above comment: <em>How reasonable are the results?</em></p>
</div>
</div>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="re-initialize-dry">
<span id="tm2d-dry"></span><h1>Re-Initialize Dry<a class="headerlink" href="#re-initialize-dry" title="Permalink to this headline">¶</a></h1>
<p>For comparison, run the Telemac2d simulation with initial dry conditions. To this end, change the downstream boundary type to <code class="docutils literal notranslate"><span class="pre">5</span> <span class="pre">4</span> <span class="pre">4</span></code> (prescribed H only) in the  <a class="reference internal" href="pre-slf-tm.html#bk-liquid-bc"><span class="std std-ref">boundaries.cli</span></a> file. For making this modification, it is sufficient to <strong>open boundaries.cli in any text editor</strong> and use its <strong>find-and-replace</strong> function (e.g., <code class="docutils literal notranslate"><span class="pre">CTRL</span></code> + <code class="docutils literal notranslate"><span class="pre">H</span></code> keys in <a class="reference internal" href="../get-started/others.html#npp"><span class="std std-ref">NotepadPlusPlus (Text Editor)</span></a>, or <code class="docutils literal notranslate"><span class="pre">CTRL</span></code> + <code class="docutils literal notranslate"><span class="pre">F</span></code> keys in <a class="reference internal" href="../get-started/ide.html#install-atom"><span class="std std-ref">Atom</span></a>):</p>
<ul class="simple">
<li><p>In the <strong>Find</strong> field type <code class="docutils literal notranslate"><span class="pre">5</span> <span class="pre">5</span> <span class="pre">5</span></code>.</p></li>
<li><p>In the <strong>Replace with</strong> field type <code class="docutils literal notranslate"><span class="pre">5</span> <span class="pre">4</span> <span class="pre">4</span></code>.</p></li>
<li><p>Click on <strong>Replace</strong> until all <strong>downstream</strong> boundary node types are changed.</p></li>
</ul>
<p>In addition, the upstream boundary requires a prescription of flowrate and water depth to avoid supercritical fluxes at the beginning of the simulation. To this end, <strong>find-and-replace</strong> the upstream boundary settings in <strong>boundaries.cli</strong>:</p>
<ul class="simple">
<li><p>In the <strong>Find</strong> field type <code class="docutils literal notranslate"><span class="pre">4</span> <span class="pre">5</span> <span class="pre">5</span></code>.</p></li>
<li><p>In the <strong>Replace with</strong> field type <code class="docutils literal notranslate"><span class="pre">5</span> <span class="pre">5</span> <span class="pre">5</span></code>.</p></li>
<li><p>Click on <strong>Replace</strong> until all <strong>upstream</strong> boundary node types are modified.</p></li>
<li><p>Save and close <strong>boundaries.cli</strong>.</p></li>
</ul>
<p>In the Telemac2d steering (<code class="docutils literal notranslate"><span class="pre">*.cas</span></code>) file comment out the <strong>INITIAL DEPTH</strong> keyword, change the <strong>INITIAL CONDITIONS</strong> keyword to <code class="docutils literal notranslate"><span class="pre">ZERO</span> <span class="pre">DEPTH</span></code>, and change the <strong>PRESCRIBED ELEVATIONS</strong> keyword to <code class="docutils literal notranslate"><span class="pre">374.80565;371.33</span></code>. In addition, the <strong>PRESCRIBED FLOWRATES</strong> needs to be changed to prescribe the discharge only at the inflow boundary with <code class="docutils literal notranslate"><span class="pre">35.;0.</span></code>.</p>
<div class="admonition-boundaries-everywhere admonition">
<p class="admonition-title">5-5-5 boundaries everywhere</p>
<p><code class="docutils literal notranslate"><span class="pre">5</span> <span class="pre">5</span> <span class="pre">5</span></code> (prescribed Q and H) boundaries can alternatively applied in the here presented case, also to the downstream boundary, which would require to keep <code class="docutils literal notranslate"><span class="pre">PRESCRIBED</span> <span class="pre">FLOWRATES</span> <span class="pre">:</span> <span class="pre">35.;35.</span></code> in the steering file. However, this setting may lead to an overdetermination of boundary conditions which may cause non-sense results (e.g., standing waves) in some model setups (in particular, simple geometries).</p>
</div>
<p>Moreover, to use the results of the dry initialization for morphodynamic calculations, the bottom elevation (<code class="docutils literal notranslate"><span class="pre">B</span></code>) must be added to the list of graphical printout variables.</p>
<p>In summary, the steering file should involve the following changes for a dry model initialization:</p>
<div class="highlight-fortran notranslate"><div class="highlight"><pre><span></span><span class="o">/</span> <span class="p">...</span> <span class="n">header</span>
<span class="n">VARIABLES</span> <span class="n">FOR</span> <span class="n">GRAPHIC</span> <span class="n">PRINTOUTS</span> <span class="p">:</span> <span class="n">U</span><span class="p">,</span><span class="n">V</span><span class="p">,</span><span class="n">H</span><span class="p">,</span><span class="n">S</span><span class="p">,</span><span class="n">Q</span><span class="p">,</span><span class="n">F</span><span class="p">,</span><span class="n">B</span>
<span class="o">/</span> <span class="p">...</span>
<span class="n">PRESCRIBED</span> <span class="n">FLOWRATES</span>  <span class="p">:</span> <span class="mi">3</span><span class="mf">5.</span><span class="p">;</span><span class="mf">0.</span>
<span class="n">PRESCRIBED</span> <span class="n">ELEVATIONS</span> <span class="p">:</span> <span class="mi">37</span><span class="mf">4.80565</span><span class="p">;</span><span class="mi">37</span><span class="mf">1.33</span>
<span class="o">/</span> <span class="p">...</span>
<span class="n">INITIAL</span> <span class="n">CONDITIONS</span> <span class="p">:</span> <span class="s1">&#39;ZERO DEPTH&#39;</span>
<span class="o">/</span> <span class="n">INITIAL</span> <span class="n">DEPTH</span> <span class="p">:</span> <span class="mi">1</span>
<span class="o">/</span> <span class="p">...</span> <span class="n">footer</span>
</pre></div>
</div>
<p>Alternatively, download the modified files:</p>
<ul class="simple">
<li><p><a class="reference external" href="https://github.com/hydro-informatics/telemac/raw/main/steady2d-dry/boundaries-dry.cli">boundaries-dry.cli</a></p></li>
<li><p><a class="reference external" href="https://github.com/hydro-informatics/telemac/raw/main/steady2d-dry/steady2d-dry.cas">steady2d-initdry.cas</a></p></li>
</ul>
<p>Re-<a class="reference internal" href="#tm2d-run"><span class="std std-ref">run Telemac2d</span></a> and open the resulting <code class="docutils literal notranslate"><span class="pre">r2d...slf</span></code> file in QGIS. The following video features the flow velocity vector evolution during the dry-initialized model run:</p>
<iframe width="701" height="394" src="https://www.youtube-nocookie.com/embed/hh843xrLycI" title="YouTube video player" frameborder="0" allow="accelerometer; autoplay; encrypted-media; gyroscope; picture-in-picture" allowfullscreen></iframe> <p>Sebastian Schwindt <a href="https://www.youtube.com/channel/UCGOMSGRrW5eLHiMn5Dfp7WQ">@ Hydro-Morphodynamics channel on YouTube</a>.</p>
<p>Compare the results of the dry and wet model initializations with regard to the following questions:</p>
<ul class="simple">
<li><p>How does the mass balance evolve during the simulation?</p></li>
<li><p>How long did the simulations take to converge and did you need to modify the <code class="docutils literal notranslate"><span class="pre">NUMBER</span> <span class="pre">OF</span> <span class="pre">TIME</span> <span class="pre">STEPS</span></code>?</p></li>
<li><p>How reasonable are the results (double-check with the above comment)?</p></li>
<li><p>Which of the two initial conditions would you use in practice to show that the simulation is correct?</p></li>
</ul>
</div>
<div class="tex2jax_ignore mathjax_ignore section" id="d-calibration-parameters">
<span id="tm2d-calibration"></span><h1>2d Calibration Parameters<a class="headerlink" href="#d-calibration-parameters" title="Permalink to this headline">¶</a></h1>
<details class="sphinx-bs dropdown card mb-3">
<summary class="summary-title card-header">
Recall: How to calibrate?<div class="summary-down docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-down" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M5.22 8.72a.75.75 0 000 1.06l6.25 6.25a.75.75 0 001.06 0l6.25-6.25a.75.75 0 00-1.06-1.06L12 14.44 6.28 8.72a.75.75 0 00-1.06 0z"></path></svg></div>
<div class="summary-up docutils">
<svg version="1.1" width="24" height="24" class="octicon octicon-chevron-up" viewBox="0 0 24 24" aria-hidden="true"><path fill-rule="evenodd" d="M18.78 15.28a.75.75 0 000-1.06l-6.25-6.25a.75.75 0 00-1.06 0l-6.25 6.25a.75.75 0 101.06 1.06L12 9.56l5.72 5.72a.75.75 0 001.06 0z"></path></svg></div>
</summary><div class="summary-content card-body docutils">
<p class="card-text">Calibration involves the step-wise adaptation of model input parameters to yield a possibly best (statistic) fit of modeled and measured data. In the process of model calibration, only one parameter should be modified at a time by 10 to 20-% deviations from its default value. For instance, if the beginning <code class="docutils literal notranslate"><span class="pre">FRICTION</span> <span class="pre">COEFFICIENT</span> <span class="pre">:</span> <span class="pre">0.03</span></code>, the calibration may test for <code class="docutils literal notranslate"><span class="pre">FRICTION</span> <span class="pre">COEFFICIENT</span> <span class="pre">:</span> <span class="pre">0.033</span></code>, then <code class="docutils literal notranslate"><span class="pre">FRICTION</span> <span class="pre">COEFFICIENT</span> <span class="pre">:</span> <span class="pre">0.036</span></code>, <code class="docutils literal notranslate"><span class="pre">FRICTION</span> <span class="pre">COEFFICIENT</span> <span class="pre">:</span> <span class="pre">0.027</span></code> and so on, ultimately to find out which value for <strong>FRICTION COEFFICIENT</strong> brings the model results closest to observations.</p>
<p class="card-text">Moreover, a sensitivity analysis compares step-wise modifications of multiple parameters (still: one at a time) and theirs effect on model results. For instance, if a 10-% variation of <strong>FRICTION COEFFICIENT</strong> yields a 5-% change in global water depth while a 10-% variation of grid size (edge length) yields a 20-% change in global water depth, it may be concluded that the model sensitivity is higher with respect to the grid size. However, such conclusions require careful considerations in multi-parametric, complex models of river ecosystems.</p>
</div>
</details><p>The following parameters may be used for calibrating a 2d model to measurements (e.g., water surface elevation, water depth, or flow velocity data):</p>
<ul class="simple">
<li><p><strong>FRICTION COEFFICIENT</strong> (<a class="reference internal" href="#tm2d-friction"><span class="std std-ref">friction section</span></a>)</p></li>
<li><p>Solvers, solver options, implicitation and other numerical parameters (<a class="reference internal" href="#tm2d-solver-pars"><span class="std std-ref">numerical parameter section</span></a>)</p></li>
<li><p>Type of model <a class="reference internal" href="#tm2d-init"><span class="std std-ref">initialization</span></a></p></li>
<li><p><a class="reference internal" href="#tm2d-turbulence"><span class="std std-ref">Turbulence models and parameters</span></a></p></li>
</ul>
<div class="admonition-avoid-accuracy-reducing-keyword-settings admonition">
<p class="admonition-title">Avoid accuracy-reducing keyword settings</p>
<p>Keyword settings such as <code class="docutils literal notranslate"><span class="pre">MASS-LUMPING</span> <span class="pre">...</span> <span class="pre">:</span> <span class="pre">...</span></code>  lead to increased smoothing (i.e., reduced accuracy) of results to increase computation speed. However, in most cases, it is worth accepting longer computation times and yielding higher accuracy, which will reduce efforts for model calibration, and thus, saves more time in the end.</p>
</div>
<dl class="simple myst">
<dt><strong>What next?</strong></dt><dd><p>A steady discharge almost never occurs in reality and can be used at maximum to <a class="reference internal" href="numerical-modeling.html#calibration"><span class="std std-ref">calibrate</span></a> the model based on (field) measurements. Once the model is well-calibrated for 2-3 steady discharges, the steady model results may be used for initializing an <a class="reference internal" href="telemac2d-unsteady.html#chpt-unsteady"><span class="std std-ref">unsteady</span></a> simulation, possibly with <a class="reference internal" href="telemac-gaia.html#tm-gaia"><span class="std std-ref">sediment transport</span></a>.</p>
</dd>
</dl>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "hydro-informatics/jupyter-python-course",
            ref: "main",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./numerics"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            <!-- Previous / next buttons -->
<div class='prev-next-area'> 
    <a class='left-prev' id="prev-link" href="telemac2d.html" title="previous page">
        <i class="fas fa-angle-left"></i>
        <div class="prev-next-info">
            <p class="prev-next-subtitle">previous</p>
            <p class="prev-next-title">Telemac2d</p>
        </div>
    </a>
    <a class='right-next' id="next-link" href="telemac2d-unsteady.html" title="next page">
    <div class="prev-next-info">
        <p class="prev-next-subtitle">next</p>
        <p class="prev-next-title">Unsteady 2d</p>
    </div>
    <i class="fas fa-angle-right"></i>
    </a>
</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Sebastian Schwindt, Ricardo Barros<br/>
        
            &copy; Copyright 2022.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.be7d3bbb2ef33a8344ce.js"></script>

  </body>
</html>